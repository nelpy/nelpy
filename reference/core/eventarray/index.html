<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=prev href=../../..><link href=../analogsignalarray/ rel=next><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.16"><title>EventArray - nelpy</title><link rel=stylesheet href=../../../assets/stylesheets/main.7e37652d.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../stylesheets/extra.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#eventarray class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=nelpy class="md-header__button md-logo" aria-label=nelpy data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> nelpy </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> EventArray </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=light data-md-color-primary=custom data-md-color-accent=custom aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=blue aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/nelpy/nelpy title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> nelpy/nelpy </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=./ class=md-tabs__link> API Reference </a> </li> <li class=md-tabs__item> <a href=../../../tutorials/GettingStarted/ class=md-tabs__link> Tutorials </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=nelpy class="md-nav__button md-logo" aria-label=nelpy data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> nelpy </label> <div class=md-nav__source> <a href=https://github.com/nelpy/nelpy title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> nelpy/nelpy </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> API Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> API Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> EventArray </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> EventArray </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#nelpy.core._eventarray class=md-nav__link> <span class=md-ellipsis> _eventarray </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BaseEventArray class=md-nav__link> <span class=md-ellipsis> BaseEventArray </span> </a> <nav class=md-nav aria-label=BaseEventArray> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BaseEventArray.domain class=md-nav__link> <span class=md-ellipsis> domain </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BaseEventArray.fs class=md-nav__link> <span class=md-ellipsis> fs </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BaseEventArray.label class=md-nav__link> <span class=md-ellipsis> label </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BaseEventArray.series_ids class=md-nav__link> <span class=md-ellipsis> series_ids </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BaseEventArray.series_labels class=md-nav__link> <span class=md-ellipsis> series_labels </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BaseEventArray.series_tags class=md-nav__link> <span class=md-ellipsis> series_tags </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BaseEventArray.support class=md-nav__link> <span class=md-ellipsis> support </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BaseEventArray.isempty class=md-nav__link> <span class=md-ellipsis> isempty </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BaseEventArray.n_series class=md-nav__link> <span class=md-ellipsis> n_series </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BaseEventArray.partition class=md-nav__link> <span class=md-ellipsis> partition </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray class=md-nav__link> <span class=md-ellipsis> BinnedEventArray </span> </a> <nav class=md-nav aria-label=BinnedEventArray> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.bin_centers class=md-nav__link> <span class=md-ellipsis> bin_centers </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.binnedSupport class=md-nav__link> <span class=md-ellipsis> binnedSupport </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.binned_support class=md-nav__link> <span class=md-ellipsis> binned_support </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.bins class=md-nav__link> <span class=md-ellipsis> bins </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.centers class=md-nav__link> <span class=md-ellipsis> centers </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.data class=md-nav__link> <span class=md-ellipsis> data </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.ds class=md-nav__link> <span class=md-ellipsis> ds </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.event_centers class=md-nav__link> <span class=md-ellipsis> event_centers </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.eventarray class=md-nav__link> <span class=md-ellipsis> eventarray </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.isempty class=md-nav__link> <span class=md-ellipsis> isempty </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.lengths class=md-nav__link> <span class=md-ellipsis> lengths </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.n_active class=md-nav__link> <span class=md-ellipsis> n_active </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.n_active_per_bin class=md-nav__link> <span class=md-ellipsis> n_active_per_bin </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.n_bins class=md-nav__link> <span class=md-ellipsis> n_bins </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.n_events class=md-nav__link> <span class=md-ellipsis> n_events </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.n_series class=md-nav__link> <span class=md-ellipsis> n_series </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.support class=md-nav__link> <span class=md-ellipsis> support </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.bst_from_indices class=md-nav__link> <span class=md-ellipsis> bst_from_indices </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.center class=md-nav__link> <span class=md-ellipsis> center </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.copy class=md-nav__link> <span class=md-ellipsis> copy </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.empty class=md-nav__link> <span class=md-ellipsis> empty </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.flatten class=md-nav__link> <span class=md-ellipsis> flatten </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.mean class=md-nav__link> <span class=md-ellipsis> mean </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.median class=md-nav__link> <span class=md-ellipsis> median </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.normalize class=md-nav__link> <span class=md-ellipsis> normalize </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.partition class=md-nav__link> <span class=md-ellipsis> partition </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.rebin class=md-nav__link> <span class=md-ellipsis> rebin </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.smooth class=md-nav__link> <span class=md-ellipsis> smooth </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.standardize class=md-nav__link> <span class=md-ellipsis> standardize </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.std class=md-nav__link> <span class=md-ellipsis> std </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedSpikeTrainArray class=md-nav__link> <span class=md-ellipsis> BinnedSpikeTrainArray </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray class=md-nav__link> <span class=md-ellipsis> EventArray </span> </a> <nav class=md-nav aria-label=EventArray> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.data class=md-nav__link> <span class=md-ellipsis> data </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.first_event class=md-nav__link> <span class=md-ellipsis> first_event </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.isempty class=md-nav__link> <span class=md-ellipsis> isempty </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.issorted class=md-nav__link> <span class=md-ellipsis> issorted </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.last_event class=md-nav__link> <span class=md-ellipsis> last_event </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.n_active class=md-nav__link> <span class=md-ellipsis> n_active </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.n_events class=md-nav__link> <span class=md-ellipsis> n_events </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.n_series class=md-nav__link> <span class=md-ellipsis> n_series </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.bin class=md-nav__link> <span class=md-ellipsis> bin </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.copy class=md-nav__link> <span class=md-ellipsis> copy </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.empty class=md-nav__link> <span class=md-ellipsis> empty </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.flatten class=md-nav__link> <span class=md-ellipsis> flatten </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.get_event_firing_order class=md-nav__link> <span class=md-ellipsis> get_event_firing_order </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.partition class=md-nav__link> <span class=md-ellipsis> partition </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.reorder_series class=md-nav__link> <span class=md-ellipsis> reorder_series </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.reorder_series_by_ids class=md-nav__link> <span class=md-ellipsis> reorder_series_by_ids </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.SpikeTrainArray class=md-nav__link> <span class=md-ellipsis> SpikeTrainArray </span> </a> <nav class=md-nav aria-label=SpikeTrainArray> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nelpy.core._eventarray.SpikeTrainArray.bin class=md-nav__link> <span class=md-ellipsis> bin </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.legacySTAkwargs class=md-nav__link> <span class=md-ellipsis> legacySTAkwargs </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../analogsignalarray/ class=md-nav__link> <span class=md-ellipsis> AnalogSignalArray </span> </a> </li> <li class=md-nav__item> <a href=../intervalarray/ class=md-nav__link> <span class=md-ellipsis> IntervalArray </span> </a> </li> <li class=md-nav__item> <a href=../valeventarray/ class=md-nav__link> <span class=md-ellipsis> ValeventArray </span> </a> </li> <li class=md-nav__item> <a href=../coordinates/ class=md-nav__link> <span class=md-ellipsis> Coordinates </span> </a> </li> <li class=md-nav__item> <a href=../../analysis/ class=md-nav__link> <span class=md-ellipsis> Analysis </span> </a> </li> <li class=md-nav__item> <a href=../../auxiliary/ class=md-nav__link> <span class=md-ellipsis> Auxiliary </span> </a> </li> <li class=md-nav__item> <a href=../../decoding/ class=md-nav__link> <span class=md-ellipsis> Decoding </span> </a> </li> <li class=md-nav__item> <a href=../../plotting/ class=md-nav__link> <span class=md-ellipsis> Plotting </span> </a> </li> <li class=md-nav__item> <a href=../../utils/ class=md-nav__link> <span class=md-ellipsis> Utilities </span> </a> </li> <li class=md-nav__item> <a href=../../estimators/ class=md-nav__link> <span class=md-ellipsis> Estimators </span> </a> </li> <li class=md-nav__item> <a href=../../filtering/ class=md-nav__link> <span class=md-ellipsis> Filtering </span> </a> </li> <li class=md-nav__item> <a href=../../preprocessing/ class=md-nav__link> <span class=md-ellipsis> Preprocessing </span> </a> </li> <li class=md-nav__item> <a href=../../hmmutils/ class=md-nav__link> <span class=md-ellipsis> HMM Utils </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tutorials/GettingStarted/ class=md-nav__link> <span class=md-ellipsis> Getting Started </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/AnalogSignalArrayTutorial/ class=md-nav__link> <span class=md-ellipsis> AnalogSignalArray Tutorial </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/EpochArrayTutorial/ class=md-nav__link> <span class=md-ellipsis> EpochArray Tutorial </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/LinearTrackDemo/ class=md-nav__link> <span class=md-ellipsis> Linear Track Demo </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/SpikeTrainSmoothing/ class=md-nav__link> <span class=md-ellipsis> SpikeTrain Smoothing </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/plotting/ class=md-nav__link> <span class=md-ellipsis> plotting </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/WMazeDemo/ class=md-nav__link> <span class=md-ellipsis> WMaze Demo </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/BackyardBrainsEEG/ class=md-nav__link> <span class=md-ellipsis> Backyard Brains EEG </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/develop/ class=md-nav__link> <span class=md-ellipsis> develop </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#nelpy.core._eventarray class=md-nav__link> <span class=md-ellipsis> _eventarray </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BaseEventArray class=md-nav__link> <span class=md-ellipsis> BaseEventArray </span> </a> <nav class=md-nav aria-label=BaseEventArray> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BaseEventArray.domain class=md-nav__link> <span class=md-ellipsis> domain </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BaseEventArray.fs class=md-nav__link> <span class=md-ellipsis> fs </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BaseEventArray.label class=md-nav__link> <span class=md-ellipsis> label </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BaseEventArray.series_ids class=md-nav__link> <span class=md-ellipsis> series_ids </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BaseEventArray.series_labels class=md-nav__link> <span class=md-ellipsis> series_labels </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BaseEventArray.series_tags class=md-nav__link> <span class=md-ellipsis> series_tags </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BaseEventArray.support class=md-nav__link> <span class=md-ellipsis> support </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BaseEventArray.isempty class=md-nav__link> <span class=md-ellipsis> isempty </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BaseEventArray.n_series class=md-nav__link> <span class=md-ellipsis> n_series </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BaseEventArray.partition class=md-nav__link> <span class=md-ellipsis> partition </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray class=md-nav__link> <span class=md-ellipsis> BinnedEventArray </span> </a> <nav class=md-nav aria-label=BinnedEventArray> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.bin_centers class=md-nav__link> <span class=md-ellipsis> bin_centers </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.binnedSupport class=md-nav__link> <span class=md-ellipsis> binnedSupport </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.binned_support class=md-nav__link> <span class=md-ellipsis> binned_support </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.bins class=md-nav__link> <span class=md-ellipsis> bins </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.centers class=md-nav__link> <span class=md-ellipsis> centers </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.data class=md-nav__link> <span class=md-ellipsis> data </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.ds class=md-nav__link> <span class=md-ellipsis> ds </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.event_centers class=md-nav__link> <span class=md-ellipsis> event_centers </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.eventarray class=md-nav__link> <span class=md-ellipsis> eventarray </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.isempty class=md-nav__link> <span class=md-ellipsis> isempty </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.lengths class=md-nav__link> <span class=md-ellipsis> lengths </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.n_active class=md-nav__link> <span class=md-ellipsis> n_active </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.n_active_per_bin class=md-nav__link> <span class=md-ellipsis> n_active_per_bin </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.n_bins class=md-nav__link> <span class=md-ellipsis> n_bins </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.n_events class=md-nav__link> <span class=md-ellipsis> n_events </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.n_series class=md-nav__link> <span class=md-ellipsis> n_series </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.support class=md-nav__link> <span class=md-ellipsis> support </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.bst_from_indices class=md-nav__link> <span class=md-ellipsis> bst_from_indices </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.center class=md-nav__link> <span class=md-ellipsis> center </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.copy class=md-nav__link> <span class=md-ellipsis> copy </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.empty class=md-nav__link> <span class=md-ellipsis> empty </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.flatten class=md-nav__link> <span class=md-ellipsis> flatten </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.mean class=md-nav__link> <span class=md-ellipsis> mean </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.median class=md-nav__link> <span class=md-ellipsis> median </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.normalize class=md-nav__link> <span class=md-ellipsis> normalize </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.partition class=md-nav__link> <span class=md-ellipsis> partition </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.rebin class=md-nav__link> <span class=md-ellipsis> rebin </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.smooth class=md-nav__link> <span class=md-ellipsis> smooth </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.standardize class=md-nav__link> <span class=md-ellipsis> standardize </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedEventArray.std class=md-nav__link> <span class=md-ellipsis> std </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.BinnedSpikeTrainArray class=md-nav__link> <span class=md-ellipsis> BinnedSpikeTrainArray </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray class=md-nav__link> <span class=md-ellipsis> EventArray </span> </a> <nav class=md-nav aria-label=EventArray> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.data class=md-nav__link> <span class=md-ellipsis> data </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.first_event class=md-nav__link> <span class=md-ellipsis> first_event </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.isempty class=md-nav__link> <span class=md-ellipsis> isempty </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.issorted class=md-nav__link> <span class=md-ellipsis> issorted </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.last_event class=md-nav__link> <span class=md-ellipsis> last_event </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.n_active class=md-nav__link> <span class=md-ellipsis> n_active </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.n_events class=md-nav__link> <span class=md-ellipsis> n_events </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.n_series class=md-nav__link> <span class=md-ellipsis> n_series </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.bin class=md-nav__link> <span class=md-ellipsis> bin </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.copy class=md-nav__link> <span class=md-ellipsis> copy </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.empty class=md-nav__link> <span class=md-ellipsis> empty </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.flatten class=md-nav__link> <span class=md-ellipsis> flatten </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.get_event_firing_order class=md-nav__link> <span class=md-ellipsis> get_event_firing_order </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.partition class=md-nav__link> <span class=md-ellipsis> partition </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.reorder_series class=md-nav__link> <span class=md-ellipsis> reorder_series </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.EventArray.reorder_series_by_ids class=md-nav__link> <span class=md-ellipsis> reorder_series_by_ids </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.SpikeTrainArray class=md-nav__link> <span class=md-ellipsis> SpikeTrainArray </span> </a> <nav class=md-nav aria-label=SpikeTrainArray> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nelpy.core._eventarray.SpikeTrainArray.bin class=md-nav__link> <span class=md-ellipsis> bin </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#nelpy.core._eventarray.legacySTAkwargs class=md-nav__link> <span class=md-ellipsis> legacySTAkwargs </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/nelpy/nelpy/edit/master/docs/reference/core/eventarray.md title="Edit this page" class="md-content__button md-icon" rel=edit> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <a href=https://github.com/nelpy/nelpy/raw/master/docs/reference/core/eventarray.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg> </a> <h1 id=eventarray>EventArray</h1> <div class="doc doc-object doc-module"> <a id=nelpy.core._eventarray></a> <div class="doc doc-contents first"> <p>idea is to have abscissa and ordinate, and to use aliasing to have n_series, _series_subset, series_ids, (or trial_ids), and so on.</p> <p>What is the genericized class? EventArray? eventseries, eventcollection</p> <p>when event &lt;==&gt; spike, abscissa &lt;==&gt; data, eventseries &lt;==&gt; eventarray eventseries_id &lt;==&gt; series_id, eventseries_type &lt;==&gt; series, then we have a EventArray. (n_events, n_spikes)</p> <p>series ==&gt; series (series, trial, DIO, ...)</p> <p>event rate (smooth; ds, sigma) series_id eventarray shift ISI PSTH</p> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 id=nelpy.core._eventarray.BaseEventArray class="doc doc-heading"> <code>BaseEventArray</code> </h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=abc.ABC>ABC</span></code></p> <p>Base class for EventArray and BinnedEventArray.</p> <p>NOTE: This class can't really be instantiated, almost like a pseudo abstract class. In particular, during initialization it might fail because it checks the n_series of its derived classes to validate input to series_ids and series_labels. If NoneTypes are used, then you may actually succeed in creating an instance of this class, but it will be pretty useless.</p> <p>This docstring only applies to this base class, as subclasses may have different behavior. Therefore read the particular subclass' docstring for the most accurate information.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>fs</code> </td> <td> </td> <td> <div class=doc-md-description> <p>Sampling rate / frequency (Hz).</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>series_ids</code> </td> <td> <code>list of int</code> </td> <td> <div class=doc-md-description> <p>Unit IDs</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>series_labels</code> </td> <td> <code>list of str</code> </td> <td> <div class=doc-md-description> <p>Labels corresponding to series. Default casts series_ids to str.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>series_tags</code> </td> <td> <code><span title=optional>optional</span></code> </td> <td> <div class=doc-md-description> <p>Tags correponding to series. NOTE: Currently we do not do any input validation so these can be any type. We also don't use these for anything yet.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>label</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Information pertaining to the source of the event series. Default is None.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>empty</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether to create an empty class instance (no data). Default is False</p> </div> </td> <td> <code>False</code> </td> </tr> <tr class=doc-section-item> <td> <code>abscissa</code> </td> <td> <code><span title=optional>optional</span></code> </td> <td> <div class=doc-md-description> <p>Object for the abscissa (x-axis) coordinate</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>ordinate</code> </td> <td> <code><span title=optional>optional</span></code> </td> <td> <div class=doc-md-description> <p>Object for the ordinate (y-axis) coordinate</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>kwargs</code> </td> <td> <code><span title=optional>optional</span></code> </td> <td> <div class=doc-md-description> <p>Other keyword arguments. NOTE: Currently we do not do anything with these.</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Attributes:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BaseEventArray.n_series>n_series</a></code></td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of series in event series.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.BaseEventArray.issempty>issempty</span></code></td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether the class instance is empty (no data)</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BaseEventArray.series_ids>series_ids</a></code></td> <td> <code>list of int</code> </td> <td> <div class=doc-md-description> <p>Unit IDs</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BaseEventArray.series_labels>series_labels</a></code></td> <td> <code>list of str</code> </td> <td> <div class=doc-md-description> <p>Labels corresponding to series. Default casts series_ids to str.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BaseEventArray.series_tags>series_tags</a></code></td> <td> </td> <td> <div class=doc-md-description> <p>Tags corresponding to series. NOTE: Currently we do not do any input validation so these can be any type. We also don't use these for anything yet.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.BaseEventArray.n_intervals>n_intervals</span></code></td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>The number of underlying intervals.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BaseEventArray.support>support</a></code></td> <td> <code><a class="autorefs autorefs-internal" href=../intervalarray/#nelpy.core._intervalarray.IntervalArray>IntervalArray</a></code> </td> <td> <div class=doc-md-description> <p>The support of the EventArray.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BaseEventArray.fs>fs</a></code></td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Sampling frequency (Hz).</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BaseEventArray.label>label</a></code></td> <td> <code><span title=str>str</span> or None</code> </td> <td> <div class=doc-md-description> <p>Information pertaining to the source of the event series.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 37</span>
<span class=normal> 38</span>
<span class=normal> 39</span>
<span class=normal> 40</span>
<span class=normal> 41</span>
<span class=normal> 42</span>
<span class=normal> 43</span>
<span class=normal> 44</span>
<span class=normal> 45</span>
<span class=normal> 46</span>
<span class=normal> 47</span>
<span class=normal> 48</span>
<span class=normal> 49</span>
<span class=normal> 50</span>
<span class=normal> 51</span>
<span class=normal> 52</span>
<span class=normal> 53</span>
<span class=normal> 54</span>
<span class=normal> 55</span>
<span class=normal> 56</span>
<span class=normal> 57</span>
<span class=normal> 58</span>
<span class=normal> 59</span>
<span class=normal> 60</span>
<span class=normal> 61</span>
<span class=normal> 62</span>
<span class=normal> 63</span>
<span class=normal> 64</span>
<span class=normal> 65</span>
<span class=normal> 66</span>
<span class=normal> 67</span>
<span class=normal> 68</span>
<span class=normal> 69</span>
<span class=normal> 70</span>
<span class=normal> 71</span>
<span class=normal> 72</span>
<span class=normal> 73</span>
<span class=normal> 74</span>
<span class=normal> 75</span>
<span class=normal> 76</span>
<span class=normal> 77</span>
<span class=normal> 78</span>
<span class=normal> 79</span>
<span class=normal> 80</span>
<span class=normal> 81</span>
<span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span>
<span class=normal>106</span>
<span class=normal>107</span>
<span class=normal>108</span>
<span class=normal>109</span>
<span class=normal>110</span>
<span class=normal>111</span>
<span class=normal>112</span>
<span class=normal>113</span>
<span class=normal>114</span>
<span class=normal>115</span>
<span class=normal>116</span>
<span class=normal>117</span>
<span class=normal>118</span>
<span class=normal>119</span>
<span class=normal>120</span>
<span class=normal>121</span>
<span class=normal>122</span>
<span class=normal>123</span>
<span class=normal>124</span>
<span class=normal>125</span>
<span class=normal>126</span>
<span class=normal>127</span>
<span class=normal>128</span>
<span class=normal>129</span>
<span class=normal>130</span>
<span class=normal>131</span>
<span class=normal>132</span>
<span class=normal>133</span>
<span class=normal>134</span>
<span class=normal>135</span>
<span class=normal>136</span>
<span class=normal>137</span>
<span class=normal>138</span>
<span class=normal>139</span>
<span class=normal>140</span>
<span class=normal>141</span>
<span class=normal>142</span>
<span class=normal>143</span>
<span class=normal>144</span>
<span class=normal>145</span>
<span class=normal>146</span>
<span class=normal>147</span>
<span class=normal>148</span>
<span class=normal>149</span>
<span class=normal>150</span>
<span class=normal>151</span>
<span class=normal>152</span>
<span class=normal>153</span>
<span class=normal>154</span>
<span class=normal>155</span>
<span class=normal>156</span>
<span class=normal>157</span>
<span class=normal>158</span>
<span class=normal>159</span>
<span class=normal>160</span>
<span class=normal>161</span>
<span class=normal>162</span>
<span class=normal>163</span>
<span class=normal>164</span>
<span class=normal>165</span>
<span class=normal>166</span>
<span class=normal>167</span>
<span class=normal>168</span>
<span class=normal>169</span>
<span class=normal>170</span>
<span class=normal>171</span>
<span class=normal>172</span>
<span class=normal>173</span>
<span class=normal>174</span>
<span class=normal>175</span>
<span class=normal>176</span>
<span class=normal>177</span>
<span class=normal>178</span>
<span class=normal>179</span>
<span class=normal>180</span>
<span class=normal>181</span>
<span class=normal>182</span>
<span class=normal>183</span>
<span class=normal>184</span>
<span class=normal>185</span>
<span class=normal>186</span>
<span class=normal>187</span>
<span class=normal>188</span>
<span class=normal>189</span>
<span class=normal>190</span>
<span class=normal>191</span>
<span class=normal>192</span>
<span class=normal>193</span>
<span class=normal>194</span>
<span class=normal>195</span>
<span class=normal>196</span>
<span class=normal>197</span>
<span class=normal>198</span>
<span class=normal>199</span>
<span class=normal>200</span>
<span class=normal>201</span>
<span class=normal>202</span>
<span class=normal>203</span>
<span class=normal>204</span>
<span class=normal>205</span>
<span class=normal>206</span>
<span class=normal>207</span>
<span class=normal>208</span>
<span class=normal>209</span>
<span class=normal>210</span>
<span class=normal>211</span>
<span class=normal>212</span>
<span class=normal>213</span>
<span class=normal>214</span>
<span class=normal>215</span>
<span class=normal>216</span>
<span class=normal>217</span>
<span class=normal>218</span>
<span class=normal>219</span>
<span class=normal>220</span>
<span class=normal>221</span>
<span class=normal>222</span>
<span class=normal>223</span>
<span class=normal>224</span>
<span class=normal>225</span>
<span class=normal>226</span>
<span class=normal>227</span>
<span class=normal>228</span>
<span class=normal>229</span>
<span class=normal>230</span>
<span class=normal>231</span>
<span class=normal>232</span>
<span class=normal>233</span>
<span class=normal>234</span>
<span class=normal>235</span>
<span class=normal>236</span>
<span class=normal>237</span>
<span class=normal>238</span>
<span class=normal>239</span>
<span class=normal>240</span>
<span class=normal>241</span>
<span class=normal>242</span>
<span class=normal>243</span>
<span class=normal>244</span>
<span class=normal>245</span>
<span class=normal>246</span>
<span class=normal>247</span>
<span class=normal>248</span>
<span class=normal>249</span>
<span class=normal>250</span>
<span class=normal>251</span>
<span class=normal>252</span>
<span class=normal>253</span>
<span class=normal>254</span>
<span class=normal>255</span>
<span class=normal>256</span>
<span class=normal>257</span>
<span class=normal>258</span>
<span class=normal>259</span>
<span class=normal>260</span>
<span class=normal>261</span>
<span class=normal>262</span>
<span class=normal>263</span>
<span class=normal>264</span>
<span class=normal>265</span>
<span class=normal>266</span>
<span class=normal>267</span>
<span class=normal>268</span>
<span class=normal>269</span>
<span class=normal>270</span>
<span class=normal>271</span>
<span class=normal>272</span>
<span class=normal>273</span>
<span class=normal>274</span>
<span class=normal>275</span>
<span class=normal>276</span>
<span class=normal>277</span>
<span class=normal>278</span>
<span class=normal>279</span>
<span class=normal>280</span>
<span class=normal>281</span>
<span class=normal>282</span>
<span class=normal>283</span>
<span class=normal>284</span>
<span class=normal>285</span>
<span class=normal>286</span>
<span class=normal>287</span>
<span class=normal>288</span>
<span class=normal>289</span>
<span class=normal>290</span>
<span class=normal>291</span>
<span class=normal>292</span>
<span class=normal>293</span>
<span class=normal>294</span>
<span class=normal>295</span>
<span class=normal>296</span>
<span class=normal>297</span>
<span class=normal>298</span>
<span class=normal>299</span>
<span class=normal>300</span>
<span class=normal>301</span>
<span class=normal>302</span>
<span class=normal>303</span>
<span class=normal>304</span>
<span class=normal>305</span>
<span class=normal>306</span>
<span class=normal>307</span>
<span class=normal>308</span>
<span class=normal>309</span>
<span class=normal>310</span>
<span class=normal>311</span>
<span class=normal>312</span>
<span class=normal>313</span>
<span class=normal>314</span>
<span class=normal>315</span>
<span class=normal>316</span>
<span class=normal>317</span>
<span class=normal>318</span>
<span class=normal>319</span>
<span class=normal>320</span>
<span class=normal>321</span>
<span class=normal>322</span>
<span class=normal>323</span>
<span class=normal>324</span>
<span class=normal>325</span>
<span class=normal>326</span>
<span class=normal>327</span>
<span class=normal>328</span>
<span class=normal>329</span>
<span class=normal>330</span>
<span class=normal>331</span>
<span class=normal>332</span>
<span class=normal>333</span>
<span class=normal>334</span>
<span class=normal>335</span>
<span class=normal>336</span>
<span class=normal>337</span>
<span class=normal>338</span>
<span class=normal>339</span>
<span class=normal>340</span>
<span class=normal>341</span>
<span class=normal>342</span>
<span class=normal>343</span>
<span class=normal>344</span>
<span class=normal>345</span>
<span class=normal>346</span>
<span class=normal>347</span>
<span class=normal>348</span>
<span class=normal>349</span>
<span class=normal>350</span>
<span class=normal>351</span>
<span class=normal>352</span>
<span class=normal>353</span>
<span class=normal>354</span>
<span class=normal>355</span>
<span class=normal>356</span>
<span class=normal>357</span>
<span class=normal>358</span>
<span class=normal>359</span>
<span class=normal>360</span>
<span class=normal>361</span>
<span class=normal>362</span>
<span class=normal>363</span>
<span class=normal>364</span>
<span class=normal>365</span>
<span class=normal>366</span>
<span class=normal>367</span>
<span class=normal>368</span>
<span class=normal>369</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>BaseEventArray</span><span class=p>(</span><span class=n>ABC</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Base class for EventArray and BinnedEventArray.</span>

<span class=sd>    NOTE: This class can&#39;t really be instantiated, almost like a pseudo</span>
<span class=sd>    abstract class. In particular, during initialization it might fail</span>
<span class=sd>    because it checks the n_series of its derived classes to validate</span>
<span class=sd>    input to series_ids and series_labels. If NoneTypes are used, then you</span>
<span class=sd>    may actually succeed in creating an instance of this class, but it</span>
<span class=sd>    will be pretty useless.</span>

<span class=sd>    This docstring only applies to this base class, as subclasses may have</span>
<span class=sd>    different behavior. Therefore read the particular subclass&#39; docstring</span>
<span class=sd>    for the most accurate information.</span>

<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    fs: float, optional</span>
<span class=sd>        Sampling rate / frequency (Hz).</span>
<span class=sd>    series_ids : list of int, optional</span>
<span class=sd>        Unit IDs</span>
<span class=sd>    series_labels : list of str, optional</span>
<span class=sd>        Labels corresponding to series. Default casts series_ids to str.</span>
<span class=sd>    series_tags : optional</span>
<span class=sd>        Tags correponding to series.</span>
<span class=sd>        NOTE: Currently we do not do any input validation so these can</span>
<span class=sd>        be any type. We also don&#39;t use these for anything yet.</span>
<span class=sd>    label : str, optional</span>
<span class=sd>        Information pertaining to the source of the event series.</span>
<span class=sd>        Default is None.</span>
<span class=sd>    empty : bool, optional</span>
<span class=sd>        Whether to create an empty class instance (no data).</span>
<span class=sd>        Default is False</span>
<span class=sd>    abscissa : optional</span>
<span class=sd>        Object for the abscissa (x-axis) coordinate</span>
<span class=sd>    ordinate : optional</span>
<span class=sd>        Object for the ordinate (y-axis) coordinate</span>
<span class=sd>    kwargs : optional</span>
<span class=sd>        Other keyword arguments. NOTE: Currently we do not do anything</span>
<span class=sd>        with these.</span>

<span class=sd>    Attributes</span>
<span class=sd>    ----------</span>
<span class=sd>    n_series : int</span>
<span class=sd>        Number of series in event series.</span>
<span class=sd>    issempty : bool</span>
<span class=sd>        Whether the class instance is empty (no data)</span>
<span class=sd>    series_ids : list of int</span>
<span class=sd>        Unit IDs</span>
<span class=sd>    series_labels : list of str</span>
<span class=sd>        Labels corresponding to series. Default casts series_ids to str.</span>
<span class=sd>    series_tags :</span>
<span class=sd>        Tags corresponding to series.</span>
<span class=sd>        NOTE: Currently we do not do any input validation so these can</span>
<span class=sd>        be any type. We also don&#39;t use these for anything yet.</span>
<span class=sd>    n_intervals : int</span>
<span class=sd>        The number of underlying intervals.</span>
<span class=sd>    support : nelpy.IntervalArray</span>
<span class=sd>        The support of the EventArray.</span>
<span class=sd>    fs: float</span>
<span class=sd>        Sampling frequency (Hz).</span>
<span class=sd>    label : str or None</span>
<span class=sd>        Information pertaining to the source of the event series.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>__aliases__</span> <span class=o>=</span> <span class=p>{}</span>

    <span class=n>__attributes__</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;_fs&quot;</span><span class=p>,</span> <span class=s2>&quot;_series_ids&quot;</span><span class=p>,</span> <span class=s2>&quot;_series_labels&quot;</span><span class=p>,</span> <span class=s2>&quot;_series_tags&quot;</span><span class=p>,</span> <span class=s2>&quot;_label&quot;</span><span class=p>]</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=o>*</span><span class=p>,</span>
        <span class=n>fs</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>series_ids</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>series_labels</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>series_tags</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>label</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>empty</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
        <span class=n>abscissa</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>ordinate</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
    <span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>__version__</span> <span class=o>=</span> <span class=n>version</span><span class=o>.</span><span class=n>__version__</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>type_name</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span>
        <span class=k>if</span> <span class=n>abscissa</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>abscissa</span> <span class=o>=</span> <span class=n>core</span><span class=o>.</span><span class=n>Abscissa</span><span class=p>()</span>  <span class=c1># TODO: integrate into constructor?</span>
        <span class=k>if</span> <span class=n>ordinate</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>ordinate</span> <span class=o>=</span> <span class=n>core</span><span class=o>.</span><span class=n>Ordinate</span><span class=p>()</span>  <span class=c1># TODO: integrate into constructor?</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span> <span class=o>=</span> <span class=n>abscissa</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_ordinate</span> <span class=o>=</span> <span class=n>ordinate</span>

        <span class=n>series_label</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;series_label&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>series_label</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>series_label</span> <span class=o>=</span> <span class=s2>&quot;series&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_series_label</span> <span class=o>=</span> <span class=n>series_label</span>

        <span class=c1># if an empty object is requested, return it:</span>
        <span class=k>if</span> <span class=n>empty</span><span class=p>:</span>
            <span class=k>for</span> <span class=n>attr</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>__attributes__</span><span class=p>:</span>
                <span class=n>exec</span><span class=p>(</span><span class=s2>&quot;self.&quot;</span> <span class=o>+</span> <span class=n>attr</span> <span class=o>+</span> <span class=s2>&quot; = None&quot;</span><span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)(</span><span class=n>empty</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>loc</span> <span class=o>=</span> <span class=n>_accessors</span><span class=o>.</span><span class=n>ItemGetterLoc</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>iloc</span> <span class=o>=</span> <span class=n>_accessors</span><span class=o>.</span><span class=n>ItemGetterIloc</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>
            <span class=k>return</span>

        <span class=c1># set initial fs to None</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_fs</span> <span class=o>=</span> <span class=kc>None</span>
        <span class=c1># then attempt to update the fs; this does input validation:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>fs</span> <span class=o>=</span> <span class=n>fs</span>

        <span class=c1># WARNING! we need to ensure that self.n_series can work BEFORE</span>
        <span class=c1># we can set self.series_ids or self.series_labels, since those</span>
        <span class=c1># setters check that the lengths of the inputs are consistent</span>
        <span class=c1># with self.n_series.</span>

        <span class=c1># inherit series IDs if available, otherwise initialize to default</span>
        <span class=k>if</span> <span class=n>series_ids</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>series_ids</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>n_series</span> <span class=o>+</span> <span class=mi>1</span><span class=p>))</span>

        <span class=n>series_ids</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>series_ids</span><span class=p>,</span> <span class=n>ndmin</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>  <span class=c1># standardize series_ids</span>

        <span class=c1># if series_labels is empty, default to series_ids</span>
        <span class=k>if</span> <span class=n>series_labels</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>series_labels</span> <span class=o>=</span> <span class=n>series_ids</span>

        <span class=n>series_labels</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>series_labels</span><span class=p>,</span> <span class=n>ndmin</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>  <span class=c1># standardize</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>series_ids</span> <span class=o>=</span> <span class=n>series_ids</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>series_labels</span> <span class=o>=</span> <span class=n>series_labels</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_series_tags</span> <span class=o>=</span> <span class=n>series_tags</span>  <span class=c1># no input validation yet</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>label</span> <span class=o>=</span> <span class=n>label</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>loc</span> <span class=o>=</span> <span class=n>_accessors</span><span class=o>.</span><span class=n>ItemGetterLoc</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>iloc</span> <span class=o>=</span> <span class=n>_accessors</span><span class=o>.</span><span class=n>ItemGetterIloc</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>__renew__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Re-attach slicers and indexers.&quot;&quot;&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>loc</span> <span class=o>=</span> <span class=n>_accessors</span><span class=o>.</span><span class=n>ItemGetterLoc</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>iloc</span> <span class=o>=</span> <span class=n>_accessors</span><span class=o>.</span><span class=n>ItemGetterIloc</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__repr__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=n>address_str</span> <span class=o>=</span> <span class=s2>&quot; at &quot;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=nb>hex</span><span class=p>(</span><span class=nb>id</span><span class=p>(</span><span class=bp>self</span><span class=p>)))</span>
        <span class=k>return</span> <span class=s2>&quot;&lt;BaseEventArray&quot;</span> <span class=o>+</span> <span class=n>address_str</span> <span class=o>+</span> <span class=s2>&quot;&gt;&quot;</span>

    <span class=nd>@abstractmethod</span>
    <span class=nd>@keyword_equivalence</span><span class=p>(</span><span class=n>this_or_that</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;n_intervals&quot;</span><span class=p>:</span> <span class=s2>&quot;n_epochs&quot;</span><span class=p>})</span>
    <span class=k>def</span><span class=w> </span><span class=nf>partition</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ds</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>n_intervals</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Returns a BaseEventArray whose support has been partitioned.</span>

<span class=sd>        Parameters</span>
<span class=sd>        ----------</span>
<span class=sd>        ds : float, optional</span>
<span class=sd>            Maximum duration (in seconds), for each interval.</span>
<span class=sd>        n_intervals : int, optional</span>
<span class=sd>            Number of intervals. If ds is None and n_intervals is None, then</span>
<span class=sd>            default is to use n_intervals = 100</span>

<span class=sd>        Returns</span>
<span class=sd>        -------</span>
<span class=sd>        out : BaseEventArray</span>
<span class=sd>            BaseEventArray that has been partitioned.</span>

<span class=sd>        Notes</span>
<span class=sd>        -----</span>
<span class=sd>        Irrespective of whether &#39;ds&#39; or &#39;n_intervals&#39; are used, the exact</span>
<span class=sd>        underlying support is propagated, and the first and last points</span>
<span class=sd>        of the supports are always included, even if this would cause</span>
<span class=sd>        n_points or ds to be violated.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>return</span>

    <span class=nd>@abstractmethod</span>
    <span class=k>def</span><span class=w> </span><span class=nf>isempty</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(bool) Empty BaseEventArray.&quot;&quot;&quot;</span>
        <span class=k>return</span>

    <span class=nd>@abstractmethod</span>
    <span class=k>def</span><span class=w> </span><span class=nf>n_series</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(int) The number of series.&quot;&quot;&quot;</span>
        <span class=k>return</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>n_intervals</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>isempty</span><span class=p>:</span>
            <span class=k>return</span> <span class=mi>0</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(int) The number of underlying intervals.&quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=o>.</span><span class=n>n_intervals</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>series_ids</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Unit IDs contained in the BaseEventArray.&quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_series_ids</span>

    <span class=nd>@series_ids</span><span class=o>.</span><span class=n>setter</span>
    <span class=k>def</span><span class=w> </span><span class=nf>series_ids</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>val</span><span class=p>):</span>
        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>val</span><span class=p>)</span> <span class=o>!=</span> <span class=bp>self</span><span class=o>.</span><span class=n>n_series</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s2>&quot;series_ids must be of length n_series&quot;</span><span class=p>)</span>
        <span class=k>elif</span> <span class=nb>len</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>val</span><span class=p>))</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>val</span><span class=p>):</span>
            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s2>&quot;duplicate series_ids are not allowed&quot;</span><span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=k>try</span><span class=p>:</span>
                <span class=c1># cast to int:</span>
                <span class=n>series_ids</span> <span class=o>=</span> <span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=nb>id</span><span class=p>)</span> <span class=k>for</span> <span class=nb>id</span> <span class=ow>in</span> <span class=n>val</span><span class=p>]</span>
            <span class=k>except</span> <span class=ne>TypeError</span><span class=p>:</span>
                <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s2>&quot;series_ids must be int-like&quot;</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_series_ids</span> <span class=o>=</span> <span class=n>series_ids</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>series_labels</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Labels corresponding to series contained in the BaseEventArray.&quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_series_labels</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;series labels have not yet been specified&quot;</span><span class=p>)</span>
            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>series_ids</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_series_labels</span>

    <span class=nd>@series_labels</span><span class=o>.</span><span class=n>setter</span>
    <span class=k>def</span><span class=w> </span><span class=nf>series_labels</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>val</span><span class=p>):</span>
        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>val</span><span class=p>)</span> <span class=o>!=</span> <span class=bp>self</span><span class=o>.</span><span class=n>n_series</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s2>&quot;labels must be of length n_series&quot;</span><span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=k>try</span><span class=p>:</span>
                <span class=c1># cast to str:</span>
                <span class=n>labels</span> <span class=o>=</span> <span class=p>[</span><span class=nb>str</span><span class=p>(</span><span class=n>label</span><span class=p>)</span> <span class=k>for</span> <span class=n>label</span> <span class=ow>in</span> <span class=n>val</span><span class=p>]</span>
            <span class=k>except</span> <span class=ne>TypeError</span><span class=p>:</span>
                <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s2>&quot;labels must be string-like&quot;</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_series_labels</span> <span class=o>=</span> <span class=n>labels</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>series_tags</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Tags corresponding to series contained in the BaseEventArray&quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_series_tags</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;series tags have not yet been specified&quot;</span><span class=p>)</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_series_tags</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>support</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(nelpy.IntervalArray) The support of the EventArray.&quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span>

    <span class=nd>@support</span><span class=o>.</span><span class=n>setter</span>
    <span class=k>def</span><span class=w> </span><span class=nf>support</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>val</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(nelpy.IntervalArray) The support of the EventArray.&quot;&quot;&quot;</span>
        <span class=c1># modify support</span>
        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)):</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=n>val</span>
        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=p>(</span><span class=nb>tuple</span><span class=p>,</span> <span class=nb>list</span><span class=p>)):</span>
            <span class=n>prev_domain</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>domain</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)([</span><span class=n>val</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>val</span><span class=p>[</span><span class=mi>1</span><span class=p>]])</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>domain</span> <span class=o>=</span> <span class=n>prev_domain</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
                <span class=s2>&quot;support must be of type </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)))</span>
            <span class=p>)</span>
        <span class=c1># restrict data to new support</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_restrict_to_interval</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>domain</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(nelpy.IntervalArray) The domain of the EventArray.&quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>domain</span>

    <span class=nd>@domain</span><span class=o>.</span><span class=n>setter</span>
    <span class=k>def</span><span class=w> </span><span class=nf>domain</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>val</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(nelpy.IntervalArray) The domain of the EventArray.&quot;&quot;&quot;</span>
        <span class=c1># modify domain</span>
        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)):</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>domain</span> <span class=o>=</span> <span class=n>val</span>
        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=p>(</span><span class=nb>tuple</span><span class=p>,</span> <span class=nb>list</span><span class=p>)):</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>domain</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)([</span><span class=n>val</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>val</span><span class=p>[</span><span class=mi>1</span><span class=p>]])</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
                <span class=s2>&quot;support must be of type </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)))</span>
            <span class=p>)</span>
        <span class=c1># restrict data to new support</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_restrict_to_interval</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>fs</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(float) Sampling rate.&quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_fs</span>

    <span class=nd>@fs</span><span class=o>.</span><span class=n>setter</span>
    <span class=k>def</span><span class=w> </span><span class=nf>fs</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>val</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(float) Sampling rate.&quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_fs</span> <span class=o>==</span> <span class=n>val</span><span class=p>:</span>
            <span class=k>return</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>val</span> <span class=o>&lt;=</span> <span class=mi>0</span><span class=p>:</span>
                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;sampling rate must be positive&quot;</span><span class=p>)</span>
        <span class=k>except</span> <span class=ne>TypeError</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s2>&quot;sampling rate must be a scalar&quot;</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_fs</span> <span class=o>=</span> <span class=n>val</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>label</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Label pertaining to the source of the event series.&quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_label</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;label has not yet been specified&quot;</span><span class=p>)</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_label</span>

    <span class=nd>@label</span><span class=o>.</span><span class=n>setter</span>
    <span class=k>def</span><span class=w> </span><span class=nf>label</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>val</span><span class=p>):</span>
        <span class=k>if</span> <span class=n>val</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=k>try</span><span class=p>:</span>  <span class=c1># cast to str:</span>
                <span class=n>label</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>val</span><span class=p>)</span>
            <span class=k>except</span> <span class=ne>TypeError</span><span class=p>:</span>
                <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s2>&quot;cannot convert label to string&quot;</span><span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>label</span> <span class=o>=</span> <span class=n>val</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_label</span> <span class=o>=</span> <span class=n>label</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_series_subset</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>series_list</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Return a BaseEventArray restricted to a subset of series.</span>

<span class=sd>        Parameters</span>
<span class=sd>        ----------</span>
<span class=sd>        series_list : array-like</span>
<span class=sd>            Array or list of series_ids.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,</span> <span class=n>series_list</span><span class=p>]</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__setattr__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
        <span class=c1># https://stackoverflow.com/questions/4017572/how-can-i-make-an-alias-to-a-non-function-member-attribute-in-a-python-class</span>
        <span class=n>name</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>__aliases__</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>name</span><span class=p>)</span>
        <span class=nb>object</span><span class=o>.</span><span class=fm>__setattr__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__getattr__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>):</span>
        <span class=c1># https://stackoverflow.com/questions/4017572/how-can-i-make-an-alias-to-a-non-function-member-attribute-in-a-python-class</span>
        <span class=k>if</span> <span class=n>name</span> <span class=o>==</span> <span class=s2>&quot;aliases&quot;</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>AttributeError</span>  <span class=c1># http://nedbatchelder.com/blog/201010/surprising_getattr_recursion.html</span>
        <span class=n>name</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>__aliases__</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>name</span><span class=p>)</span>
        <span class=c1># return getattr(self, name) #Causes infinite recursion on non-existent attribute</span>
        <span class=k>return</span> <span class=nb>object</span><span class=o>.</span><span class=fm>__getattribute__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BaseEventArray.domain class="doc doc-heading"> <code class="highlight language-python"><span class=n>domain</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> <small class="doc doc-label doc-label-writable"><code>writable</code></small> </span> </h3> <div class="doc doc-contents "> <p>(nelpy.IntervalArray) The domain of the EventArray.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BaseEventArray.fs class="doc doc-heading"> <code class="highlight language-python"><span class=n>fs</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> <small class="doc doc-label doc-label-writable"><code>writable</code></small> </span> </h3> <div class="doc doc-contents "> <p>(float) Sampling rate.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BaseEventArray.label class="doc doc-heading"> <code class="highlight language-python"><span class=n>label</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> <small class="doc doc-label doc-label-writable"><code>writable</code></small> </span> </h3> <div class="doc doc-contents "> <p>Label pertaining to the source of the event series.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BaseEventArray.series_ids class="doc doc-heading"> <code class="highlight language-python"><span class=n>series_ids</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> <small class="doc doc-label doc-label-writable"><code>writable</code></small> </span> </h3> <div class="doc doc-contents "> <p>Unit IDs contained in the BaseEventArray.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BaseEventArray.series_labels class="doc doc-heading"> <code class="highlight language-python"><span class=n>series_labels</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> <small class="doc doc-label doc-label-writable"><code>writable</code></small> </span> </h3> <div class="doc doc-contents "> <p>Labels corresponding to series contained in the BaseEventArray.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BaseEventArray.series_tags class="doc doc-heading"> <code class="highlight language-python"><span class=n>series_tags</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>Tags corresponding to series contained in the BaseEventArray</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BaseEventArray.support class="doc doc-heading"> <code class="highlight language-python"><span class=n>support</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> <small class="doc doc-label doc-label-writable"><code>writable</code></small> </span> </h3> <div class="doc doc-contents "> <p>(nelpy.IntervalArray) The support of the EventArray.</p> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.BaseEventArray.isempty class="doc doc-heading"> <code class="highlight language-python"><span class=n>isempty</span><span class=p>()</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> </h3> <div class="doc doc-contents "> <p>(bool) Empty BaseEventArray.</p> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>208</span>
<span class=normal>209</span>
<span class=normal>210</span>
<span class=normal>211</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@abstractmethod</span>
<span class=k>def</span><span class=w> </span><span class=nf>isempty</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;(bool) Empty BaseEventArray.&quot;&quot;&quot;</span>
    <span class=k>return</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.BaseEventArray.n_series class="doc doc-heading"> <code class="highlight language-python"><span class=n>n_series</span><span class=p>()</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> </h3> <div class="doc doc-contents "> <p>(int) The number of series.</p> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>213</span>
<span class=normal>214</span>
<span class=normal>215</span>
<span class=normal>216</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@abstractmethod</span>
<span class=k>def</span><span class=w> </span><span class=nf>n_series</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;(int) The number of series.&quot;&quot;&quot;</span>
    <span class=k>return</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.BaseEventArray.partition class="doc doc-heading"> <code class="highlight language-python"><span class=n>partition</span><span class=p>(</span><span class=n>ds</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>n_intervals</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> </h3> <div class="doc doc-contents "> <p>Returns a BaseEventArray whose support has been partitioned.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>ds</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Maximum duration (in seconds), for each interval.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>n_intervals</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of intervals. If ds is None and n_intervals is None, then default is to use n_intervals = 100</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>out</code></td> <td> <code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BaseEventArray>BaseEventArray</a></code> </td> <td> <div class=doc-md-description> <p>BaseEventArray that has been partitioned.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>Irrespective of whether 'ds' or 'n_intervals' are used, the exact underlying support is propagated, and the first and last points of the supports are always included, even if this would cause n_points or ds to be violated.</p> </details> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>180</span>
<span class=normal>181</span>
<span class=normal>182</span>
<span class=normal>183</span>
<span class=normal>184</span>
<span class=normal>185</span>
<span class=normal>186</span>
<span class=normal>187</span>
<span class=normal>188</span>
<span class=normal>189</span>
<span class=normal>190</span>
<span class=normal>191</span>
<span class=normal>192</span>
<span class=normal>193</span>
<span class=normal>194</span>
<span class=normal>195</span>
<span class=normal>196</span>
<span class=normal>197</span>
<span class=normal>198</span>
<span class=normal>199</span>
<span class=normal>200</span>
<span class=normal>201</span>
<span class=normal>202</span>
<span class=normal>203</span>
<span class=normal>204</span>
<span class=normal>205</span>
<span class=normal>206</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@abstractmethod</span>
<span class=nd>@keyword_equivalence</span><span class=p>(</span><span class=n>this_or_that</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;n_intervals&quot;</span><span class=p>:</span> <span class=s2>&quot;n_epochs&quot;</span><span class=p>})</span>
<span class=k>def</span><span class=w> </span><span class=nf>partition</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ds</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>n_intervals</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Returns a BaseEventArray whose support has been partitioned.</span>

<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    ds : float, optional</span>
<span class=sd>        Maximum duration (in seconds), for each interval.</span>
<span class=sd>    n_intervals : int, optional</span>
<span class=sd>        Number of intervals. If ds is None and n_intervals is None, then</span>
<span class=sd>        default is to use n_intervals = 100</span>

<span class=sd>    Returns</span>
<span class=sd>    -------</span>
<span class=sd>    out : BaseEventArray</span>
<span class=sd>        BaseEventArray that has been partitioned.</span>

<span class=sd>    Notes</span>
<span class=sd>    -----</span>
<span class=sd>    Irrespective of whether &#39;ds&#39; or &#39;n_intervals&#39; are used, the exact</span>
<span class=sd>    underlying support is propagated, and the first and last points</span>
<span class=sd>    of the supports are always included, even if this would cause</span>
<span class=sd>    n_points or ds to be violated.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>return</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=nelpy.core._eventarray.BinnedEventArray class="doc doc-heading"> <code>BinnedEventArray</code> </h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BaseEventArray>BaseEventArray</a></code></p> <p>BinnedEventArray.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>eventarray</code> </td> <td> <code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.EventArray>EventArray</a> or <a class="autorefs autorefs-internal" href=../analogsignalarray/#nelpy.core._analogsignalarray.RegularlySampledAnalogSignalArray>RegularlySampledAnalogSignalArray</a></code> </td> <td> <div class=doc-md-description> <p>Input data.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>ds</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>The bin width, in seconds. Default is 0.0625 (62.5 ms)</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>empty</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether an empty BinnedEventArray should be constructed (no data).</p> </div> </td> <td> <code>False</code> </td> </tr> <tr class=doc-section-item> <td> <code>fs</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Sampling rate in Hz. If fs is passed as a parameter, then data is assumed to be in sample numbers instead of actual data.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>kwargs</code> </td> <td> <code><span title=optional>optional</span></code> </td> <td> <div class=doc-md-description> <p>Additional keyword arguments to forward along to the BaseEventArray constructor.</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Attributes:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.BinnedEventArray.Note>Note</span></code></td> <td> <code>Read the docstring for the BaseEventArray superclass for additional</code> </td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="nelpy.core._eventarray.BinnedEventArray.attributes that are defined there.">attributes that are defined there.</span></code></td> <td> </td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.isempty>isempty</a></code></td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether the BinnedEventArray is empty (no data).</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.n_series>n_series</a></code></td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>The number of series.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.bin_centers>bin_centers</a></code></td> <td> <code><span title=numpy.ndarray>ndarray</span></code> </td> <td> <div class=doc-md-description> <p>The bin centers, in seconds.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.event_centers>event_centers</a></code></td> <td> <code><span title=numpy.ndarray>ndarray</span></code> </td> <td> <div class=doc-md-description> <p>The centers of each event, in seconds.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.data>data</a></code></td> <td> <code>np.array, with shape (n_series, n_bins)</code> </td> <td> <div class=doc-md-description> <p>Event counts in all bins.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.bins>bins</a></code></td> <td> <code><span title=numpy.ndarray>ndarray</span></code> </td> <td> <div class=doc-md-description> <p>The bin edges, in seconds.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.binned_support>binned_support</a></code></td> <td> <code>np.ndarray, with shape (n_intervals, 2)</code> </td> <td> <div class=doc-md-description> <p>The binned support of the BinnedEventArray (in bin IDs).</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.lengths>lengths</a></code></td> <td> <code><span title=numpy.ndarray>ndarray</span></code> </td> <td> <div class=doc-md-description> <p>Lengths of contiguous segments, in number of bins.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.eventarray>eventarray</a></code></td> <td> <code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.EventArray>EventArray</a></code> </td> <td> <div class=doc-md-description> <p>The original eventarray associated with the binned data.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.n_bins>n_bins</a></code></td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>The number of bins.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.ds>ds</a></code></td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Bin width, in seconds.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.n_active>n_active</a></code></td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>The number of active series. A series is considered active if it fired at least one event.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.n_active_per_bin>n_active_per_bin</a></code></td> <td> <code>np.ndarray, with shape (n_bins, )</code> </td> <td> <div class=doc-md-description> <p>Number of active series per data bin.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.n_events>n_events</a></code></td> <td> <code><span title=numpy.ndarray>ndarray</span></code> </td> <td> <div class=doc-md-description> <p>The number of events in each series.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.support>support</a></code></td> <td> <code><a class="autorefs autorefs-internal" href=../intervalarray/#nelpy.core._intervalarray.IntervalArray>IntervalArray</a></code> </td> <td> <div class=doc-md-description> <p>The support of the BinnedEventArray.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1034</span>
<span class=normal>1035</span>
<span class=normal>1036</span>
<span class=normal>1037</span>
<span class=normal>1038</span>
<span class=normal>1039</span>
<span class=normal>1040</span>
<span class=normal>1041</span>
<span class=normal>1042</span>
<span class=normal>1043</span>
<span class=normal>1044</span>
<span class=normal>1045</span>
<span class=normal>1046</span>
<span class=normal>1047</span>
<span class=normal>1048</span>
<span class=normal>1049</span>
<span class=normal>1050</span>
<span class=normal>1051</span>
<span class=normal>1052</span>
<span class=normal>1053</span>
<span class=normal>1054</span>
<span class=normal>1055</span>
<span class=normal>1056</span>
<span class=normal>1057</span>
<span class=normal>1058</span>
<span class=normal>1059</span>
<span class=normal>1060</span>
<span class=normal>1061</span>
<span class=normal>1062</span>
<span class=normal>1063</span>
<span class=normal>1064</span>
<span class=normal>1065</span>
<span class=normal>1066</span>
<span class=normal>1067</span>
<span class=normal>1068</span>
<span class=normal>1069</span>
<span class=normal>1070</span>
<span class=normal>1071</span>
<span class=normal>1072</span>
<span class=normal>1073</span>
<span class=normal>1074</span>
<span class=normal>1075</span>
<span class=normal>1076</span>
<span class=normal>1077</span>
<span class=normal>1078</span>
<span class=normal>1079</span>
<span class=normal>1080</span>
<span class=normal>1081</span>
<span class=normal>1082</span>
<span class=normal>1083</span>
<span class=normal>1084</span>
<span class=normal>1085</span>
<span class=normal>1086</span>
<span class=normal>1087</span>
<span class=normal>1088</span>
<span class=normal>1089</span>
<span class=normal>1090</span>
<span class=normal>1091</span>
<span class=normal>1092</span>
<span class=normal>1093</span>
<span class=normal>1094</span>
<span class=normal>1095</span>
<span class=normal>1096</span>
<span class=normal>1097</span>
<span class=normal>1098</span>
<span class=normal>1099</span>
<span class=normal>1100</span>
<span class=normal>1101</span>
<span class=normal>1102</span>
<span class=normal>1103</span>
<span class=normal>1104</span>
<span class=normal>1105</span>
<span class=normal>1106</span>
<span class=normal>1107</span>
<span class=normal>1108</span>
<span class=normal>1109</span>
<span class=normal>1110</span>
<span class=normal>1111</span>
<span class=normal>1112</span>
<span class=normal>1113</span>
<span class=normal>1114</span>
<span class=normal>1115</span>
<span class=normal>1116</span>
<span class=normal>1117</span>
<span class=normal>1118</span>
<span class=normal>1119</span>
<span class=normal>1120</span>
<span class=normal>1121</span>
<span class=normal>1122</span>
<span class=normal>1123</span>
<span class=normal>1124</span>
<span class=normal>1125</span>
<span class=normal>1126</span>
<span class=normal>1127</span>
<span class=normal>1128</span>
<span class=normal>1129</span>
<span class=normal>1130</span>
<span class=normal>1131</span>
<span class=normal>1132</span>
<span class=normal>1133</span>
<span class=normal>1134</span>
<span class=normal>1135</span>
<span class=normal>1136</span>
<span class=normal>1137</span>
<span class=normal>1138</span>
<span class=normal>1139</span>
<span class=normal>1140</span>
<span class=normal>1141</span>
<span class=normal>1142</span>
<span class=normal>1143</span>
<span class=normal>1144</span>
<span class=normal>1145</span>
<span class=normal>1146</span>
<span class=normal>1147</span>
<span class=normal>1148</span>
<span class=normal>1149</span>
<span class=normal>1150</span>
<span class=normal>1151</span>
<span class=normal>1152</span>
<span class=normal>1153</span>
<span class=normal>1154</span>
<span class=normal>1155</span>
<span class=normal>1156</span>
<span class=normal>1157</span>
<span class=normal>1158</span>
<span class=normal>1159</span>
<span class=normal>1160</span>
<span class=normal>1161</span>
<span class=normal>1162</span>
<span class=normal>1163</span>
<span class=normal>1164</span>
<span class=normal>1165</span>
<span class=normal>1166</span>
<span class=normal>1167</span>
<span class=normal>1168</span>
<span class=normal>1169</span>
<span class=normal>1170</span>
<span class=normal>1171</span>
<span class=normal>1172</span>
<span class=normal>1173</span>
<span class=normal>1174</span>
<span class=normal>1175</span>
<span class=normal>1176</span>
<span class=normal>1177</span>
<span class=normal>1178</span>
<span class=normal>1179</span>
<span class=normal>1180</span>
<span class=normal>1181</span>
<span class=normal>1182</span>
<span class=normal>1183</span>
<span class=normal>1184</span>
<span class=normal>1185</span>
<span class=normal>1186</span>
<span class=normal>1187</span>
<span class=normal>1188</span>
<span class=normal>1189</span>
<span class=normal>1190</span>
<span class=normal>1191</span>
<span class=normal>1192</span>
<span class=normal>1193</span>
<span class=normal>1194</span>
<span class=normal>1195</span>
<span class=normal>1196</span>
<span class=normal>1197</span>
<span class=normal>1198</span>
<span class=normal>1199</span>
<span class=normal>1200</span>
<span class=normal>1201</span>
<span class=normal>1202</span>
<span class=normal>1203</span>
<span class=normal>1204</span>
<span class=normal>1205</span>
<span class=normal>1206</span>
<span class=normal>1207</span>
<span class=normal>1208</span>
<span class=normal>1209</span>
<span class=normal>1210</span>
<span class=normal>1211</span>
<span class=normal>1212</span>
<span class=normal>1213</span>
<span class=normal>1214</span>
<span class=normal>1215</span>
<span class=normal>1216</span>
<span class=normal>1217</span>
<span class=normal>1218</span>
<span class=normal>1219</span>
<span class=normal>1220</span>
<span class=normal>1221</span>
<span class=normal>1222</span>
<span class=normal>1223</span>
<span class=normal>1224</span>
<span class=normal>1225</span>
<span class=normal>1226</span>
<span class=normal>1227</span>
<span class=normal>1228</span>
<span class=normal>1229</span>
<span class=normal>1230</span>
<span class=normal>1231</span>
<span class=normal>1232</span>
<span class=normal>1233</span>
<span class=normal>1234</span>
<span class=normal>1235</span>
<span class=normal>1236</span>
<span class=normal>1237</span>
<span class=normal>1238</span>
<span class=normal>1239</span>
<span class=normal>1240</span>
<span class=normal>1241</span>
<span class=normal>1242</span>
<span class=normal>1243</span>
<span class=normal>1244</span>
<span class=normal>1245</span>
<span class=normal>1246</span>
<span class=normal>1247</span>
<span class=normal>1248</span>
<span class=normal>1249</span>
<span class=normal>1250</span>
<span class=normal>1251</span>
<span class=normal>1252</span>
<span class=normal>1253</span>
<span class=normal>1254</span>
<span class=normal>1255</span>
<span class=normal>1256</span>
<span class=normal>1257</span>
<span class=normal>1258</span>
<span class=normal>1259</span>
<span class=normal>1260</span>
<span class=normal>1261</span>
<span class=normal>1262</span>
<span class=normal>1263</span>
<span class=normal>1264</span>
<span class=normal>1265</span>
<span class=normal>1266</span>
<span class=normal>1267</span>
<span class=normal>1268</span>
<span class=normal>1269</span>
<span class=normal>1270</span>
<span class=normal>1271</span>
<span class=normal>1272</span>
<span class=normal>1273</span>
<span class=normal>1274</span>
<span class=normal>1275</span>
<span class=normal>1276</span>
<span class=normal>1277</span>
<span class=normal>1278</span>
<span class=normal>1279</span>
<span class=normal>1280</span>
<span class=normal>1281</span>
<span class=normal>1282</span>
<span class=normal>1283</span>
<span class=normal>1284</span>
<span class=normal>1285</span>
<span class=normal>1286</span>
<span class=normal>1287</span>
<span class=normal>1288</span>
<span class=normal>1289</span>
<span class=normal>1290</span>
<span class=normal>1291</span>
<span class=normal>1292</span>
<span class=normal>1293</span>
<span class=normal>1294</span>
<span class=normal>1295</span>
<span class=normal>1296</span>
<span class=normal>1297</span>
<span class=normal>1298</span>
<span class=normal>1299</span>
<span class=normal>1300</span>
<span class=normal>1301</span>
<span class=normal>1302</span>
<span class=normal>1303</span>
<span class=normal>1304</span>
<span class=normal>1305</span>
<span class=normal>1306</span>
<span class=normal>1307</span>
<span class=normal>1308</span>
<span class=normal>1309</span>
<span class=normal>1310</span>
<span class=normal>1311</span>
<span class=normal>1312</span>
<span class=normal>1313</span>
<span class=normal>1314</span>
<span class=normal>1315</span>
<span class=normal>1316</span>
<span class=normal>1317</span>
<span class=normal>1318</span>
<span class=normal>1319</span>
<span class=normal>1320</span>
<span class=normal>1321</span>
<span class=normal>1322</span>
<span class=normal>1323</span>
<span class=normal>1324</span>
<span class=normal>1325</span>
<span class=normal>1326</span>
<span class=normal>1327</span>
<span class=normal>1328</span>
<span class=normal>1329</span>
<span class=normal>1330</span>
<span class=normal>1331</span>
<span class=normal>1332</span>
<span class=normal>1333</span>
<span class=normal>1334</span>
<span class=normal>1335</span>
<span class=normal>1336</span>
<span class=normal>1337</span>
<span class=normal>1338</span>
<span class=normal>1339</span>
<span class=normal>1340</span>
<span class=normal>1341</span>
<span class=normal>1342</span>
<span class=normal>1343</span>
<span class=normal>1344</span>
<span class=normal>1345</span>
<span class=normal>1346</span>
<span class=normal>1347</span>
<span class=normal>1348</span>
<span class=normal>1349</span>
<span class=normal>1350</span>
<span class=normal>1351</span>
<span class=normal>1352</span>
<span class=normal>1353</span>
<span class=normal>1354</span>
<span class=normal>1355</span>
<span class=normal>1356</span>
<span class=normal>1357</span>
<span class=normal>1358</span>
<span class=normal>1359</span>
<span class=normal>1360</span>
<span class=normal>1361</span>
<span class=normal>1362</span>
<span class=normal>1363</span>
<span class=normal>1364</span>
<span class=normal>1365</span>
<span class=normal>1366</span>
<span class=normal>1367</span>
<span class=normal>1368</span>
<span class=normal>1369</span>
<span class=normal>1370</span>
<span class=normal>1371</span>
<span class=normal>1372</span>
<span class=normal>1373</span>
<span class=normal>1374</span>
<span class=normal>1375</span>
<span class=normal>1376</span>
<span class=normal>1377</span>
<span class=normal>1378</span>
<span class=normal>1379</span>
<span class=normal>1380</span>
<span class=normal>1381</span>
<span class=normal>1382</span>
<span class=normal>1383</span>
<span class=normal>1384</span>
<span class=normal>1385</span>
<span class=normal>1386</span>
<span class=normal>1387</span>
<span class=normal>1388</span>
<span class=normal>1389</span>
<span class=normal>1390</span>
<span class=normal>1391</span>
<span class=normal>1392</span>
<span class=normal>1393</span>
<span class=normal>1394</span>
<span class=normal>1395</span>
<span class=normal>1396</span>
<span class=normal>1397</span>
<span class=normal>1398</span>
<span class=normal>1399</span>
<span class=normal>1400</span>
<span class=normal>1401</span>
<span class=normal>1402</span>
<span class=normal>1403</span>
<span class=normal>1404</span>
<span class=normal>1405</span>
<span class=normal>1406</span>
<span class=normal>1407</span>
<span class=normal>1408</span>
<span class=normal>1409</span>
<span class=normal>1410</span>
<span class=normal>1411</span>
<span class=normal>1412</span>
<span class=normal>1413</span>
<span class=normal>1414</span>
<span class=normal>1415</span>
<span class=normal>1416</span>
<span class=normal>1417</span>
<span class=normal>1418</span>
<span class=normal>1419</span>
<span class=normal>1420</span>
<span class=normal>1421</span>
<span class=normal>1422</span>
<span class=normal>1423</span>
<span class=normal>1424</span>
<span class=normal>1425</span>
<span class=normal>1426</span>
<span class=normal>1427</span>
<span class=normal>1428</span>
<span class=normal>1429</span>
<span class=normal>1430</span>
<span class=normal>1431</span>
<span class=normal>1432</span>
<span class=normal>1433</span>
<span class=normal>1434</span>
<span class=normal>1435</span>
<span class=normal>1436</span>
<span class=normal>1437</span>
<span class=normal>1438</span>
<span class=normal>1439</span>
<span class=normal>1440</span>
<span class=normal>1441</span>
<span class=normal>1442</span>
<span class=normal>1443</span>
<span class=normal>1444</span>
<span class=normal>1445</span>
<span class=normal>1446</span>
<span class=normal>1447</span>
<span class=normal>1448</span>
<span class=normal>1449</span>
<span class=normal>1450</span>
<span class=normal>1451</span>
<span class=normal>1452</span>
<span class=normal>1453</span>
<span class=normal>1454</span>
<span class=normal>1455</span>
<span class=normal>1456</span>
<span class=normal>1457</span>
<span class=normal>1458</span>
<span class=normal>1459</span>
<span class=normal>1460</span>
<span class=normal>1461</span>
<span class=normal>1462</span>
<span class=normal>1463</span>
<span class=normal>1464</span>
<span class=normal>1465</span>
<span class=normal>1466</span>
<span class=normal>1467</span>
<span class=normal>1468</span>
<span class=normal>1469</span>
<span class=normal>1470</span>
<span class=normal>1471</span>
<span class=normal>1472</span>
<span class=normal>1473</span>
<span class=normal>1474</span>
<span class=normal>1475</span>
<span class=normal>1476</span>
<span class=normal>1477</span>
<span class=normal>1478</span>
<span class=normal>1479</span>
<span class=normal>1480</span>
<span class=normal>1481</span>
<span class=normal>1482</span>
<span class=normal>1483</span>
<span class=normal>1484</span>
<span class=normal>1485</span>
<span class=normal>1486</span>
<span class=normal>1487</span>
<span class=normal>1488</span>
<span class=normal>1489</span>
<span class=normal>1490</span>
<span class=normal>1491</span>
<span class=normal>1492</span>
<span class=normal>1493</span>
<span class=normal>1494</span>
<span class=normal>1495</span>
<span class=normal>1496</span>
<span class=normal>1497</span>
<span class=normal>1498</span>
<span class=normal>1499</span>
<span class=normal>1500</span>
<span class=normal>1501</span>
<span class=normal>1502</span>
<span class=normal>1503</span>
<span class=normal>1504</span>
<span class=normal>1505</span>
<span class=normal>1506</span>
<span class=normal>1507</span>
<span class=normal>1508</span>
<span class=normal>1509</span>
<span class=normal>1510</span>
<span class=normal>1511</span>
<span class=normal>1512</span>
<span class=normal>1513</span>
<span class=normal>1514</span>
<span class=normal>1515</span>
<span class=normal>1516</span>
<span class=normal>1517</span>
<span class=normal>1518</span>
<span class=normal>1519</span>
<span class=normal>1520</span>
<span class=normal>1521</span>
<span class=normal>1522</span>
<span class=normal>1523</span>
<span class=normal>1524</span>
<span class=normal>1525</span>
<span class=normal>1526</span>
<span class=normal>1527</span>
<span class=normal>1528</span>
<span class=normal>1529</span>
<span class=normal>1530</span>
<span class=normal>1531</span>
<span class=normal>1532</span>
<span class=normal>1533</span>
<span class=normal>1534</span>
<span class=normal>1535</span>
<span class=normal>1536</span>
<span class=normal>1537</span>
<span class=normal>1538</span>
<span class=normal>1539</span>
<span class=normal>1540</span>
<span class=normal>1541</span>
<span class=normal>1542</span>
<span class=normal>1543</span>
<span class=normal>1544</span>
<span class=normal>1545</span>
<span class=normal>1546</span>
<span class=normal>1547</span>
<span class=normal>1548</span>
<span class=normal>1549</span>
<span class=normal>1550</span>
<span class=normal>1551</span>
<span class=normal>1552</span>
<span class=normal>1553</span>
<span class=normal>1554</span>
<span class=normal>1555</span>
<span class=normal>1556</span>
<span class=normal>1557</span>
<span class=normal>1558</span>
<span class=normal>1559</span>
<span class=normal>1560</span>
<span class=normal>1561</span>
<span class=normal>1562</span>
<span class=normal>1563</span>
<span class=normal>1564</span>
<span class=normal>1565</span>
<span class=normal>1566</span>
<span class=normal>1567</span>
<span class=normal>1568</span>
<span class=normal>1569</span>
<span class=normal>1570</span>
<span class=normal>1571</span>
<span class=normal>1572</span>
<span class=normal>1573</span>
<span class=normal>1574</span>
<span class=normal>1575</span>
<span class=normal>1576</span>
<span class=normal>1577</span>
<span class=normal>1578</span>
<span class=normal>1579</span>
<span class=normal>1580</span>
<span class=normal>1581</span>
<span class=normal>1582</span>
<span class=normal>1583</span>
<span class=normal>1584</span>
<span class=normal>1585</span>
<span class=normal>1586</span>
<span class=normal>1587</span>
<span class=normal>1588</span>
<span class=normal>1589</span>
<span class=normal>1590</span>
<span class=normal>1591</span>
<span class=normal>1592</span>
<span class=normal>1593</span>
<span class=normal>1594</span>
<span class=normal>1595</span>
<span class=normal>1596</span>
<span class=normal>1597</span>
<span class=normal>1598</span>
<span class=normal>1599</span>
<span class=normal>1600</span>
<span class=normal>1601</span>
<span class=normal>1602</span>
<span class=normal>1603</span>
<span class=normal>1604</span>
<span class=normal>1605</span>
<span class=normal>1606</span>
<span class=normal>1607</span>
<span class=normal>1608</span>
<span class=normal>1609</span>
<span class=normal>1610</span>
<span class=normal>1611</span>
<span class=normal>1612</span>
<span class=normal>1613</span>
<span class=normal>1614</span>
<span class=normal>1615</span>
<span class=normal>1616</span>
<span class=normal>1617</span>
<span class=normal>1618</span>
<span class=normal>1619</span>
<span class=normal>1620</span>
<span class=normal>1621</span>
<span class=normal>1622</span>
<span class=normal>1623</span>
<span class=normal>1624</span>
<span class=normal>1625</span>
<span class=normal>1626</span>
<span class=normal>1627</span>
<span class=normal>1628</span>
<span class=normal>1629</span>
<span class=normal>1630</span>
<span class=normal>1631</span>
<span class=normal>1632</span>
<span class=normal>1633</span>
<span class=normal>1634</span>
<span class=normal>1635</span>
<span class=normal>1636</span>
<span class=normal>1637</span>
<span class=normal>1638</span>
<span class=normal>1639</span>
<span class=normal>1640</span>
<span class=normal>1641</span>
<span class=normal>1642</span>
<span class=normal>1643</span>
<span class=normal>1644</span>
<span class=normal>1645</span>
<span class=normal>1646</span>
<span class=normal>1647</span>
<span class=normal>1648</span>
<span class=normal>1649</span>
<span class=normal>1650</span>
<span class=normal>1651</span>
<span class=normal>1652</span>
<span class=normal>1653</span>
<span class=normal>1654</span>
<span class=normal>1655</span>
<span class=normal>1656</span>
<span class=normal>1657</span>
<span class=normal>1658</span>
<span class=normal>1659</span>
<span class=normal>1660</span>
<span class=normal>1661</span>
<span class=normal>1662</span>
<span class=normal>1663</span>
<span class=normal>1664</span>
<span class=normal>1665</span>
<span class=normal>1666</span>
<span class=normal>1667</span>
<span class=normal>1668</span>
<span class=normal>1669</span>
<span class=normal>1670</span>
<span class=normal>1671</span>
<span class=normal>1672</span>
<span class=normal>1673</span>
<span class=normal>1674</span>
<span class=normal>1675</span>
<span class=normal>1676</span>
<span class=normal>1677</span>
<span class=normal>1678</span>
<span class=normal>1679</span>
<span class=normal>1680</span>
<span class=normal>1681</span>
<span class=normal>1682</span>
<span class=normal>1683</span>
<span class=normal>1684</span>
<span class=normal>1685</span>
<span class=normal>1686</span>
<span class=normal>1687</span>
<span class=normal>1688</span>
<span class=normal>1689</span>
<span class=normal>1690</span>
<span class=normal>1691</span>
<span class=normal>1692</span>
<span class=normal>1693</span>
<span class=normal>1694</span>
<span class=normal>1695</span>
<span class=normal>1696</span>
<span class=normal>1697</span>
<span class=normal>1698</span>
<span class=normal>1699</span>
<span class=normal>1700</span>
<span class=normal>1701</span>
<span class=normal>1702</span>
<span class=normal>1703</span>
<span class=normal>1704</span>
<span class=normal>1705</span>
<span class=normal>1706</span>
<span class=normal>1707</span>
<span class=normal>1708</span>
<span class=normal>1709</span>
<span class=normal>1710</span>
<span class=normal>1711</span>
<span class=normal>1712</span>
<span class=normal>1713</span>
<span class=normal>1714</span>
<span class=normal>1715</span>
<span class=normal>1716</span>
<span class=normal>1717</span>
<span class=normal>1718</span>
<span class=normal>1719</span>
<span class=normal>1720</span>
<span class=normal>1721</span>
<span class=normal>1722</span>
<span class=normal>1723</span>
<span class=normal>1724</span>
<span class=normal>1725</span>
<span class=normal>1726</span>
<span class=normal>1727</span>
<span class=normal>1728</span>
<span class=normal>1729</span>
<span class=normal>1730</span>
<span class=normal>1731</span>
<span class=normal>1732</span>
<span class=normal>1733</span>
<span class=normal>1734</span>
<span class=normal>1735</span>
<span class=normal>1736</span>
<span class=normal>1737</span>
<span class=normal>1738</span>
<span class=normal>1739</span>
<span class=normal>1740</span>
<span class=normal>1741</span>
<span class=normal>1742</span>
<span class=normal>1743</span>
<span class=normal>1744</span>
<span class=normal>1745</span>
<span class=normal>1746</span>
<span class=normal>1747</span>
<span class=normal>1748</span>
<span class=normal>1749</span>
<span class=normal>1750</span>
<span class=normal>1751</span>
<span class=normal>1752</span>
<span class=normal>1753</span>
<span class=normal>1754</span>
<span class=normal>1755</span>
<span class=normal>1756</span>
<span class=normal>1757</span>
<span class=normal>1758</span>
<span class=normal>1759</span>
<span class=normal>1760</span>
<span class=normal>1761</span>
<span class=normal>1762</span>
<span class=normal>1763</span>
<span class=normal>1764</span>
<span class=normal>1765</span>
<span class=normal>1766</span>
<span class=normal>1767</span>
<span class=normal>1768</span>
<span class=normal>1769</span>
<span class=normal>1770</span>
<span class=normal>1771</span>
<span class=normal>1772</span>
<span class=normal>1773</span>
<span class=normal>1774</span>
<span class=normal>1775</span>
<span class=normal>1776</span>
<span class=normal>1777</span>
<span class=normal>1778</span>
<span class=normal>1779</span>
<span class=normal>1780</span>
<span class=normal>1781</span>
<span class=normal>1782</span>
<span class=normal>1783</span>
<span class=normal>1784</span>
<span class=normal>1785</span>
<span class=normal>1786</span>
<span class=normal>1787</span>
<span class=normal>1788</span>
<span class=normal>1789</span>
<span class=normal>1790</span>
<span class=normal>1791</span>
<span class=normal>1792</span>
<span class=normal>1793</span>
<span class=normal>1794</span>
<span class=normal>1795</span>
<span class=normal>1796</span>
<span class=normal>1797</span>
<span class=normal>1798</span>
<span class=normal>1799</span>
<span class=normal>1800</span>
<span class=normal>1801</span>
<span class=normal>1802</span>
<span class=normal>1803</span>
<span class=normal>1804</span>
<span class=normal>1805</span>
<span class=normal>1806</span>
<span class=normal>1807</span>
<span class=normal>1808</span>
<span class=normal>1809</span>
<span class=normal>1810</span>
<span class=normal>1811</span>
<span class=normal>1812</span>
<span class=normal>1813</span>
<span class=normal>1814</span>
<span class=normal>1815</span>
<span class=normal>1816</span>
<span class=normal>1817</span>
<span class=normal>1818</span>
<span class=normal>1819</span>
<span class=normal>1820</span>
<span class=normal>1821</span>
<span class=normal>1822</span>
<span class=normal>1823</span>
<span class=normal>1824</span>
<span class=normal>1825</span>
<span class=normal>1826</span>
<span class=normal>1827</span>
<span class=normal>1828</span>
<span class=normal>1829</span>
<span class=normal>1830</span>
<span class=normal>1831</span>
<span class=normal>1832</span>
<span class=normal>1833</span>
<span class=normal>1834</span>
<span class=normal>1835</span>
<span class=normal>1836</span>
<span class=normal>1837</span>
<span class=normal>1838</span>
<span class=normal>1839</span>
<span class=normal>1840</span>
<span class=normal>1841</span>
<span class=normal>1842</span>
<span class=normal>1843</span>
<span class=normal>1844</span>
<span class=normal>1845</span>
<span class=normal>1846</span>
<span class=normal>1847</span>
<span class=normal>1848</span>
<span class=normal>1849</span>
<span class=normal>1850</span>
<span class=normal>1851</span>
<span class=normal>1852</span>
<span class=normal>1853</span>
<span class=normal>1854</span>
<span class=normal>1855</span>
<span class=normal>1856</span>
<span class=normal>1857</span>
<span class=normal>1858</span>
<span class=normal>1859</span>
<span class=normal>1860</span>
<span class=normal>1861</span>
<span class=normal>1862</span>
<span class=normal>1863</span>
<span class=normal>1864</span>
<span class=normal>1865</span>
<span class=normal>1866</span>
<span class=normal>1867</span>
<span class=normal>1868</span>
<span class=normal>1869</span>
<span class=normal>1870</span>
<span class=normal>1871</span>
<span class=normal>1872</span>
<span class=normal>1873</span>
<span class=normal>1874</span>
<span class=normal>1875</span>
<span class=normal>1876</span>
<span class=normal>1877</span>
<span class=normal>1878</span>
<span class=normal>1879</span>
<span class=normal>1880</span>
<span class=normal>1881</span>
<span class=normal>1882</span>
<span class=normal>1883</span>
<span class=normal>1884</span>
<span class=normal>1885</span>
<span class=normal>1886</span>
<span class=normal>1887</span>
<span class=normal>1888</span>
<span class=normal>1889</span>
<span class=normal>1890</span>
<span class=normal>1891</span>
<span class=normal>1892</span>
<span class=normal>1893</span>
<span class=normal>1894</span>
<span class=normal>1895</span>
<span class=normal>1896</span>
<span class=normal>1897</span>
<span class=normal>1898</span>
<span class=normal>1899</span>
<span class=normal>1900</span>
<span class=normal>1901</span>
<span class=normal>1902</span>
<span class=normal>1903</span>
<span class=normal>1904</span>
<span class=normal>1905</span>
<span class=normal>1906</span>
<span class=normal>1907</span>
<span class=normal>1908</span>
<span class=normal>1909</span>
<span class=normal>1910</span>
<span class=normal>1911</span>
<span class=normal>1912</span>
<span class=normal>1913</span>
<span class=normal>1914</span>
<span class=normal>1915</span>
<span class=normal>1916</span>
<span class=normal>1917</span>
<span class=normal>1918</span>
<span class=normal>1919</span>
<span class=normal>1920</span>
<span class=normal>1921</span>
<span class=normal>1922</span>
<span class=normal>1923</span>
<span class=normal>1924</span>
<span class=normal>1925</span>
<span class=normal>1926</span>
<span class=normal>1927</span>
<span class=normal>1928</span>
<span class=normal>1929</span>
<span class=normal>1930</span>
<span class=normal>1931</span>
<span class=normal>1932</span>
<span class=normal>1933</span>
<span class=normal>1934</span>
<span class=normal>1935</span>
<span class=normal>1936</span>
<span class=normal>1937</span>
<span class=normal>1938</span>
<span class=normal>1939</span>
<span class=normal>1940</span>
<span class=normal>1941</span>
<span class=normal>1942</span>
<span class=normal>1943</span>
<span class=normal>1944</span>
<span class=normal>1945</span>
<span class=normal>1946</span>
<span class=normal>1947</span>
<span class=normal>1948</span>
<span class=normal>1949</span>
<span class=normal>1950</span>
<span class=normal>1951</span>
<span class=normal>1952</span>
<span class=normal>1953</span>
<span class=normal>1954</span>
<span class=normal>1955</span>
<span class=normal>1956</span>
<span class=normal>1957</span>
<span class=normal>1958</span>
<span class=normal>1959</span>
<span class=normal>1960</span>
<span class=normal>1961</span>
<span class=normal>1962</span>
<span class=normal>1963</span>
<span class=normal>1964</span>
<span class=normal>1965</span>
<span class=normal>1966</span>
<span class=normal>1967</span>
<span class=normal>1968</span>
<span class=normal>1969</span>
<span class=normal>1970</span>
<span class=normal>1971</span>
<span class=normal>1972</span>
<span class=normal>1973</span>
<span class=normal>1974</span>
<span class=normal>1975</span>
<span class=normal>1976</span>
<span class=normal>1977</span>
<span class=normal>1978</span>
<span class=normal>1979</span>
<span class=normal>1980</span>
<span class=normal>1981</span>
<span class=normal>1982</span>
<span class=normal>1983</span>
<span class=normal>1984</span>
<span class=normal>1985</span>
<span class=normal>1986</span>
<span class=normal>1987</span>
<span class=normal>1988</span>
<span class=normal>1989</span>
<span class=normal>1990</span>
<span class=normal>1991</span>
<span class=normal>1992</span>
<span class=normal>1993</span>
<span class=normal>1994</span>
<span class=normal>1995</span>
<span class=normal>1996</span>
<span class=normal>1997</span>
<span class=normal>1998</span>
<span class=normal>1999</span>
<span class=normal>2000</span>
<span class=normal>2001</span>
<span class=normal>2002</span>
<span class=normal>2003</span>
<span class=normal>2004</span>
<span class=normal>2005</span>
<span class=normal>2006</span>
<span class=normal>2007</span>
<span class=normal>2008</span>
<span class=normal>2009</span>
<span class=normal>2010</span>
<span class=normal>2011</span>
<span class=normal>2012</span>
<span class=normal>2013</span>
<span class=normal>2014</span>
<span class=normal>2015</span>
<span class=normal>2016</span>
<span class=normal>2017</span>
<span class=normal>2018</span>
<span class=normal>2019</span>
<span class=normal>2020</span>
<span class=normal>2021</span>
<span class=normal>2022</span>
<span class=normal>2023</span>
<span class=normal>2024</span>
<span class=normal>2025</span>
<span class=normal>2026</span>
<span class=normal>2027</span>
<span class=normal>2028</span>
<span class=normal>2029</span>
<span class=normal>2030</span>
<span class=normal>2031</span>
<span class=normal>2032</span>
<span class=normal>2033</span>
<span class=normal>2034</span>
<span class=normal>2035</span>
<span class=normal>2036</span>
<span class=normal>2037</span>
<span class=normal>2038</span>
<span class=normal>2039</span>
<span class=normal>2040</span>
<span class=normal>2041</span>
<span class=normal>2042</span>
<span class=normal>2043</span>
<span class=normal>2044</span>
<span class=normal>2045</span>
<span class=normal>2046</span>
<span class=normal>2047</span>
<span class=normal>2048</span>
<span class=normal>2049</span>
<span class=normal>2050</span>
<span class=normal>2051</span>
<span class=normal>2052</span>
<span class=normal>2053</span>
<span class=normal>2054</span>
<span class=normal>2055</span>
<span class=normal>2056</span>
<span class=normal>2057</span>
<span class=normal>2058</span>
<span class=normal>2059</span>
<span class=normal>2060</span>
<span class=normal>2061</span>
<span class=normal>2062</span>
<span class=normal>2063</span>
<span class=normal>2064</span>
<span class=normal>2065</span>
<span class=normal>2066</span>
<span class=normal>2067</span>
<span class=normal>2068</span>
<span class=normal>2069</span>
<span class=normal>2070</span>
<span class=normal>2071</span>
<span class=normal>2072</span>
<span class=normal>2073</span>
<span class=normal>2074</span>
<span class=normal>2075</span>
<span class=normal>2076</span>
<span class=normal>2077</span>
<span class=normal>2078</span>
<span class=normal>2079</span>
<span class=normal>2080</span>
<span class=normal>2081</span>
<span class=normal>2082</span>
<span class=normal>2083</span>
<span class=normal>2084</span>
<span class=normal>2085</span>
<span class=normal>2086</span>
<span class=normal>2087</span>
<span class=normal>2088</span>
<span class=normal>2089</span>
<span class=normal>2090</span>
<span class=normal>2091</span>
<span class=normal>2092</span>
<span class=normal>2093</span>
<span class=normal>2094</span>
<span class=normal>2095</span>
<span class=normal>2096</span>
<span class=normal>2097</span>
<span class=normal>2098</span>
<span class=normal>2099</span>
<span class=normal>2100</span>
<span class=normal>2101</span>
<span class=normal>2102</span>
<span class=normal>2103</span>
<span class=normal>2104</span>
<span class=normal>2105</span>
<span class=normal>2106</span>
<span class=normal>2107</span>
<span class=normal>2108</span>
<span class=normal>2109</span>
<span class=normal>2110</span>
<span class=normal>2111</span>
<span class=normal>2112</span>
<span class=normal>2113</span>
<span class=normal>2114</span>
<span class=normal>2115</span>
<span class=normal>2116</span>
<span class=normal>2117</span>
<span class=normal>2118</span>
<span class=normal>2119</span>
<span class=normal>2120</span>
<span class=normal>2121</span>
<span class=normal>2122</span>
<span class=normal>2123</span>
<span class=normal>2124</span>
<span class=normal>2125</span>
<span class=normal>2126</span>
<span class=normal>2127</span>
<span class=normal>2128</span>
<span class=normal>2129</span>
<span class=normal>2130</span>
<span class=normal>2131</span>
<span class=normal>2132</span>
<span class=normal>2133</span>
<span class=normal>2134</span>
<span class=normal>2135</span>
<span class=normal>2136</span>
<span class=normal>2137</span>
<span class=normal>2138</span>
<span class=normal>2139</span>
<span class=normal>2140</span>
<span class=normal>2141</span>
<span class=normal>2142</span>
<span class=normal>2143</span>
<span class=normal>2144</span>
<span class=normal>2145</span>
<span class=normal>2146</span>
<span class=normal>2147</span>
<span class=normal>2148</span>
<span class=normal>2149</span>
<span class=normal>2150</span>
<span class=normal>2151</span>
<span class=normal>2152</span>
<span class=normal>2153</span>
<span class=normal>2154</span>
<span class=normal>2155</span>
<span class=normal>2156</span>
<span class=normal>2157</span>
<span class=normal>2158</span>
<span class=normal>2159</span>
<span class=normal>2160</span>
<span class=normal>2161</span>
<span class=normal>2162</span>
<span class=normal>2163</span>
<span class=normal>2164</span>
<span class=normal>2165</span>
<span class=normal>2166</span>
<span class=normal>2167</span>
<span class=normal>2168</span>
<span class=normal>2169</span>
<span class=normal>2170</span>
<span class=normal>2171</span>
<span class=normal>2172</span>
<span class=normal>2173</span>
<span class=normal>2174</span>
<span class=normal>2175</span>
<span class=normal>2176</span>
<span class=normal>2177</span>
<span class=normal>2178</span>
<span class=normal>2179</span>
<span class=normal>2180</span>
<span class=normal>2181</span>
<span class=normal>2182</span>
<span class=normal>2183</span>
<span class=normal>2184</span>
<span class=normal>2185</span>
<span class=normal>2186</span>
<span class=normal>2187</span>
<span class=normal>2188</span>
<span class=normal>2189</span>
<span class=normal>2190</span>
<span class=normal>2191</span>
<span class=normal>2192</span>
<span class=normal>2193</span>
<span class=normal>2194</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>BinnedEventArray</span><span class=p>(</span><span class=n>BaseEventArray</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;BinnedEventArray.</span>

<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    eventarray : nelpy.EventArray or nelpy.RegularlySampledAnalogSignalArray</span>
<span class=sd>        Input data.</span>
<span class=sd>    ds : float</span>
<span class=sd>        The bin width, in seconds.</span>
<span class=sd>        Default is 0.0625 (62.5 ms)</span>
<span class=sd>    empty : bool, optional</span>
<span class=sd>        Whether an empty BinnedEventArray should be constructed (no data).</span>
<span class=sd>    fs : float, optional</span>
<span class=sd>        Sampling rate in Hz. If fs is passed as a parameter, then data</span>
<span class=sd>        is assumed to be in sample numbers instead of actual data.</span>
<span class=sd>    kwargs : optional</span>
<span class=sd>        Additional keyword arguments to forward along to the BaseEventArray</span>
<span class=sd>        constructor.</span>

<span class=sd>    Attributes</span>
<span class=sd>    ----------</span>
<span class=sd>    Note : Read the docstring for the BaseEventArray superclass for additional</span>
<span class=sd>    attributes that are defined there.</span>
<span class=sd>    isempty : bool</span>
<span class=sd>        Whether the BinnedEventArray is empty (no data).</span>
<span class=sd>    n_series : int</span>
<span class=sd>        The number of series.</span>
<span class=sd>    bin_centers : np.ndarray</span>
<span class=sd>        The bin centers, in seconds.</span>
<span class=sd>    event_centers : np.ndarray</span>
<span class=sd>        The centers of each event, in seconds.</span>
<span class=sd>    data : np.array, with shape (n_series, n_bins)</span>
<span class=sd>        Event counts in all bins.</span>
<span class=sd>    bins : np.ndarray</span>
<span class=sd>        The bin edges, in seconds.</span>
<span class=sd>    binned_support : np.ndarray, with shape (n_intervals, 2)</span>
<span class=sd>        The binned support of the BinnedEventArray (in</span>
<span class=sd>        bin IDs).</span>
<span class=sd>    lengths : np.ndarray</span>
<span class=sd>        Lengths of contiguous segments, in number of bins.</span>
<span class=sd>    eventarray : nelpy.EventArray</span>
<span class=sd>        The original eventarray associated with the binned data.</span>
<span class=sd>    n_bins : int</span>
<span class=sd>        The number of bins.</span>
<span class=sd>    ds : float</span>
<span class=sd>        Bin width, in seconds.</span>
<span class=sd>    n_active : int</span>
<span class=sd>        The number of active series. A series is considered active if</span>
<span class=sd>        it fired at least one event.</span>
<span class=sd>    n_active_per_bin : np.ndarray, with shape (n_bins, )</span>
<span class=sd>        Number of active series per data bin.</span>
<span class=sd>    n_events : np.ndarray</span>
<span class=sd>        The number of events in each series.</span>
<span class=sd>    support : nelpy.IntervalArray</span>
<span class=sd>        The support of the BinnedEventArray.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>__attributes__</span> <span class=o>=</span> <span class=p>[</span>
        <span class=s2>&quot;_ds&quot;</span><span class=p>,</span>
        <span class=s2>&quot;_bins&quot;</span><span class=p>,</span>
        <span class=s2>&quot;_data&quot;</span><span class=p>,</span>
        <span class=s2>&quot;_bin_centers&quot;</span><span class=p>,</span>
        <span class=s2>&quot;_binned_support&quot;</span><span class=p>,</span>
        <span class=s2>&quot;_eventarray&quot;</span><span class=p>,</span>
    <span class=p>]</span>
    <span class=n>__attributes__</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>BaseEventArray</span><span class=o>.</span><span class=n>__attributes__</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>eventarray</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>ds</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>empty</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>empty</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

        <span class=c1># if an empty object is requested, return it:</span>
        <span class=k>if</span> <span class=n>empty</span><span class=p>:</span>
            <span class=c1># super().__init__(empty=True)</span>
            <span class=k>for</span> <span class=n>attr</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>__attributes__</span><span class=p>:</span>
                <span class=n>exec</span><span class=p>(</span><span class=s2>&quot;self.&quot;</span> <span class=o>+</span> <span class=n>attr</span> <span class=o>+</span> <span class=s2>&quot; = None&quot;</span><span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)(</span><span class=n>empty</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_event_centers</span> <span class=o>=</span> <span class=kc>None</span>
            <span class=k>return</span>

        <span class=c1># handle casting other nelpy objects to BinnedEventArray:</span>
        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>eventarray</span><span class=p>,</span> <span class=n>core</span><span class=o>.</span><span class=n>RegularlySampledAnalogSignalArray</span><span class=p>):</span>
            <span class=k>if</span> <span class=n>eventarray</span><span class=o>.</span><span class=n>isempty</span><span class=p>:</span>
                <span class=k>for</span> <span class=n>attr</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>__attributes__</span><span class=p>:</span>
                    <span class=n>exec</span><span class=p>(</span><span class=s2>&quot;self.&quot;</span> <span class=o>+</span> <span class=n>attr</span> <span class=o>+</span> <span class=s2>&quot; = None&quot;</span><span class=p>)</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=n>eventarray</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)(</span><span class=n>empty</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_event_centers</span> <span class=o>=</span> <span class=kc>None</span>
                <span class=k>return</span>
            <span class=n>eventarray</span> <span class=o>=</span> <span class=n>eventarray</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>  <span class=c1># Note: this is a deep copy</span>
            <span class=n>n_empty_epochs</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>eventarray</span><span class=o>.</span><span class=n>support</span><span class=o>.</span><span class=n>lengths</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>n_empty_epochs</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
                <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
                    <span class=s2>&quot;Detected </span><span class=si>{}</span><span class=s2> empty epochs. Removing these in the cast object&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                        <span class=n>n_empty_epochs</span>
                    <span class=p>)</span>
                <span class=p>)</span>
                <span class=n>eventarray</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=n>eventarray</span><span class=o>.</span><span class=n>support</span><span class=o>.</span><span class=n>_drop_empty_intervals</span><span class=p>()</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>eventarray</span><span class=o>.</span><span class=n>support</span><span class=o>.</span><span class=n>ismerged</span><span class=p>:</span>
                <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
                    <span class=s2>&quot;Detected overlapping epochs. Merging these in the cast object&quot;</span>
                <span class=p>)</span>
                <span class=n>eventarray</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=n>eventarray</span><span class=o>.</span><span class=n>support</span><span class=o>.</span><span class=n>merge</span><span class=p>()</span>

            <span class=bp>self</span><span class=o>.</span><span class=n>_eventarray</span> <span class=o>=</span> <span class=kc>None</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_ds</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>/</span> <span class=n>eventarray</span><span class=o>.</span><span class=n>fs</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_series_labels</span> <span class=o>=</span> <span class=n>eventarray</span><span class=o>.</span><span class=n>_series_labels</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_bin_centers</span> <span class=o>=</span> <span class=n>eventarray</span><span class=o>.</span><span class=n>abscissa_vals</span>
            <span class=n>tmp</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>cumsum</span><span class=p>(</span><span class=n>eventarray</span><span class=o>.</span><span class=n>lengths</span><span class=p>),</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_binned_support</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>((</span><span class=n>tmp</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span> <span class=n>tmp</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span> <span class=o>-</span> <span class=mi>1</span><span class=p>))</span><span class=o>.</span><span class=n>T</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=n>eventarray</span><span class=o>.</span><span class=n>support</span>
            <span class=k>try</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_series_ids</span> <span class=o>=</span> <span class=p>(</span>
                    <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>eventarray</span><span class=o>.</span><span class=n>series_labels</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>
                <span class=p>)</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
            <span class=k>except</span> <span class=p>(</span><span class=ne>ValueError</span><span class=p>,</span> <span class=ne>TypeError</span><span class=p>):</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_series_ids</span> <span class=o>=</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>eventarray</span><span class=o>.</span><span class=n>n_signals</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>eventarray</span><span class=o>.</span><span class=n>_ydata_rowsig</span>

            <span class=n>bins</span> <span class=o>=</span> <span class=p>[]</span>
            <span class=k>for</span> <span class=n>starti</span><span class=p>,</span> <span class=n>stopi</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_binned_support</span><span class=p>:</span>
                <span class=n>bins_edges_in_interval</span> <span class=o>=</span> <span class=p>(</span>
                    <span class=bp>self</span><span class=o>.</span><span class=n>_bin_centers</span><span class=p>[</span><span class=n>starti</span> <span class=p>:</span> <span class=n>stopi</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>_ds</span> <span class=o>/</span> <span class=mi>2</span>
                <span class=p>)</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
                <span class=n>bins_edges_in_interval</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_bin_centers</span><span class=p>[</span><span class=n>stopi</span><span class=p>]</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>_ds</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span>
                <span class=n>bins</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>bins_edges_in_interval</span><span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_bins</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>bins</span><span class=p>)</span>
            <span class=k>return</span>

        <span class=k>if</span> <span class=nb>type</span><span class=p>(</span><span class=n>eventarray</span><span class=p>)</span><span class=o>.</span><span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;BinnedSpikeTrainArray&quot;</span><span class=p>:</span>
            <span class=c1># old-style nelpy BinnedSpikeTrainArray object?</span>
            <span class=k>try</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_eventarray</span> <span class=o>=</span> <span class=n>eventarray</span><span class=o>.</span><span class=n>_spiketrainarray</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_ds</span> <span class=o>=</span> <span class=n>eventarray</span><span class=o>.</span><span class=n>ds</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_series_labels</span> <span class=o>=</span> <span class=n>eventarray</span><span class=o>.</span><span class=n>unit_labels</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_bin_centers</span> <span class=o>=</span> <span class=n>eventarray</span><span class=o>.</span><span class=n>bin_centers</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_binned_support</span> <span class=o>=</span> <span class=n>eventarray</span><span class=o>.</span><span class=n>binned_support</span>
                <span class=k>try</span><span class=p>:</span>
                    <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=n>core</span><span class=o>.</span><span class=n>EpochArray</span><span class=p>(</span><span class=n>eventarray</span><span class=o>.</span><span class=n>support</span><span class=o>.</span><span class=n>data</span><span class=p>)</span>
                <span class=k>except</span> <span class=ne>AttributeError</span><span class=p>:</span>
                    <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=n>core</span><span class=o>.</span><span class=n>EpochArray</span><span class=p>(</span><span class=n>eventarray</span><span class=o>.</span><span class=n>support</span><span class=o>.</span><span class=n>time</span><span class=p>)</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_series_ids</span> <span class=o>=</span> <span class=n>eventarray</span><span class=o>.</span><span class=n>unit_ids</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>eventarray</span><span class=o>.</span><span class=n>data</span>
                <span class=k>return</span>
            <span class=k>except</span> <span class=ne>Exception</span><span class=p>:</span>
                <span class=k>pass</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>eventarray</span><span class=p>,</span> <span class=n>EventArray</span><span class=p>):</span>
            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s2>&quot;eventarray must be a nelpy.EventArray object.&quot;</span><span class=p>)</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_ds</span> <span class=o>=</span> <span class=kc>None</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_bin_centers</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([])</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_event_centers</span> <span class=o>=</span> <span class=kc>None</span>

        <span class=n>logging</span><span class=o>.</span><span class=n>disable</span><span class=p>(</span><span class=n>logging</span><span class=o>.</span><span class=n>CRITICAL</span><span class=p>)</span>
        <span class=n>kwargs</span> <span class=o>=</span> <span class=p>{</span>
            <span class=s2>&quot;fs&quot;</span><span class=p>:</span> <span class=n>eventarray</span><span class=o>.</span><span class=n>fs</span><span class=p>,</span>
            <span class=s2>&quot;series_ids&quot;</span><span class=p>:</span> <span class=n>eventarray</span><span class=o>.</span><span class=n>series_ids</span><span class=p>,</span>
            <span class=s2>&quot;series_labels&quot;</span><span class=p>:</span> <span class=n>eventarray</span><span class=o>.</span><span class=n>series_labels</span><span class=p>,</span>
            <span class=s2>&quot;series_tags&quot;</span><span class=p>:</span> <span class=n>eventarray</span><span class=o>.</span><span class=n>series_tags</span><span class=p>,</span>
            <span class=s2>&quot;label&quot;</span><span class=p>:</span> <span class=n>eventarray</span><span class=o>.</span><span class=n>label</span><span class=p>,</span>
        <span class=p>}</span>
        <span class=n>logging</span><span class=o>.</span><span class=n>disable</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>

        <span class=c1># initialize super so that self.fs is set:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>eventarray</span><span class=o>.</span><span class=n>n_series</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span>
        <span class=c1># the above is necessary so that super() can determine</span>
        <span class=c1># self.n_series when initializing. self.data will</span>
        <span class=c1># be updated later in __init__ to reflect subsequent changes</span>
        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>

        <span class=k>if</span> <span class=n>ds</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;no bin size was given, assuming 62.5 ms&quot;</span><span class=p>)</span>
            <span class=n>ds</span> <span class=o>=</span> <span class=mf>0.0625</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_eventarray</span> <span class=o>=</span> <span class=n>eventarray</span>  <span class=c1># TODO: remove this if we don&#39;t need it, or decide that it&#39;s too wasteful</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span> <span class=o>=</span> <span class=n>copy</span><span class=o>.</span><span class=n>deepcopy</span><span class=p>(</span><span class=n>eventarray</span><span class=o>.</span><span class=n>_abscissa</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>ds</span> <span class=o>=</span> <span class=n>ds</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_bin_events</span><span class=p>(</span><span class=n>eventarray</span><span class=o>=</span><span class=n>eventarray</span><span class=p>,</span> <span class=n>intervalArray</span><span class=o>=</span><span class=n>eventarray</span><span class=o>.</span><span class=n>support</span><span class=p>,</span> <span class=n>ds</span><span class=o>=</span><span class=n>ds</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__mul__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Overloaded * operator&quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>other</span><span class=p>,</span> <span class=n>numbers</span><span class=o>.</span><span class=n>Number</span><span class=p>):</span>
            <span class=n>neweva</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
            <span class=n>neweva</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span> <span class=o>*</span> <span class=n>other</span>
            <span class=k>return</span> <span class=n>neweva</span>
        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>other</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>):</span>
            <span class=n>neweva</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
            <span class=n>neweva</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>T</span> <span class=o>*</span> <span class=n>other</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>
            <span class=k>return</span> <span class=n>neweva</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
                <span class=s2>&quot;unsupported operand type(s) for *: &#39;</span><span class=si>{}</span><span class=s2>&#39; and &#39;</span><span class=si>{}</span><span class=s2>&#39;&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                    <span class=nb>str</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=p>)),</span> <span class=nb>str</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=n>other</span><span class=p>))</span>
                <span class=p>)</span>
            <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__rmul__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Overloaded * operator&quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=fm>__mul__</span><span class=p>(</span><span class=n>other</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__sub__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Overloaded - operator&quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>other</span><span class=p>,</span> <span class=n>numbers</span><span class=o>.</span><span class=n>Number</span><span class=p>):</span>
            <span class=n>neweva</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
            <span class=n>neweva</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span> <span class=o>-</span> <span class=n>other</span>
            <span class=k>return</span> <span class=n>neweva</span>
        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>other</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>):</span>
            <span class=n>neweva</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
            <span class=n>neweva</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>T</span> <span class=o>-</span> <span class=n>other</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>
            <span class=k>return</span> <span class=n>neweva</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
                <span class=s2>&quot;unsupported operand type(s) for -: &#39;</span><span class=si>{}</span><span class=s2>&#39; and &#39;</span><span class=si>{}</span><span class=s2>&#39;&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                    <span class=nb>str</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=p>)),</span> <span class=nb>str</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=n>other</span><span class=p>))</span>
                <span class=p>)</span>
            <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__add__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Overloaded + operator&quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>other</span><span class=p>,</span> <span class=n>numbers</span><span class=o>.</span><span class=n>Number</span><span class=p>):</span>
            <span class=n>neweva</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
            <span class=n>neweva</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span> <span class=o>+</span> <span class=n>other</span>
            <span class=k>return</span> <span class=n>neweva</span>
        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>other</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>):</span>
            <span class=n>neweva</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
            <span class=n>neweva</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>T</span> <span class=o>+</span> <span class=n>other</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>
            <span class=k>return</span> <span class=n>neweva</span>
        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>other</span><span class=p>,</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=p>)):</span>
            <span class=c1># TODO: additional checks need to be done, e.g., same series ids...</span>
            <span class=k>assert</span> <span class=bp>self</span><span class=o>.</span><span class=n>n_series</span> <span class=o>==</span> <span class=n>other</span><span class=o>.</span><span class=n>n_series</span>
            <span class=n>support</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>+</span> <span class=n>other</span><span class=o>.</span><span class=n>support</span>

            <span class=n>newdata</span> <span class=o>=</span> <span class=p>[]</span>
            <span class=k>for</span> <span class=n>series</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>n_series</span><span class=p>):</span>
                <span class=n>newdata</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=n>series</span><span class=p>],</span> <span class=n>other</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=n>series</span><span class=p>]))</span>

            <span class=n>fs</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>fs</span>
            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>fs</span> <span class=o>!=</span> <span class=n>other</span><span class=o>.</span><span class=n>fs</span><span class=p>:</span>
                <span class=n>fs</span> <span class=o>=</span> <span class=kc>None</span>
            <span class=k>return</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=p>)(</span><span class=n>newdata</span><span class=p>,</span> <span class=n>support</span><span class=o>=</span><span class=n>support</span><span class=p>,</span> <span class=n>fs</span><span class=o>=</span><span class=n>fs</span><span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
                <span class=s2>&quot;unsupported operand type(s) for +: &#39;</span><span class=si>{}</span><span class=s2>&#39; and &#39;</span><span class=si>{}</span><span class=s2>&#39;&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                    <span class=nb>str</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=p>)),</span> <span class=nb>str</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=n>other</span><span class=p>))</span>
                <span class=p>)</span>
            <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__truediv__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Overloaded / operator&quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>other</span><span class=p>,</span> <span class=n>numbers</span><span class=o>.</span><span class=n>Number</span><span class=p>):</span>
            <span class=n>neweva</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
            <span class=n>neweva</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span> <span class=o>/</span> <span class=n>other</span>
            <span class=k>return</span> <span class=n>neweva</span>
        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>other</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>):</span>
            <span class=n>neweva</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
            <span class=n>neweva</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>T</span> <span class=o>/</span> <span class=n>other</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>
            <span class=k>return</span> <span class=n>neweva</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
                <span class=s2>&quot;unsupported operand type(s) for /: &#39;</span><span class=si>{}</span><span class=s2>&#39; and &#39;</span><span class=si>{}</span><span class=s2>&#39;&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                    <span class=nb>str</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=p>)),</span> <span class=nb>str</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=n>other</span><span class=p>))</span>
                <span class=p>)</span>
            <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>median</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Returns the median of each series in BinnedEventArray.&quot;&quot;&quot;</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=n>medians</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nanmedian</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=n>axis</span><span class=p>)</span><span class=o>.</span><span class=n>squeeze</span><span class=p>()</span>
            <span class=k>if</span> <span class=n>medians</span><span class=o>.</span><span class=n>size</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
                <span class=k>return</span> <span class=n>medians</span><span class=o>.</span><span class=n>item</span><span class=p>()</span>
            <span class=k>return</span> <span class=n>medians</span>
        <span class=k>except</span> <span class=ne>IndexError</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>IndexError</span><span class=p>(</span><span class=s2>&quot;Empty BinnedEventArray; cannot calculate median.&quot;</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>mean</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Returns the mean of each series in BinnedEventArray.&quot;&quot;&quot;</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=n>means</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nanmean</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=n>axis</span><span class=p>)</span><span class=o>.</span><span class=n>squeeze</span><span class=p>()</span>
            <span class=k>if</span> <span class=n>means</span><span class=o>.</span><span class=n>size</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
                <span class=k>return</span> <span class=n>means</span><span class=o>.</span><span class=n>item</span><span class=p>()</span>
            <span class=k>return</span> <span class=n>means</span>
        <span class=k>except</span> <span class=ne>IndexError</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>IndexError</span><span class=p>(</span><span class=s2>&quot;Empty BinnedEventArray; cannot calculate mean.&quot;</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>std</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Returns the standard deviation of each series in BinnedEventArray.&quot;&quot;&quot;</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=n>stds</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nanstd</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=n>axis</span><span class=p>)</span><span class=o>.</span><span class=n>squeeze</span><span class=p>()</span>
            <span class=k>if</span> <span class=n>stds</span><span class=o>.</span><span class=n>size</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
                <span class=k>return</span> <span class=n>stds</span><span class=o>.</span><span class=n>item</span><span class=p>()</span>
            <span class=k>return</span> <span class=n>stds</span>
        <span class=k>except</span> <span class=ne>IndexError</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>IndexError</span><span class=p>(</span>
                <span class=s2>&quot;Empty BinnedEventArray; cannot calculate standard deviation&quot;</span>
            <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>center</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Center data (zero mean).&quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=n>inplace</span><span class=p>:</span>
            <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
        <span class=n>out</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=p>(</span><span class=n>out</span><span class=o>.</span><span class=n>_data</span><span class=o>.</span><span class=n>T</span> <span class=o>-</span> <span class=n>out</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span><span class=o>.</span><span class=n>T</span>
        <span class=k>return</span> <span class=n>out</span>

    <span class=k>def</span><span class=w> </span><span class=nf>normalize</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Normalize data (unit standard deviation).&quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=n>inplace</span><span class=p>:</span>
            <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
        <span class=n>std</span> <span class=o>=</span> <span class=n>out</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>
        <span class=n>std</span><span class=p>[</span><span class=n>std</span> <span class=o>==</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
        <span class=n>out</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=p>(</span><span class=n>out</span><span class=o>.</span><span class=n>_data</span><span class=o>.</span><span class=n>T</span> <span class=o>/</span> <span class=n>std</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>
        <span class=k>return</span> <span class=n>out</span>

    <span class=k>def</span><span class=w> </span><span class=nf>standardize</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Standardize data (zero mean and unit std deviation).&quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=n>inplace</span><span class=p>:</span>
            <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
        <span class=n>out</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=p>(</span><span class=n>out</span><span class=o>.</span><span class=n>_data</span><span class=o>.</span><span class=n>T</span> <span class=o>-</span> <span class=n>out</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span><span class=o>.</span><span class=n>T</span>
        <span class=n>std</span> <span class=o>=</span> <span class=n>out</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>
        <span class=n>std</span><span class=p>[</span><span class=n>std</span> <span class=o>==</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
        <span class=n>out</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=p>(</span><span class=n>out</span><span class=o>.</span><span class=n>_data</span><span class=o>.</span><span class=n>T</span> <span class=o>/</span> <span class=n>std</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>

        <span class=k>return</span> <span class=n>out</span>

    <span class=nd>@keyword_equivalence</span><span class=p>(</span><span class=n>this_or_that</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;n_intervals&quot;</span><span class=p>:</span> <span class=s2>&quot;n_epochs&quot;</span><span class=p>})</span>
    <span class=k>def</span><span class=w> </span><span class=nf>partition</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ds</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>n_intervals</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Returns a BaseEventArray whose support has been partitioned.</span>

<span class=sd>        Parameters</span>
<span class=sd>        ----------</span>
<span class=sd>        ds : float, optional</span>
<span class=sd>            Maximum duration (in seconds), for each interval.</span>
<span class=sd>        n_points : int, optional</span>
<span class=sd>            Number of intervals. If ds is None and n_intervals is None, then</span>
<span class=sd>            default is to use n_intervals = 100</span>

<span class=sd>        Returns</span>
<span class=sd>        -------</span>
<span class=sd>        out : BaseEventArray</span>
<span class=sd>            BaseEventArray that has been partitioned.</span>

<span class=sd>        Notes</span>
<span class=sd>        -----</span>
<span class=sd>        Irrespective of whether &#39;ds&#39; or &#39;n_intervals&#39; are used, the exact</span>
<span class=sd>        of the supports are always included, even if this would cause</span>
<span class=sd>        n_points or ds to be violated.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=n>partitioned</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=p>)(</span>
            <span class=n>core</span><span class=o>.</span><span class=n>RegularlySampledAnalogSignalArray</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span><span class=o>.</span><span class=n>partition</span><span class=p>(</span>
                <span class=n>ds</span><span class=o>=</span><span class=n>ds</span><span class=p>,</span> <span class=n>n_intervals</span><span class=o>=</span><span class=n>n_intervals</span>
            <span class=p>)</span>
        <span class=p>)</span>
        <span class=c1># partitioned.loc = ItemGetter_loc(partitioned)</span>
        <span class=c1># partitioned.iloc = ItemGetter_iloc(partitioned)</span>
        <span class=k>return</span> <span class=n>partitioned</span>

        <span class=c1># raise NotImplementedError(&#39;workaround: cast to AnalogSignalArray, partition, and cast back to BinnedEventArray&#39;)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_copy_without_data</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Returns a copy of the BinnedEventArray, without data.</span>
<span class=sd>        Note: the support is left unchanged, but the binned_support is removed.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>out</span> <span class=o>=</span> <span class=n>copy</span><span class=o>.</span><span class=n>copy</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>  <span class=c1># shallow copy</span>
        <span class=n>out</span><span class=o>.</span><span class=n>_bin_centers</span> <span class=o>=</span> <span class=kc>None</span>
        <span class=n>out</span><span class=o>.</span><span class=n>_binned_support</span> <span class=o>=</span> <span class=kc>None</span>
        <span class=n>out</span><span class=o>.</span><span class=n>_bins</span> <span class=o>=</span> <span class=kc>None</span>
        <span class=n>out</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=bp>self</span><span class=o>.</span><span class=n>n_series</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span>
        <span class=n>out</span><span class=o>.</span><span class=n>_eventarray</span> <span class=o>=</span> <span class=n>out</span><span class=o>.</span><span class=n>_eventarray</span><span class=o>.</span><span class=n>_copy_without_data</span><span class=p>()</span>
        <span class=n>out</span> <span class=o>=</span> <span class=n>copy</span><span class=o>.</span><span class=n>deepcopy</span><span class=p>(</span>
            <span class=n>out</span>
        <span class=p>)</span>  <span class=c1># just to be on the safe side, but at least now we are not copying the data!</span>
        <span class=n>out</span><span class=o>.</span><span class=n>__renew__</span><span class=p>()</span>
        <span class=k>return</span> <span class=n>out</span>

    <span class=k>def</span><span class=w> </span><span class=nf>copy</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Returns a copy of the BinnedEventArray.&quot;&quot;&quot;</span>
        <span class=n>newcopy</span> <span class=o>=</span> <span class=n>copy</span><span class=o>.</span><span class=n>deepcopy</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>
        <span class=n>newcopy</span><span class=o>.</span><span class=n>__renew__</span><span class=p>()</span>
        <span class=k>return</span> <span class=n>newcopy</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__repr__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=n>address_str</span> <span class=o>=</span> <span class=s2>&quot; at &quot;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=nb>hex</span><span class=p>(</span><span class=nb>id</span><span class=p>(</span><span class=bp>self</span><span class=p>)))</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>isempty</span><span class=p>:</span>
            <span class=k>return</span> <span class=s2>&quot;&lt;empty &quot;</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>type_name</span> <span class=o>+</span> <span class=n>address_str</span> <span class=o>+</span> <span class=s2>&quot;&gt;&quot;</span>
        <span class=c1># Summarize labels if too many</span>
        <span class=n>max_display</span> <span class=o>=</span> <span class=mi>5</span>
        <span class=n>labels</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_series_labels</span>
        <span class=n>n</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>labels</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>n</span> <span class=o>&lt;=</span> <span class=n>max_display</span><span class=p>:</span>
            <span class=n>label_str</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>labels</span><span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>label_str</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;[</span><span class=si>{</span><span class=s1>&#39;, &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=nb>str</span><span class=p>,</span><span class=w> </span><span class=n>labels</span><span class=p>[:</span><span class=mi>3</span><span class=p>]))</span><span class=si>}</span><span class=s2>, ..., </span><span class=si>{</span><span class=s1>&#39;, &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=nb>str</span><span class=p>,</span><span class=w> </span><span class=n>labels</span><span class=p>[</span><span class=o>-</span><span class=mi>2</span><span class=p>:]))</span><span class=si>}</span><span class=s2>]&quot;</span>
        <span class=n>ustr</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot; </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>n_series</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>label_str</span><span class=si>}</span><span class=s2>&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=o>.</span><span class=n>n_intervals</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
            <span class=n>epstr</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot; (</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=o>.</span><span class=n>n_intervals</span><span class=si>}</span><span class=s2> segments) in&quot;</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>epstr</span> <span class=o>=</span> <span class=s2>&quot; in&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>n_bins</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
            <span class=n>bstr</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot; </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>n_bins</span><span class=si>}</span><span class=s2> bin of width </span><span class=si>{</span><span class=n>utils</span><span class=o>.</span><span class=n>PrettyDuration</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ds</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
            <span class=n>dstr</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>bstr</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot; </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>n_bins</span><span class=si>}</span><span class=s2> bins of width </span><span class=si>{</span><span class=n>utils</span><span class=o>.</span><span class=n>PrettyDuration</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ds</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
            <span class=n>dstr</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot; for a total of </span><span class=si>{</span><span class=n>utils</span><span class=o>.</span><span class=n>PrettyDuration</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>n_bins</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=bp>self</span><span class=o>.</span><span class=n>ds</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
        <span class=k>return</span> <span class=sa>f</span><span class=s2>&quot;&lt;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>type_name</span><span class=si>}{</span><span class=n>address_str</span><span class=si>}</span><span class=s2>:</span><span class=si>{</span><span class=n>ustr</span><span class=si>}{</span><span class=n>epstr</span><span class=si>}{</span><span class=n>bstr</span><span class=si>}</span><span class=s2>&gt;</span><span class=si>{</span><span class=n>dstr</span><span class=si>}</span><span class=s2>&quot;</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__iter__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;BinnedEventArray iterator initialization.&quot;&quot;&quot;</span>
        <span class=c1># initialize the internal index to zero when used as iterator</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_index</span> <span class=o>=</span> <span class=mi>0</span>
        <span class=k>return</span> <span class=bp>self</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__next__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;BinnedEventArray iterator advancer.&quot;&quot;&quot;</span>
        <span class=n>index</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_index</span>

        <span class=k>if</span> <span class=n>index</span> <span class=o>&gt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=o>.</span><span class=n>n_intervals</span> <span class=o>-</span> <span class=mi>1</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>StopIteration</span>

        <span class=c1># TODO: return self.loc[index], and make sure that __getitem__ is updated</span>
        <span class=n>logging</span><span class=o>.</span><span class=n>disable</span><span class=p>(</span><span class=n>logging</span><span class=o>.</span><span class=n>CRITICAL</span><span class=p>)</span>
        <span class=n>support</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>[</span><span class=n>index</span><span class=p>]</span>
        <span class=n>bsupport</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>binned_support</span><span class=p>[[</span><span class=n>index</span><span class=p>],</span> <span class=p>:]</span>

        <span class=n>binnedeventarray</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=p>)(</span><span class=n>empty</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=n>exclude</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;_bins&quot;</span><span class=p>,</span> <span class=s2>&quot;_data&quot;</span><span class=p>,</span> <span class=s2>&quot;_support&quot;</span><span class=p>,</span> <span class=s2>&quot;_bin_centers&quot;</span><span class=p>,</span> <span class=s2>&quot;_binned_support&quot;</span><span class=p>]</span>
        <span class=n>attrs</span> <span class=o>=</span> <span class=p>(</span><span class=n>x</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>__attributes__</span> <span class=k>if</span> <span class=n>x</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>exclude</span><span class=p>)</span>
        <span class=k>for</span> <span class=n>attr</span> <span class=ow>in</span> <span class=n>attrs</span><span class=p>:</span>
            <span class=n>exec</span><span class=p>(</span><span class=s2>&quot;binnedeventarray.&quot;</span> <span class=o>+</span> <span class=n>attr</span> <span class=o>+</span> <span class=s2>&quot; = self.&quot;</span> <span class=o>+</span> <span class=n>attr</span><span class=p>)</span>
        <span class=n>binindices</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>cumsum</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>lengths</span> <span class=o>+</span> <span class=mi>1</span><span class=p>))</span>  <span class=c1># indices of bins</span>
        <span class=n>binstart</span> <span class=o>=</span> <span class=n>binindices</span><span class=p>[</span><span class=n>index</span><span class=p>]</span>
        <span class=n>binstop</span> <span class=o>=</span> <span class=n>binindices</span><span class=p>[</span><span class=n>index</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span>
        <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>_bins</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_bins</span><span class=p>[</span><span class=n>binstart</span><span class=p>:</span><span class=n>binstop</span><span class=p>]</span>
        <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_data</span><span class=p>[:,</span> <span class=n>bsupport</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=p>:</span> <span class=n>bsupport</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span>
        <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=n>support</span>
        <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>_bin_centers</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_bin_centers</span><span class=p>[</span>
            <span class=n>bsupport</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=p>:</span> <span class=n>bsupport</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span>
        <span class=p>]</span>
        <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>_binned_support</span> <span class=o>=</span> <span class=n>bsupport</span> <span class=o>-</span> <span class=n>bsupport</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span>
        <span class=n>logging</span><span class=o>.</span><span class=n>disable</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_index</span> <span class=o>+=</span> <span class=mi>1</span>
        <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>__renew__</span><span class=p>()</span>
        <span class=k>return</span> <span class=n>binnedeventarray</span>

    <span class=k>def</span><span class=w> </span><span class=nf>empty</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Remove data (but not metadata) from BinnedEventArray.</span>

<span class=sd>        Attributes &#39;data&#39;, and &#39;support&#39; &#39;binned_support&#39; are all emptied.</span>

<span class=sd>        Note: n_series, series_ids, etc. are all preserved.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>inplace</span><span class=p>:</span>
            <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_copy_without_data</span><span class=p>()</span>
            <span class=n>out</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)(</span><span class=n>empty</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
            <span class=k>return</span> <span class=n>out</span>
        <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span>
        <span class=n>out</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=bp>self</span><span class=o>.</span><span class=n>n_series</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span>
        <span class=n>out</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)(</span><span class=n>empty</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=n>out</span><span class=o>.</span><span class=n>_binned_support</span> <span class=o>=</span> <span class=kc>None</span>
        <span class=n>out</span><span class=o>.</span><span class=n>_bin_centers</span> <span class=o>=</span> <span class=kc>None</span>
        <span class=n>out</span><span class=o>.</span><span class=n>_bins</span> <span class=o>=</span> <span class=kc>None</span>
        <span class=n>out</span><span class=o>.</span><span class=n>_eventarray</span><span class=o>.</span><span class=n>empty</span><span class=p>(</span><span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=n>out</span><span class=o>.</span><span class=n>__renew__</span><span class=p>()</span>
        <span class=k>return</span> <span class=n>out</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__getitem__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>idx</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;BinnedEventArray index access.</span>

<span class=sd>        By default, this method is bound to .loc</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_restrict</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>intervalslice</span><span class=p>,</span> <span class=n>seriesslice</span><span class=p>):</span>
        <span class=c1># This function should be called only by an itemgetter</span>
        <span class=c1># because it mutates data.</span>
        <span class=c1># The itemgetter is responsible for creating copies</span>
        <span class=c1># of objects</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_restrict_to_series_subset</span><span class=p>(</span><span class=n>seriesslice</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_eventarray</span><span class=o>.</span><span class=n>_restrict_to_series_subset</span><span class=p>(</span><span class=n>seriesslice</span><span class=p>)</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_restrict_to_interval</span><span class=p>(</span><span class=n>intervalslice</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_eventarray</span><span class=o>.</span><span class=n>_restrict_to_interval</span><span class=p>(</span><span class=n>intervalslice</span><span class=p>)</span>
        <span class=k>return</span> <span class=bp>self</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_restrict_to_series_subset</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>idx</span><span class=p>):</span>
        <span class=c1># Warning: This function can mutate data</span>

        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>idx</span><span class=p>,</span> <span class=n>core</span><span class=o>.</span><span class=n>IntervalArray</span><span class=p>):</span>
            <span class=k>raise</span> <span class=ne>IndexError</span><span class=p>(</span>
                <span class=s2>&quot;Slicing is [intervals, signal]; perhaps you have the order reversed?&quot;</span>
            <span class=p>)</span>

        <span class=c1># TODO: update tags</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>atleast_2d</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=n>idx</span><span class=p>,</span> <span class=p>:])</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_series_ids</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>atleast_1d</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>atleast_1d</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_series_ids</span><span class=p>)[</span><span class=n>idx</span><span class=p>]))</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_series_labels</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span>
                <span class=n>np</span><span class=o>.</span><span class=n>atleast_1d</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>atleast_1d</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_series_labels</span><span class=p>)[</span><span class=n>idx</span><span class=p>])</span>
            <span class=p>)</span>
        <span class=k>except</span> <span class=ne>IndexError</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>IndexError</span><span class=p>(</span>
                <span class=s2>&quot;One of more indices were out of bounds for n_series with size </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                    <span class=bp>self</span><span class=o>.</span><span class=n>n_series</span>
                <span class=p>)</span>
            <span class=p>)</span>
        <span class=k>except</span> <span class=ne>Exception</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s2>&quot;Unsupported indexing type </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=n>idx</span><span class=p>)))</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_restrict_to_interval</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>intervalslice</span><span class=p>):</span>
        <span class=c1># Warning: This function can mutate data. It should only be called from</span>
        <span class=c1># _restrict</span>

        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>intervalslice</span><span class=p>,</span> <span class=nb>slice</span><span class=p>):</span>
            <span class=k>if</span> <span class=p>(</span>
                <span class=n>intervalslice</span><span class=o>.</span><span class=n>start</span> <span class=ow>is</span> <span class=kc>None</span>
                <span class=ow>and</span> <span class=n>intervalslice</span><span class=o>.</span><span class=n>stop</span> <span class=ow>is</span> <span class=kc>None</span>
                <span class=ow>and</span> <span class=n>intervalslice</span><span class=o>.</span><span class=n>step</span> <span class=ow>is</span> <span class=kc>None</span>
            <span class=p>):</span>
                <span class=c1># no restriction on interval</span>
                <span class=k>return</span> <span class=bp>self</span>

        <span class=n>newintervals</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>[</span><span class=n>intervalslice</span><span class=p>]</span><span class=o>.</span><span class=n>merge</span><span class=p>()</span>
        <span class=k>if</span> <span class=n>newintervals</span><span class=o>.</span><span class=n>isempty</span><span class=p>:</span>
            <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;Index resulted in empty interval array&quot;</span><span class=p>)</span>
            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>empty</span><span class=p>(</span><span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

        <span class=n>bcenter_inds</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=n>bin_inds</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=n>start</span> <span class=o>=</span> <span class=mi>0</span>
        <span class=n>bsupport</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>newintervals</span><span class=o>.</span><span class=n>n_intervals</span><span class=p>,</span> <span class=mi>2</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
        <span class=n>support_intervals</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>newintervals</span><span class=o>.</span><span class=n>n_intervals</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>isempty</span><span class=p>:</span>
            <span class=k>for</span> <span class=n>ii</span><span class=p>,</span> <span class=n>interval</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>newintervals</span><span class=o>.</span><span class=n>data</span><span class=p>):</span>
                <span class=n>a_start</span> <span class=o>=</span> <span class=n>interval</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
                <span class=n>a_stop</span> <span class=o>=</span> <span class=n>interval</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
                <span class=n>frm</span><span class=p>,</span> <span class=n>to</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>searchsorted</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_bins</span><span class=p>,</span> <span class=p>(</span><span class=n>a_start</span><span class=p>,</span> <span class=n>a_stop</span><span class=p>))</span>
                <span class=c1># If bin edges equal a_stop, they should still be included</span>
                <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_bins</span><span class=p>[</span><span class=n>to</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=n>a_stop</span><span class=p>:</span>
                    <span class=n>bin_inds</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>frm</span><span class=p>,</span> <span class=n>to</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>step</span><span class=o>=</span><span class=mi>1</span><span class=p>))</span>
                <span class=k>else</span><span class=p>:</span>
                    <span class=n>bin_inds</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>frm</span><span class=p>,</span> <span class=n>to</span><span class=p>,</span> <span class=n>step</span><span class=o>=</span><span class=mi>1</span><span class=p>))</span>
                    <span class=n>to</span> <span class=o>-=</span> <span class=mi>1</span>
                <span class=n>support_intervals</span><span class=p>[</span><span class=n>ii</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>_bins</span><span class=p>[</span><span class=n>frm</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>_bins</span><span class=p>[</span><span class=n>to</span><span class=p>]]</span>

                <span class=n>lind</span><span class=p>,</span> <span class=n>rind</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>searchsorted</span><span class=p>(</span>
                    <span class=bp>self</span><span class=o>.</span><span class=n>_bin_centers</span><span class=p>,</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_bins</span><span class=p>[</span><span class=n>frm</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>_bins</span><span class=p>[</span><span class=n>to</span><span class=p>])</span>
                <span class=p>)</span>
                <span class=c1># We don&#39;t have to worry about an if-else block here unlike</span>
                <span class=c1># for the bin_inds because the bin_centers can NEVER equal</span>
                <span class=c1># the bins. Therefore we know every interval looks like</span>
                <span class=c1># the following:</span>
                <span class=c1>#  first desired bin         last desired bin</span>
                <span class=c1># |------------------|......|-------------------|</span>
                <span class=c1>#          ^                                         ^</span>
                <span class=c1>#          |                                         |</span>
                <span class=c1>#        lind                                      rind</span>
                <span class=c1># Since arange is half-open, the indices we actually take</span>
                <span class=c1># will be such that all bin centers fall within the desired</span>
                <span class=c1># bin edges.</span>
                <span class=n>bcenter_inds</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>lind</span><span class=p>,</span> <span class=n>rind</span><span class=p>,</span> <span class=n>step</span><span class=o>=</span><span class=mi>1</span><span class=p>))</span>

                <span class=n>bsupport</span><span class=p>[</span><span class=n>ii</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=n>start</span><span class=p>,</span> <span class=n>start</span> <span class=o>+</span> <span class=p>(</span><span class=n>to</span> <span class=o>-</span> <span class=n>frm</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)]</span>
                <span class=n>start</span> <span class=o>+=</span> <span class=n>to</span> <span class=o>-</span> <span class=n>frm</span>

            <span class=bp>self</span><span class=o>.</span><span class=n>_bins</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_bins</span><span class=p>[</span><span class=n>bin_inds</span><span class=p>]</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_bin_centers</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_bin_centers</span><span class=p>[</span><span class=n>bcenter_inds</span><span class=p>]</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>atleast_2d</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_data</span><span class=p>[:,</span> <span class=n>bcenter_inds</span><span class=p>])</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_binned_support</span> <span class=o>=</span> <span class=n>bsupport</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)(</span><span class=n>support_intervals</span><span class=p>)</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>isempty</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(bool) Empty BinnedEventArray.&quot;&quot;&quot;</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=k>return</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>bin_centers</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span>
        <span class=k>except</span> <span class=ne>TypeError</span><span class=p>:</span>
            <span class=k>return</span> <span class=kc>True</span>  <span class=c1># this happens when self.bin_centers is None</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>n_series</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(int) The number of series.&quot;&quot;&quot;</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=k>return</span> <span class=n>utils</span><span class=o>.</span><span class=n>PrettyInt</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
        <span class=k>except</span> <span class=ne>AttributeError</span><span class=p>:</span>
            <span class=k>return</span> <span class=mi>0</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>centers</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(np.array) The bin centers (in seconds).&quot;&quot;&quot;</span>
        <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;centers is deprecated. Use bin_centers instead.&quot;</span><span class=p>)</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>bin_centers</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>_abscissa_vals</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(np.array) The bin centers (in seconds).&quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_bin_centers</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>bin_centers</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(np.array) The bin centers (in seconds).&quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_bin_centers</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>event_centers</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(np.array) The centers (in seconds) of each event.&quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_event_centers</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>NotImplementedError</span><span class=p>(</span><span class=s2>&quot;event_centers not yet implemented&quot;</span><span class=p>)</span>
            <span class=c1># self._event_centers = midpoints</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_event_centers</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>_midpoints</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(np.array) The centers (in index space) of all events.</span>

<span class=sd>        Examples</span>
<span class=sd>        -------</span>
<span class=sd>        ax, img = npl.imagesc(bst.data) # data is of shape (n_series, n_bins)</span>
<span class=sd>        # then _midpoints correspond to the xvals at the center of</span>
<span class=sd>        # each event.</span>
<span class=sd>        ax.plot(bst.event_centers, np.repeat(1, self.n_intervals), marker=&#39;o&#39;, color=&#39;w&#39;)</span>

<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_event_centers</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>midpoints</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>lengths</span><span class=p>))</span>
            <span class=k>for</span> <span class=n>idx</span><span class=p>,</span> <span class=n>length</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>lengths</span><span class=p>):</span>
                <span class=n>midpoints</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>lengths</span><span class=p>[:</span><span class=n>idx</span><span class=p>])</span> <span class=o>+</span> <span class=n>length</span> <span class=o>/</span> <span class=mi>2</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_event_centers</span> <span class=o>=</span> <span class=n>midpoints</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_event_centers</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>data</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(np.array) Event counts in all bins, with shape (n_series, n_bins).&quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_data</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>bins</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(np.array) The bin edges (in seconds).&quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_bins</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>binnedSupport</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(np.array) The binned support of the BinnedEventArray (in</span>
<span class=sd>        bin IDs) of shape (n_intervals, 2).</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;binnedSupport is deprecated. Use bined_support instead.&quot;</span><span class=p>)</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_binned_support</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>binned_support</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(np.array) The binned support of the BinnedEventArray (in</span>
<span class=sd>        bin IDs) of shape (n_intervals, 2).</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_binned_support</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>lengths</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Lengths of contiguous segments, in number of bins.&quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>isempty</span><span class=p>:</span>
            <span class=k>return</span> <span class=mi>0</span>
        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>atleast_1d</span><span class=p>(</span>
            <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>binned_support</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>binned_support</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>squeeze</span><span class=p>()</span>
        <span class=p>)</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>eventarray</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(nelpy.EventArray) The original EventArray associated with</span>
<span class=sd>        the binned data.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_eventarray</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>n_bins</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(int) The number of bins.&quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>isempty</span><span class=p>:</span>
            <span class=k>return</span> <span class=mi>0</span>
        <span class=k>return</span> <span class=n>utils</span><span class=o>.</span><span class=n>PrettyInt</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>bin_centers</span><span class=p>))</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>ds</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(float) Bin width in seconds.&quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_ds</span>

    <span class=nd>@ds</span><span class=o>.</span><span class=n>setter</span>
    <span class=k>def</span><span class=w> </span><span class=nf>ds</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>val</span><span class=p>):</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_ds</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>AttributeError</span><span class=p>(</span><span class=s2>&quot;can&#39;t set attribute&quot;</span><span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=k>try</span><span class=p>:</span>
                <span class=k>if</span> <span class=n>val</span> <span class=o>&lt;=</span> <span class=mi>0</span><span class=p>:</span>
                    <span class=k>pass</span>
            <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
                <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s2>&quot;bin width must be a scalar&quot;</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>val</span> <span class=o>&lt;=</span> <span class=mi>0</span><span class=p>:</span>
                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;bin width must be positive&quot;</span><span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_ds</span> <span class=o>=</span> <span class=n>val</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span><span class=w> </span><span class=nf>_get_bins_inside_interval</span><span class=p>(</span><span class=n>interval</span><span class=p>,</span> <span class=n>ds</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(np.array) Return bin edges entirely contained inside an interval.</span>

<span class=sd>        Bin edges always start at interval.start, and continue for as many</span>
<span class=sd>        bins as would fit entirely inside the interval.</span>

<span class=sd>        NOTE 1: there are (n+1) bin edges associated with n bins.</span>

<span class=sd>        WARNING: if an interval is smaller than ds, then no bin will be</span>
<span class=sd>                associated with the particular interval.</span>

<span class=sd>        NOTE 2: nelpy uses half-open intervals [a,b), but if the bin</span>
<span class=sd>                width divides b-a, then the bins will cover the entire</span>
<span class=sd>                range. For example, if interval = [0,2) and ds = 1, then</span>
<span class=sd>                bins = [0,1,2], even though [0,2] is not contained in</span>
<span class=sd>                [0,2).</span>

<span class=sd>        Parameters</span>
<span class=sd>        ----------</span>
<span class=sd>        interval : IntervalArray</span>
<span class=sd>            IntervalArray containing a single interval with a start, and stop</span>
<span class=sd>        ds : float</span>
<span class=sd>            Time bin width, in seconds.</span>

<span class=sd>        Returns</span>
<span class=sd>        -------</span>
<span class=sd>        bins : array</span>
<span class=sd>            Bin edges in an array of shape (n+1,) where n is the number</span>
<span class=sd>            of bins</span>
<span class=sd>        centers : array</span>
<span class=sd>            Bin centers in an array of shape (n,) where n is the number</span>
<span class=sd>            of bins</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=n>interval</span><span class=o>.</span><span class=n>length</span> <span class=o>&lt;</span> <span class=n>ds</span><span class=p>:</span>
            <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;interval duration is less than bin size: ignoring...&quot;</span><span class=p>)</span>
            <span class=k>return</span> <span class=kc>None</span><span class=p>,</span> <span class=kc>None</span>

        <span class=n>n</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>floor</span><span class=p>(</span><span class=n>interval</span><span class=o>.</span><span class=n>length</span> <span class=o>/</span> <span class=n>ds</span><span class=p>))</span>  <span class=c1># number of bins</span>

        <span class=c1># linspace is better than arange for non-integral steps</span>
        <span class=n>bins</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=n>interval</span><span class=o>.</span><span class=n>start</span><span class=p>,</span> <span class=n>interval</span><span class=o>.</span><span class=n>start</span> <span class=o>+</span> <span class=n>n</span> <span class=o>*</span> <span class=n>ds</span><span class=p>,</span> <span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
        <span class=n>centers</span> <span class=o>=</span> <span class=n>bins</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=p>(</span><span class=n>ds</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>bins</span><span class=p>,</span> <span class=n>centers</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_bin_events</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>eventarray</span><span class=p>,</span> <span class=n>intervalArray</span><span class=p>,</span> <span class=n>ds</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Docstring goes here. TBD. For use with bins that are contained</span>
<span class=sd>        wholly inside the intervals.</span>

<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>b</span> <span class=o>=</span> <span class=p>[]</span>  <span class=c1># bin list</span>
        <span class=n>c</span> <span class=o>=</span> <span class=p>[]</span>  <span class=c1># centers list</span>
        <span class=n>s</span> <span class=o>=</span> <span class=p>[]</span>  <span class=c1># data list</span>
        <span class=k>for</span> <span class=n>nn</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>eventarray</span><span class=o>.</span><span class=n>n_series</span><span class=p>):</span>
            <span class=n>s</span><span class=o>.</span><span class=n>append</span><span class=p>([])</span>
        <span class=n>left_edges</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=n>right_edges</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=n>counter</span> <span class=o>=</span> <span class=mi>0</span>
        <span class=k>for</span> <span class=n>interval</span> <span class=ow>in</span> <span class=n>intervalArray</span><span class=p>:</span>
            <span class=n>bins</span><span class=p>,</span> <span class=n>centers</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_bins_inside_interval</span><span class=p>(</span><span class=n>interval</span><span class=p>,</span> <span class=n>ds</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>bins</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                <span class=k>for</span> <span class=n>uu</span><span class=p>,</span> <span class=n>eventarraydatas</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>eventarray</span><span class=o>.</span><span class=n>data</span><span class=p>):</span>
                    <span class=n>event_counts</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>histogram</span><span class=p>(</span>
                        <span class=n>eventarraydatas</span><span class=p>,</span>
                        <span class=n>bins</span><span class=o>=</span><span class=n>bins</span><span class=p>,</span>
                        <span class=n>density</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
                        <span class=nb>range</span><span class=o>=</span><span class=p>(</span><span class=n>interval</span><span class=o>.</span><span class=n>start</span><span class=p>,</span> <span class=n>interval</span><span class=o>.</span><span class=n>stop</span><span class=p>),</span>
                    <span class=p>)</span>  <span class=c1># TODO: is it faster to limit range, or to cut out events?</span>
                    <span class=n>s</span><span class=p>[</span><span class=n>uu</span><span class=p>]</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>event_counts</span><span class=o>.</span><span class=n>tolist</span><span class=p>())</span>
                <span class=n>left_edges</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>counter</span><span class=p>)</span>
                <span class=n>counter</span> <span class=o>+=</span> <span class=nb>len</span><span class=p>(</span><span class=n>centers</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span>
                <span class=n>right_edges</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>counter</span><span class=p>)</span>
                <span class=n>counter</span> <span class=o>+=</span> <span class=mi>1</span>
                <span class=n>b</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>bins</span><span class=o>.</span><span class=n>tolist</span><span class=p>())</span>
                <span class=n>c</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>centers</span><span class=o>.</span><span class=n>tolist</span><span class=p>())</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_bins</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_bin_centers</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>c</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>
        <span class=n>le</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>left_edges</span><span class=p>)</span>
        <span class=n>le</span> <span class=o>=</span> <span class=n>le</span><span class=p>[:,</span> <span class=n>np</span><span class=o>.</span><span class=n>newaxis</span><span class=p>]</span>
        <span class=n>re</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>right_edges</span><span class=p>)</span>
        <span class=n>re</span> <span class=o>=</span> <span class=n>re</span><span class=p>[:,</span> <span class=n>np</span><span class=o>.</span><span class=n>newaxis</span><span class=p>]</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_binned_support</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>le</span><span class=p>,</span> <span class=n>re</span><span class=p>))</span>
        <span class=n>support_starts</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>bins</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>cumsum</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>lengths</span> <span class=o>+</span> <span class=mi>1</span><span class=p>),</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]]</span>
        <span class=n>support_stops</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>bins</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>cumsum</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>lengths</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)[</span><span class=mi>1</span><span class=p>:]]</span>
        <span class=n>supportdata</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>vstack</span><span class=p>([</span><span class=n>support_starts</span><span class=p>,</span> <span class=n>support_stops</span><span class=p>])</span><span class=o>.</span><span class=n>T</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)(</span>
            <span class=n>supportdata</span>
        <span class=p>)</span>  <span class=c1># set support to TRUE bin support</span>

    <span class=nd>@keyword_deprecation</span><span class=p>(</span><span class=n>replace_x_with_y</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;bw&quot;</span><span class=p>:</span> <span class=s2>&quot;truncate&quot;</span><span class=p>})</span>
    <span class=k>def</span><span class=w> </span><span class=nf>smooth</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>sigma</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>truncate</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>within_intervals</span><span class=o>=</span><span class=kc>False</span>
    <span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Smooth BinnedEventArray by convolving with a Gaussian kernel.</span>

<span class=sd>        Smoothing is applied in data, and the same smoothing is applied</span>
<span class=sd>        to each series in a BinnedEventArray.</span>

<span class=sd>        Smoothing is applied within each interval.</span>

<span class=sd>        Parameters</span>
<span class=sd>        ----------</span>
<span class=sd>        sigma : float, optional</span>
<span class=sd>            Standard deviation of Gaussian kernel, in seconds. Default is 0.01 (10 ms)</span>
<span class=sd>        truncate : float, optional</span>
<span class=sd>            Bandwidth outside of which the filter value will be zero. Default is 4.0</span>
<span class=sd>        inplace : bool</span>
<span class=sd>            If True the data will be replaced with the smoothed data.</span>
<span class=sd>            Default is False.</span>

<span class=sd>        Returns</span>
<span class=sd>        -------</span>
<span class=sd>        out : BinnedEventArray</span>
<span class=sd>            New BinnedEventArray with smoothed data.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=n>truncate</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>truncate</span> <span class=o>=</span> <span class=mi>4</span>
        <span class=k>if</span> <span class=n>sigma</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>sigma</span> <span class=o>=</span> <span class=mf>0.01</span>  <span class=c1># 10 ms default</span>

        <span class=n>fs</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>/</span> <span class=bp>self</span><span class=o>.</span><span class=n>ds</span>

        <span class=k>return</span> <span class=n>utils</span><span class=o>.</span><span class=n>gaussian_filter</span><span class=p>(</span>
            <span class=bp>self</span><span class=p>,</span>
            <span class=n>fs</span><span class=o>=</span><span class=n>fs</span><span class=p>,</span>
            <span class=n>sigma</span><span class=o>=</span><span class=n>sigma</span><span class=p>,</span>
            <span class=n>truncate</span><span class=o>=</span><span class=n>truncate</span><span class=p>,</span>
            <span class=n>inplace</span><span class=o>=</span><span class=n>inplace</span><span class=p>,</span>
            <span class=n>within_intervals</span><span class=o>=</span><span class=n>within_intervals</span><span class=p>,</span>
        <span class=p>)</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span><span class=w> </span><span class=nf>_smooth_array</span><span class=p>(</span><span class=n>arr</span><span class=p>,</span> <span class=n>w</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Smooth an array by convolving a boxcar, row-wise.</span>

<span class=sd>        Parameters</span>
<span class=sd>        ----------</span>
<span class=sd>        w : int, optional</span>
<span class=sd>            Number of bins to include in boxcar window. Default is 10.</span>

<span class=sd>        Returns</span>
<span class=sd>        -------</span>
<span class=sd>        smoothed: array</span>
<span class=sd>            Smoothed array with same shape as arr.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=n>w</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>w</span> <span class=o>=</span> <span class=mi>10</span>

        <span class=k>if</span> <span class=n>w</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>  <span class=c1># perform no smoothing</span>
            <span class=k>return</span> <span class=n>arr</span>

        <span class=n>w</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>min</span><span class=p>((</span><span class=n>w</span><span class=p>,</span> <span class=n>arr</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]))</span>

        <span class=n>smoothed</span> <span class=o>=</span> <span class=n>arr</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>float</span><span class=p>)</span>  <span class=c1># copy array and cast to float</span>
        <span class=n>window</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>((</span><span class=n>w</span><span class=p>,))</span> <span class=o>/</span> <span class=n>w</span>

        <span class=c1># smooth per row</span>
        <span class=k>for</span> <span class=n>rowi</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>smoothed</span><span class=p>):</span>
            <span class=n>smoothed</span><span class=p>[</span><span class=n>rowi</span><span class=p>,</span> <span class=p>:]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>convolve</span><span class=p>(</span><span class=n>row</span><span class=p>,</span> <span class=n>window</span><span class=p>,</span> <span class=n>mode</span><span class=o>=</span><span class=s2>&quot;same&quot;</span><span class=p>)</span>

        <span class=k>if</span> <span class=n>arr</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>!=</span> <span class=n>smoothed</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]:</span>
            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s2>&quot;Incompatible shape returned!&quot;</span><span class=p>)</span>

        <span class=k>return</span> <span class=n>smoothed</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span><span class=w> </span><span class=nf>_rebin_array</span><span class=p>(</span><span class=n>arr</span><span class=p>,</span> <span class=n>w</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Rebin an array of shape (n_signals, n_bins) into a</span>
<span class=sd>        coarser bin size.</span>

<span class=sd>        Parameters</span>
<span class=sd>        ----------</span>
<span class=sd>        arr : array</span>
<span class=sd>            Array with shape (n_signals, n_bins) to re-bin. A copy</span>
<span class=sd>            is returned.</span>
<span class=sd>        w : int</span>
<span class=sd>            Number of original bins to combine into each new bin.</span>

<span class=sd>        Returns</span>
<span class=sd>        -------</span>
<span class=sd>        out : array</span>
<span class=sd>            Bnned array with shape (n_signals, n_new_bins)</span>
<span class=sd>        bin_idx : array</span>
<span class=sd>            Array of shape (n_new_bins,) with the indices of the new</span>
<span class=sd>            binned array, relative to the original array.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>cs</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>cumsum</span><span class=p>(</span><span class=n>arr</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
        <span class=n>binidx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>start</span><span class=o>=</span><span class=n>w</span><span class=p>,</span> <span class=n>stop</span><span class=o>=</span><span class=n>cs</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>step</span><span class=o>=</span><span class=n>w</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span>

        <span class=n>rebinned</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>(</span>
            <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>cs</span><span class=p>[:,</span> <span class=n>w</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=n>ndmin</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>T</span><span class=p>,</span> <span class=n>cs</span><span class=p>[:,</span> <span class=n>binidx</span><span class=p>[</span><span class=mi>1</span><span class=p>:]]</span> <span class=o>-</span> <span class=n>cs</span><span class=p>[:,</span> <span class=n>binidx</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]])</span>
        <span class=p>)</span>
        <span class=c1># bins = bins[np.insert(binidx+1, 0, 0)]</span>
        <span class=k>return</span> <span class=n>rebinned</span><span class=p>,</span> <span class=n>binidx</span>

    <span class=k>def</span><span class=w> </span><span class=nf>rebin</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>w</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Rebin the BinnedEventArray into a coarser bin size.</span>

<span class=sd>        Parameters</span>
<span class=sd>        ----------</span>
<span class=sd>        w : int, optional</span>
<span class=sd>            number of bins of width bst.ds to bin into new bin of</span>
<span class=sd>            width bst.ds*w. Default is w=1 (no re-binning).</span>

<span class=sd>        Returns</span>
<span class=sd>        -------</span>
<span class=sd>        out : BinnedEventArray</span>
<span class=sd>            New BinnedEventArray with coarser resolution.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=n>w</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>w</span> <span class=o>=</span> <span class=mi>1</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=nb>float</span><span class=p>(</span><span class=n>w</span><span class=p>)</span><span class=o>.</span><span class=n>is_integer</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;w has to be an integer!&quot;</span><span class=p>)</span>

        <span class=n>w</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>w</span><span class=p>)</span>

        <span class=n>bst</span> <span class=o>=</span> <span class=bp>self</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_rebin_binnedeventarray</span><span class=p>(</span><span class=n>bst</span><span class=p>,</span> <span class=n>w</span><span class=o>=</span><span class=n>w</span><span class=p>)</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span><span class=w> </span><span class=nf>_rebin_binnedeventarray</span><span class=p>(</span><span class=n>bst</span><span class=p>,</span> <span class=n>w</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Rebin a BinnedEventArray into a coarser bin size.</span>

<span class=sd>        Parameters</span>
<span class=sd>        ----------</span>
<span class=sd>        bst : BinnedEventArray</span>
<span class=sd>            BinnedEventArray to re-bin into a coarser resolution.</span>
<span class=sd>        w : int, optional</span>
<span class=sd>            number of bins of width bst.ds to bin into new bin of</span>
<span class=sd>            width bst.ds*w. Default is w=1 (no re-binning).</span>

<span class=sd>        Returns</span>
<span class=sd>        -------</span>
<span class=sd>        out : BinnedEventArray</span>
<span class=sd>            New BinnedEventArray with coarser resolution.</span>

<span class=sd>        # FFB! TODO: if w is longer than some event size,</span>
<span class=sd>        # an exception will occur. Handle it! Although I may already</span>
<span class=sd>        # implicitly do that.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=n>w</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>w</span> <span class=o>=</span> <span class=mi>1</span>

        <span class=k>if</span> <span class=n>w</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
            <span class=k>return</span> <span class=n>bst</span>

        <span class=n>edges</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>cumsum</span><span class=p>(</span><span class=n>bst</span><span class=o>.</span><span class=n>lengths</span><span class=p>),</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
        <span class=n>newlengths</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span>
        <span class=n>binedges</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>cumsum</span><span class=p>(</span><span class=n>bst</span><span class=o>.</span><span class=n>lengths</span> <span class=o>+</span> <span class=mi>1</span><span class=p>),</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
        <span class=n>n_events</span> <span class=o>=</span> <span class=n>bst</span><span class=o>.</span><span class=n>support</span><span class=o>.</span><span class=n>n_intervals</span>
        <span class=n>newdata</span> <span class=o>=</span> <span class=kc>None</span>

        <span class=k>for</span> <span class=n>ii</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n_events</span><span class=p>):</span>
            <span class=n>data</span> <span class=o>=</span> <span class=n>bst</span><span class=o>.</span><span class=n>data</span><span class=p>[:,</span> <span class=n>edges</span><span class=p>[</span><span class=n>ii</span><span class=p>]</span> <span class=p>:</span> <span class=n>edges</span><span class=p>[</span><span class=n>ii</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]</span>
            <span class=n>bins</span> <span class=o>=</span> <span class=n>bst</span><span class=o>.</span><span class=n>bins</span><span class=p>[</span><span class=n>binedges</span><span class=p>[</span><span class=n>ii</span><span class=p>]</span> <span class=p>:</span> <span class=n>binedges</span><span class=p>[</span><span class=n>ii</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]</span>

            <span class=n>datalen</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
            <span class=k>if</span> <span class=n>w</span> <span class=o>&lt;=</span> <span class=n>datalen</span><span class=p>:</span>
                <span class=n>rebinned</span><span class=p>,</span> <span class=n>binidx</span> <span class=o>=</span> <span class=n>bst</span><span class=o>.</span><span class=n>_rebin_array</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>w</span><span class=o>=</span><span class=n>w</span><span class=p>)</span>
                <span class=n>bins</span> <span class=o>=</span> <span class=n>bins</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>binidx</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)]</span>

                <span class=n>newlengths</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>rebinned</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>

                <span class=k>if</span> <span class=n>newdata</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
                    <span class=n>newdata</span> <span class=o>=</span> <span class=n>rebinned</span>
                    <span class=n>newbins</span> <span class=o>=</span> <span class=n>bins</span>
                    <span class=n>newcenters</span> <span class=o>=</span> <span class=n>bins</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>diff</span><span class=p>(</span><span class=n>bins</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span>
                    <span class=n>newsupport</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>bins</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>bins</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]])</span>
                <span class=k>else</span><span class=p>:</span>
                    <span class=n>newdata</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>newdata</span><span class=p>,</span> <span class=n>rebinned</span><span class=p>))</span>
                    <span class=n>newbins</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>newbins</span><span class=p>,</span> <span class=n>bins</span><span class=p>))</span>
                    <span class=n>newcenters</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>newcenters</span><span class=p>,</span> <span class=n>bins</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>diff</span><span class=p>(</span><span class=n>bins</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span><span class=p>))</span>
                    <span class=n>newsupport</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>vstack</span><span class=p>((</span><span class=n>newsupport</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>bins</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>bins</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]])))</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=k>pass</span>

        <span class=c1># assemble new binned event series array:</span>
        <span class=n>newedges</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>cumsum</span><span class=p>(</span><span class=n>newlengths</span><span class=p>)</span>
        <span class=n>newbst</span> <span class=o>=</span> <span class=n>bst</span><span class=o>.</span><span class=n>_copy_without_data</span><span class=p>()</span>
        <span class=n>abscissa</span> <span class=o>=</span> <span class=n>copy</span><span class=o>.</span><span class=n>copy</span><span class=p>(</span><span class=n>bst</span><span class=o>.</span><span class=n>_abscissa</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>newdata</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>newbst</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>newdata</span>
            <span class=n>newbst</span><span class=o>.</span><span class=n>_abscissa</span> <span class=o>=</span> <span class=n>abscissa</span>
            <span class=n>newbst</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=n>bst</span><span class=o>.</span><span class=n>support</span><span class=p>)(</span><span class=n>newsupport</span><span class=p>)</span>
            <span class=n>newbst</span><span class=o>.</span><span class=n>_bins</span> <span class=o>=</span> <span class=n>newbins</span>
            <span class=n>newbst</span><span class=o>.</span><span class=n>_bin_centers</span> <span class=o>=</span> <span class=n>newcenters</span>
            <span class=n>newbst</span><span class=o>.</span><span class=n>_ds</span> <span class=o>=</span> <span class=n>bst</span><span class=o>.</span><span class=n>ds</span> <span class=o>*</span> <span class=n>w</span>
            <span class=n>newbst</span><span class=o>.</span><span class=n>_binned_support</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>((</span><span class=n>newedges</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span> <span class=n>newedges</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span> <span class=o>-</span> <span class=mi>1</span><span class=p>))</span><span class=o>.</span><span class=n>T</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
                <span class=s2>&quot;No events are long enough to contain any bins of width </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                    <span class=n>utils</span><span class=o>.</span><span class=n>PrettyDuration</span><span class=p>(</span><span class=n>bst</span><span class=o>.</span><span class=n>ds</span><span class=p>)</span>
                <span class=p>)</span>
            <span class=p>)</span>
            <span class=n>newbst</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=kc>None</span>
            <span class=n>newbst</span><span class=o>.</span><span class=n>_abscissa</span> <span class=o>=</span> <span class=n>abscissa</span>
            <span class=n>newbst</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=kc>None</span>
            <span class=n>newbst</span><span class=o>.</span><span class=n>_binned_support</span> <span class=o>=</span> <span class=kc>None</span>
            <span class=n>newbst</span><span class=o>.</span><span class=n>_bin_centers</span> <span class=o>=</span> <span class=kc>None</span>
            <span class=n>newbst</span><span class=o>.</span><span class=n>_bins</span> <span class=o>=</span> <span class=kc>None</span>

        <span class=n>newbst</span><span class=o>.</span><span class=n>__renew__</span><span class=p>()</span>

        <span class=k>return</span> <span class=n>newbst</span>

    <span class=k>def</span><span class=w> </span><span class=nf>bst_from_indices</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>idx</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Return a BinnedEventArray from a list of indices.</span>

<span class=sd>        bst : BinnedEventArray</span>
<span class=sd>        idx : list of sample (bin) numbers with shape (n_intervals, 2) INCLUSIVE</span>

<span class=sd>        Examples</span>
<span class=sd>        --------</span>
<span class=sd>        idx = [[10, 20]</span>
<span class=sd>            [25, 50]]</span>
<span class=sd>        bst_from_indices(bst, idx=idx)</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=n>idx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>atleast_2d</span><span class=p>(</span><span class=n>idx</span><span class=p>)</span>

        <span class=n>newbst</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_copy_without_data</span><span class=p>()</span>
        <span class=n>ds</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>ds</span>
        <span class=n>bin_centers_</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=n>bins_</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=n>binned_support_</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=n>support_</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=n>all_abscissa_vals</span> <span class=o>=</span> <span class=p>[]</span>

        <span class=n>n_preceding_bins</span> <span class=o>=</span> <span class=mi>0</span>

        <span class=k>for</span> <span class=n>frm</span><span class=p>,</span> <span class=n>to</span> <span class=ow>in</span> <span class=n>idx</span><span class=p>:</span>
            <span class=n>idx_array</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>frm</span><span class=p>,</span> <span class=n>to</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>
            <span class=n>all_abscissa_vals</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>idx_array</span><span class=p>)</span>
            <span class=n>bin_centers</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>bin_centers</span><span class=p>[</span><span class=n>idx_array</span><span class=p>]</span>
            <span class=n>bins</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>bin_centers</span> <span class=o>-</span> <span class=n>ds</span> <span class=o>/</span> <span class=mi>2</span><span class=p>,</span> <span class=n>bin_centers</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>ds</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span>

            <span class=n>binned_support</span> <span class=o>=</span> <span class=p>[</span><span class=n>n_preceding_bins</span><span class=p>,</span> <span class=n>n_preceding_bins</span> <span class=o>+</span> <span class=nb>len</span><span class=p>(</span><span class=n>bins</span><span class=p>)</span> <span class=o>-</span> <span class=mi>2</span><span class=p>]</span>
            <span class=n>n_preceding_bins</span> <span class=o>+=</span> <span class=nb>len</span><span class=p>(</span><span class=n>bins</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span>
            <span class=n>support</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)((</span><span class=n>bins</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>bins</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]))</span>

            <span class=n>bin_centers_</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>bin_centers</span><span class=p>)</span>
            <span class=n>bins_</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>bins</span><span class=p>)</span>
            <span class=n>binned_support_</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>binned_support</span><span class=p>)</span>
            <span class=n>support_</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>support</span><span class=p>)</span>

        <span class=n>bin_centers</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>(</span><span class=n>bin_centers_</span><span class=p>)</span>
        <span class=n>bins</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>(</span><span class=n>bins_</span><span class=p>)</span>
        <span class=n>binned_support</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>binned_support_</span><span class=p>)</span>
        <span class=n>support</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>support_</span><span class=p>)</span>
        <span class=n>all_abscissa_vals</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>(</span><span class=n>all_abscissa_vals</span><span class=p>)</span>

        <span class=n>newbst</span><span class=o>.</span><span class=n>_bin_centers</span> <span class=o>=</span> <span class=n>bin_centers</span>
        <span class=n>newbst</span><span class=o>.</span><span class=n>_bins</span> <span class=o>=</span> <span class=n>bins</span>
        <span class=n>newbst</span><span class=o>.</span><span class=n>_binned_support</span> <span class=o>=</span> <span class=n>binned_support</span>
        <span class=n>newbst</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=n>support</span>
        <span class=n>newbst</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>newbst</span><span class=o>.</span><span class=n>data</span><span class=p>[:,</span> <span class=n>all_abscissa_vals</span><span class=p>]</span>

        <span class=n>newbst</span><span class=o>.</span><span class=n>__renew__</span><span class=p>()</span>

        <span class=k>return</span> <span class=n>newbst</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>n_active</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Number of active series.</span>

<span class=sd>        An active series is any series that fired at least one event.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>isempty</span><span class=p>:</span>
            <span class=k>return</span> <span class=mi>0</span>
        <span class=k>return</span> <span class=n>utils</span><span class=o>.</span><span class=n>PrettyInt</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>count_nonzero</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>n_events</span><span class=p>))</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>n_active_per_bin</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Number of active series per data bin with shape (n_bins,).&quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>isempty</span><span class=p>:</span>
            <span class=k>return</span> <span class=mi>0</span>
        <span class=c1># TODO: profile several alternatves. Could use data &gt; 0, or</span>
        <span class=c1># other numpy methods to get a more efficient implementation:</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=nb>max</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>n_events</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(np.array) The number of events in each series.&quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>isempty</span><span class=p>:</span>
            <span class=k>return</span> <span class=mi>0</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>flatten</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>series_id</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>series_label</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Collapse events across series.</span>

<span class=sd>        WARNING! series_tags are thrown away when flattening.</span>

<span class=sd>        Parameters</span>
<span class=sd>        ----------</span>
<span class=sd>        series_id: (int)</span>
<span class=sd>            (series) ID to assign to flattened event series, default is 0.</span>
<span class=sd>        series_label (str)</span>
<span class=sd>            (series) Label for event series, default is &#39;flattened&#39;.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>n_series</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=p>:</span>  <span class=c1># already flattened</span>
            <span class=k>return</span> <span class=bp>self</span>

        <span class=c1># default args:</span>
        <span class=k>if</span> <span class=n>series_id</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>series_id</span> <span class=o>=</span> <span class=mi>0</span>
        <span class=k>if</span> <span class=n>series_label</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>series_label</span> <span class=o>=</span> <span class=s2>&quot;flattened&quot;</span>

        <span class=n>binnedeventarray</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_copy_without_data</span><span class=p>()</span>

        <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>),</span> <span class=n>ndmin</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>

        <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>_bins</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>bins</span>
        <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>support</span>
        <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>_bin_centers</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>bin_centers</span>
        <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>_binned_support</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>binned_support</span>

        <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>_series_ids</span> <span class=o>=</span> <span class=p>[</span><span class=n>series_id</span><span class=p>]</span>
        <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>_series_labels</span> <span class=o>=</span> <span class=p>[</span><span class=n>series_label</span><span class=p>]</span>
        <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>_series_tags</span> <span class=o>=</span> <span class=kc>None</span>
        <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>__renew__</span><span class=p>()</span>

        <span class=k>return</span> <span class=n>binnedeventarray</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>support</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(nelpy.IntervalArray) The support of the underlying BinnedEventArray.&quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span>

    <span class=nd>@support</span><span class=o>.</span><span class=n>setter</span>
    <span class=k>def</span><span class=w> </span><span class=nf>support</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>val</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(nelpy.IntervalArray) The support of the underlying BinnedEventArray.&quot;&quot;&quot;</span>
        <span class=c1># modify support</span>
        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)):</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=n>val</span>
        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=p>(</span><span class=nb>tuple</span><span class=p>,</span> <span class=nb>list</span><span class=p>)):</span>
            <span class=n>prev_domain</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>domain</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)([</span><span class=n>val</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>val</span><span class=p>[</span><span class=mi>1</span><span class=p>]])</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>domain</span> <span class=o>=</span> <span class=n>prev_domain</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
                <span class=s2>&quot;support must be of type </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)))</span>
            <span class=p>)</span>
        <span class=c1># restrict data to new support</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_restrict_to_interval</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BinnedEventArray.bin_centers class="doc doc-heading"> <code class="highlight language-python"><span class=n>bin_centers</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>(np.array) The bin centers (in seconds).</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BinnedEventArray.binnedSupport class="doc doc-heading"> <code class="highlight language-python"><span class=n>binnedSupport</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>(np.array) The binned support of the BinnedEventArray (in bin IDs) of shape (n_intervals, 2).</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BinnedEventArray.binned_support class="doc doc-heading"> <code class="highlight language-python"><span class=n>binned_support</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>(np.array) The binned support of the BinnedEventArray (in bin IDs) of shape (n_intervals, 2).</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BinnedEventArray.bins class="doc doc-heading"> <code class="highlight language-python"><span class=n>bins</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>(np.array) The bin edges (in seconds).</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BinnedEventArray.centers class="doc doc-heading"> <code class="highlight language-python"><span class=n>centers</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>(np.array) The bin centers (in seconds).</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BinnedEventArray.data class="doc doc-heading"> <code class="highlight language-python"><span class=n>data</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>(np.array) Event counts in all bins, with shape (n_series, n_bins).</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BinnedEventArray.ds class="doc doc-heading"> <code class="highlight language-python"><span class=n>ds</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> <small class="doc doc-label doc-label-writable"><code>writable</code></small> </span> </h3> <div class="doc doc-contents "> <p>(float) Bin width in seconds.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BinnedEventArray.event_centers class="doc doc-heading"> <code class="highlight language-python"><span class=n>event_centers</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>(np.array) The centers (in seconds) of each event.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BinnedEventArray.eventarray class="doc doc-heading"> <code class="highlight language-python"><span class=n>eventarray</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>(nelpy.EventArray) The original EventArray associated with the binned data.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BinnedEventArray.isempty class="doc doc-heading"> <code class="highlight language-python"><span class=n>isempty</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>(bool) Empty BinnedEventArray.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BinnedEventArray.lengths class="doc doc-heading"> <code class="highlight language-python"><span class=n>lengths</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>Lengths of contiguous segments, in number of bins.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BinnedEventArray.n_active class="doc doc-heading"> <code class="highlight language-python"><span class=n>n_active</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>Number of active series.</p> <p>An active series is any series that fired at least one event.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BinnedEventArray.n_active_per_bin class="doc doc-heading"> <code class="highlight language-python"><span class=n>n_active_per_bin</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>Number of active series per data bin with shape (n_bins,).</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BinnedEventArray.n_bins class="doc doc-heading"> <code class="highlight language-python"><span class=n>n_bins</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>(int) The number of bins.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BinnedEventArray.n_events class="doc doc-heading"> <code class="highlight language-python"><span class=n>n_events</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>(np.array) The number of events in each series.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BinnedEventArray.n_series class="doc doc-heading"> <code class="highlight language-python"><span class=n>n_series</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>(int) The number of series.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.BinnedEventArray.support class="doc doc-heading"> <code class="highlight language-python"><span class=n>support</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> <small class="doc doc-label doc-label-writable"><code>writable</code></small> </span> </h3> <div class="doc doc-contents "> <p>(nelpy.IntervalArray) The support of the underlying BinnedEventArray.</p> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.BinnedEventArray.bst_from_indices class="doc doc-heading"> <code class="highlight language-python"><span class=n>bst_from_indices</span><span class=p>(</span><span class=n>idx</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Return a BinnedEventArray from a list of indices.</p> <p>bst : BinnedEventArray idx : list of sample (bin) numbers with shape (n_intervals, 2) INCLUSIVE</p> <p><span class=doc-section-title>Examples:</span></p> <p>idx = [[10, 20] [25, 50]] bst_from_indices(bst, idx=idx)</p> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2054</span>
<span class=normal>2055</span>
<span class=normal>2056</span>
<span class=normal>2057</span>
<span class=normal>2058</span>
<span class=normal>2059</span>
<span class=normal>2060</span>
<span class=normal>2061</span>
<span class=normal>2062</span>
<span class=normal>2063</span>
<span class=normal>2064</span>
<span class=normal>2065</span>
<span class=normal>2066</span>
<span class=normal>2067</span>
<span class=normal>2068</span>
<span class=normal>2069</span>
<span class=normal>2070</span>
<span class=normal>2071</span>
<span class=normal>2072</span>
<span class=normal>2073</span>
<span class=normal>2074</span>
<span class=normal>2075</span>
<span class=normal>2076</span>
<span class=normal>2077</span>
<span class=normal>2078</span>
<span class=normal>2079</span>
<span class=normal>2080</span>
<span class=normal>2081</span>
<span class=normal>2082</span>
<span class=normal>2083</span>
<span class=normal>2084</span>
<span class=normal>2085</span>
<span class=normal>2086</span>
<span class=normal>2087</span>
<span class=normal>2088</span>
<span class=normal>2089</span>
<span class=normal>2090</span>
<span class=normal>2091</span>
<span class=normal>2092</span>
<span class=normal>2093</span>
<span class=normal>2094</span>
<span class=normal>2095</span>
<span class=normal>2096</span>
<span class=normal>2097</span>
<span class=normal>2098</span>
<span class=normal>2099</span>
<span class=normal>2100</span>
<span class=normal>2101</span>
<span class=normal>2102</span>
<span class=normal>2103</span>
<span class=normal>2104</span>
<span class=normal>2105</span>
<span class=normal>2106</span>
<span class=normal>2107</span>
<span class=normal>2108</span>
<span class=normal>2109</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>bst_from_indices</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>idx</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Return a BinnedEventArray from a list of indices.</span>

<span class=sd>    bst : BinnedEventArray</span>
<span class=sd>    idx : list of sample (bin) numbers with shape (n_intervals, 2) INCLUSIVE</span>

<span class=sd>    Examples</span>
<span class=sd>    --------</span>
<span class=sd>    idx = [[10, 20]</span>
<span class=sd>        [25, 50]]</span>
<span class=sd>    bst_from_indices(bst, idx=idx)</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>idx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>atleast_2d</span><span class=p>(</span><span class=n>idx</span><span class=p>)</span>

    <span class=n>newbst</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_copy_without_data</span><span class=p>()</span>
    <span class=n>ds</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>ds</span>
    <span class=n>bin_centers_</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=n>bins_</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=n>binned_support_</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=n>support_</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=n>all_abscissa_vals</span> <span class=o>=</span> <span class=p>[]</span>

    <span class=n>n_preceding_bins</span> <span class=o>=</span> <span class=mi>0</span>

    <span class=k>for</span> <span class=n>frm</span><span class=p>,</span> <span class=n>to</span> <span class=ow>in</span> <span class=n>idx</span><span class=p>:</span>
        <span class=n>idx_array</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>frm</span><span class=p>,</span> <span class=n>to</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>
        <span class=n>all_abscissa_vals</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>idx_array</span><span class=p>)</span>
        <span class=n>bin_centers</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>bin_centers</span><span class=p>[</span><span class=n>idx_array</span><span class=p>]</span>
        <span class=n>bins</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>bin_centers</span> <span class=o>-</span> <span class=n>ds</span> <span class=o>/</span> <span class=mi>2</span><span class=p>,</span> <span class=n>bin_centers</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>ds</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span>

        <span class=n>binned_support</span> <span class=o>=</span> <span class=p>[</span><span class=n>n_preceding_bins</span><span class=p>,</span> <span class=n>n_preceding_bins</span> <span class=o>+</span> <span class=nb>len</span><span class=p>(</span><span class=n>bins</span><span class=p>)</span> <span class=o>-</span> <span class=mi>2</span><span class=p>]</span>
        <span class=n>n_preceding_bins</span> <span class=o>+=</span> <span class=nb>len</span><span class=p>(</span><span class=n>bins</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span>
        <span class=n>support</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)((</span><span class=n>bins</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>bins</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]))</span>

        <span class=n>bin_centers_</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>bin_centers</span><span class=p>)</span>
        <span class=n>bins_</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>bins</span><span class=p>)</span>
        <span class=n>binned_support_</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>binned_support</span><span class=p>)</span>
        <span class=n>support_</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>support</span><span class=p>)</span>

    <span class=n>bin_centers</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>(</span><span class=n>bin_centers_</span><span class=p>)</span>
    <span class=n>bins</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>(</span><span class=n>bins_</span><span class=p>)</span>
    <span class=n>binned_support</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>binned_support_</span><span class=p>)</span>
    <span class=n>support</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>support_</span><span class=p>)</span>
    <span class=n>all_abscissa_vals</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>(</span><span class=n>all_abscissa_vals</span><span class=p>)</span>

    <span class=n>newbst</span><span class=o>.</span><span class=n>_bin_centers</span> <span class=o>=</span> <span class=n>bin_centers</span>
    <span class=n>newbst</span><span class=o>.</span><span class=n>_bins</span> <span class=o>=</span> <span class=n>bins</span>
    <span class=n>newbst</span><span class=o>.</span><span class=n>_binned_support</span> <span class=o>=</span> <span class=n>binned_support</span>
    <span class=n>newbst</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=n>support</span>
    <span class=n>newbst</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>newbst</span><span class=o>.</span><span class=n>data</span><span class=p>[:,</span> <span class=n>all_abscissa_vals</span><span class=p>]</span>

    <span class=n>newbst</span><span class=o>.</span><span class=n>__renew__</span><span class=p>()</span>

    <span class=k>return</span> <span class=n>newbst</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.BinnedEventArray.center class="doc doc-heading"> <code class="highlight language-python"><span class=n>center</span><span class=p>(</span><span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Center data (zero mean).</p> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1333</span>
<span class=normal>1334</span>
<span class=normal>1335</span>
<span class=normal>1336</span>
<span class=normal>1337</span>
<span class=normal>1338</span>
<span class=normal>1339</span>
<span class=normal>1340</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>center</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Center data (zero mean).&quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>inplace</span><span class=p>:</span>
        <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
    <span class=n>out</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=p>(</span><span class=n>out</span><span class=o>.</span><span class=n>_data</span><span class=o>.</span><span class=n>T</span> <span class=o>-</span> <span class=n>out</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span><span class=o>.</span><span class=n>T</span>
    <span class=k>return</span> <span class=n>out</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.BinnedEventArray.copy class="doc doc-heading"> <code class="highlight language-python"><span class=n>copy</span><span class=p>()</span></code> </h3> <div class="doc doc-contents "> <p>Returns a copy of the BinnedEventArray.</p> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1417</span>
<span class=normal>1418</span>
<span class=normal>1419</span>
<span class=normal>1420</span>
<span class=normal>1421</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>copy</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Returns a copy of the BinnedEventArray.&quot;&quot;&quot;</span>
    <span class=n>newcopy</span> <span class=o>=</span> <span class=n>copy</span><span class=o>.</span><span class=n>deepcopy</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>
    <span class=n>newcopy</span><span class=o>.</span><span class=n>__renew__</span><span class=p>()</span>
    <span class=k>return</span> <span class=n>newcopy</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.BinnedEventArray.empty class="doc doc-heading"> <code class="highlight language-python"><span class=n>empty</span><span class=p>(</span><span class=o>*</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Remove data (but not metadata) from BinnedEventArray.</p> <p>Attributes 'data', and 'support' 'binned_support' are all emptied.</p> <p>Note: n_series, series_ids, etc. are all preserved.</p> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1486</span>
<span class=normal>1487</span>
<span class=normal>1488</span>
<span class=normal>1489</span>
<span class=normal>1490</span>
<span class=normal>1491</span>
<span class=normal>1492</span>
<span class=normal>1493</span>
<span class=normal>1494</span>
<span class=normal>1495</span>
<span class=normal>1496</span>
<span class=normal>1497</span>
<span class=normal>1498</span>
<span class=normal>1499</span>
<span class=normal>1500</span>
<span class=normal>1501</span>
<span class=normal>1502</span>
<span class=normal>1503</span>
<span class=normal>1504</span>
<span class=normal>1505</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>empty</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Remove data (but not metadata) from BinnedEventArray.</span>

<span class=sd>    Attributes &#39;data&#39;, and &#39;support&#39; &#39;binned_support&#39; are all emptied.</span>

<span class=sd>    Note: n_series, series_ids, etc. are all preserved.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>inplace</span><span class=p>:</span>
        <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_copy_without_data</span><span class=p>()</span>
        <span class=n>out</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)(</span><span class=n>empty</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>out</span>
    <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span>
    <span class=n>out</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=bp>self</span><span class=o>.</span><span class=n>n_series</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span>
    <span class=n>out</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)(</span><span class=n>empty</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=n>out</span><span class=o>.</span><span class=n>_binned_support</span> <span class=o>=</span> <span class=kc>None</span>
    <span class=n>out</span><span class=o>.</span><span class=n>_bin_centers</span> <span class=o>=</span> <span class=kc>None</span>
    <span class=n>out</span><span class=o>.</span><span class=n>_bins</span> <span class=o>=</span> <span class=kc>None</span>
    <span class=n>out</span><span class=o>.</span><span class=n>_eventarray</span><span class=o>.</span><span class=n>empty</span><span class=p>(</span><span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=n>out</span><span class=o>.</span><span class=n>__renew__</span><span class=p>()</span>
    <span class=k>return</span> <span class=n>out</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.BinnedEventArray.flatten class="doc doc-heading"> <code class="highlight language-python"><span class=n>flatten</span><span class=p>(</span><span class=o>*</span><span class=p>,</span> <span class=n>series_id</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>series_label</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Collapse events across series.</p> <p>WARNING! series_tags are thrown away when flattening.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>series_id</code> </td> <td> </td> <td> <div class=doc-md-description> <p>(series) ID to assign to flattened event series, default is 0.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>series_label</code> </td> <td> </td> <td> <div class=doc-md-description> <p>(series) Label for event series, default is 'flattened'.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2137</span>
<span class=normal>2138</span>
<span class=normal>2139</span>
<span class=normal>2140</span>
<span class=normal>2141</span>
<span class=normal>2142</span>
<span class=normal>2143</span>
<span class=normal>2144</span>
<span class=normal>2145</span>
<span class=normal>2146</span>
<span class=normal>2147</span>
<span class=normal>2148</span>
<span class=normal>2149</span>
<span class=normal>2150</span>
<span class=normal>2151</span>
<span class=normal>2152</span>
<span class=normal>2153</span>
<span class=normal>2154</span>
<span class=normal>2155</span>
<span class=normal>2156</span>
<span class=normal>2157</span>
<span class=normal>2158</span>
<span class=normal>2159</span>
<span class=normal>2160</span>
<span class=normal>2161</span>
<span class=normal>2162</span>
<span class=normal>2163</span>
<span class=normal>2164</span>
<span class=normal>2165</span>
<span class=normal>2166</span>
<span class=normal>2167</span>
<span class=normal>2168</span>
<span class=normal>2169</span>
<span class=normal>2170</span>
<span class=normal>2171</span>
<span class=normal>2172</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>flatten</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>series_id</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>series_label</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Collapse events across series.</span>

<span class=sd>    WARNING! series_tags are thrown away when flattening.</span>

<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    series_id: (int)</span>
<span class=sd>        (series) ID to assign to flattened event series, default is 0.</span>
<span class=sd>    series_label (str)</span>
<span class=sd>        (series) Label for event series, default is &#39;flattened&#39;.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>n_series</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=p>:</span>  <span class=c1># already flattened</span>
        <span class=k>return</span> <span class=bp>self</span>

    <span class=c1># default args:</span>
    <span class=k>if</span> <span class=n>series_id</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>series_id</span> <span class=o>=</span> <span class=mi>0</span>
    <span class=k>if</span> <span class=n>series_label</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>series_label</span> <span class=o>=</span> <span class=s2>&quot;flattened&quot;</span>

    <span class=n>binnedeventarray</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_copy_without_data</span><span class=p>()</span>

    <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>),</span> <span class=n>ndmin</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>

    <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>_bins</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>bins</span>
    <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>support</span>
    <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>_bin_centers</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>bin_centers</span>
    <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>_binned_support</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>binned_support</span>

    <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>_series_ids</span> <span class=o>=</span> <span class=p>[</span><span class=n>series_id</span><span class=p>]</span>
    <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>_series_labels</span> <span class=o>=</span> <span class=p>[</span><span class=n>series_label</span><span class=p>]</span>
    <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>_series_tags</span> <span class=o>=</span> <span class=kc>None</span>
    <span class=n>binnedeventarray</span><span class=o>.</span><span class=n>__renew__</span><span class=p>()</span>

    <span class=k>return</span> <span class=n>binnedeventarray</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.BinnedEventArray.mean class="doc doc-heading"> <code class="highlight language-python"><span class=n>mean</span><span class=p>(</span><span class=o>*</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Returns the mean of each series in BinnedEventArray.</p> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1311</span>
<span class=normal>1312</span>
<span class=normal>1313</span>
<span class=normal>1314</span>
<span class=normal>1315</span>
<span class=normal>1316</span>
<span class=normal>1317</span>
<span class=normal>1318</span>
<span class=normal>1319</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>mean</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Returns the mean of each series in BinnedEventArray.&quot;&quot;&quot;</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>means</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nanmean</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=n>axis</span><span class=p>)</span><span class=o>.</span><span class=n>squeeze</span><span class=p>()</span>
        <span class=k>if</span> <span class=n>means</span><span class=o>.</span><span class=n>size</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
            <span class=k>return</span> <span class=n>means</span><span class=o>.</span><span class=n>item</span><span class=p>()</span>
        <span class=k>return</span> <span class=n>means</span>
    <span class=k>except</span> <span class=ne>IndexError</span><span class=p>:</span>
        <span class=k>raise</span> <span class=ne>IndexError</span><span class=p>(</span><span class=s2>&quot;Empty BinnedEventArray; cannot calculate mean.&quot;</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.BinnedEventArray.median class="doc doc-heading"> <code class="highlight language-python"><span class=n>median</span><span class=p>(</span><span class=o>*</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Returns the median of each series in BinnedEventArray.</p> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1301</span>
<span class=normal>1302</span>
<span class=normal>1303</span>
<span class=normal>1304</span>
<span class=normal>1305</span>
<span class=normal>1306</span>
<span class=normal>1307</span>
<span class=normal>1308</span>
<span class=normal>1309</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>median</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Returns the median of each series in BinnedEventArray.&quot;&quot;&quot;</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>medians</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nanmedian</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=n>axis</span><span class=p>)</span><span class=o>.</span><span class=n>squeeze</span><span class=p>()</span>
        <span class=k>if</span> <span class=n>medians</span><span class=o>.</span><span class=n>size</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
            <span class=k>return</span> <span class=n>medians</span><span class=o>.</span><span class=n>item</span><span class=p>()</span>
        <span class=k>return</span> <span class=n>medians</span>
    <span class=k>except</span> <span class=ne>IndexError</span><span class=p>:</span>
        <span class=k>raise</span> <span class=ne>IndexError</span><span class=p>(</span><span class=s2>&quot;Empty BinnedEventArray; cannot calculate median.&quot;</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.BinnedEventArray.normalize class="doc doc-heading"> <code class="highlight language-python"><span class=n>normalize</span><span class=p>(</span><span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Normalize data (unit standard deviation).</p> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1342</span>
<span class=normal>1343</span>
<span class=normal>1344</span>
<span class=normal>1345</span>
<span class=normal>1346</span>
<span class=normal>1347</span>
<span class=normal>1348</span>
<span class=normal>1349</span>
<span class=normal>1350</span>
<span class=normal>1351</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>normalize</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Normalize data (unit standard deviation).&quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>inplace</span><span class=p>:</span>
        <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
    <span class=n>std</span> <span class=o>=</span> <span class=n>out</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>
    <span class=n>std</span><span class=p>[</span><span class=n>std</span> <span class=o>==</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
    <span class=n>out</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=p>(</span><span class=n>out</span><span class=o>.</span><span class=n>_data</span><span class=o>.</span><span class=n>T</span> <span class=o>/</span> <span class=n>std</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>
    <span class=k>return</span> <span class=n>out</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.BinnedEventArray.partition class="doc doc-heading"> <code class="highlight language-python"><span class=n>partition</span><span class=p>(</span><span class=n>ds</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>n_intervals</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Returns a BaseEventArray whose support has been partitioned.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>ds</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Maximum duration (in seconds), for each interval.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>n_points</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of intervals. If ds is None and n_intervals is None, then default is to use n_intervals = 100</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>out</code></td> <td> <code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BaseEventArray>BaseEventArray</a></code> </td> <td> <div class=doc-md-description> <p>BaseEventArray that has been partitioned.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>Irrespective of whether 'ds' or 'n_intervals' are used, the exact of the supports are always included, even if this would cause n_points or ds to be violated.</p> </details> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1366</span>
<span class=normal>1367</span>
<span class=normal>1368</span>
<span class=normal>1369</span>
<span class=normal>1370</span>
<span class=normal>1371</span>
<span class=normal>1372</span>
<span class=normal>1373</span>
<span class=normal>1374</span>
<span class=normal>1375</span>
<span class=normal>1376</span>
<span class=normal>1377</span>
<span class=normal>1378</span>
<span class=normal>1379</span>
<span class=normal>1380</span>
<span class=normal>1381</span>
<span class=normal>1382</span>
<span class=normal>1383</span>
<span class=normal>1384</span>
<span class=normal>1385</span>
<span class=normal>1386</span>
<span class=normal>1387</span>
<span class=normal>1388</span>
<span class=normal>1389</span>
<span class=normal>1390</span>
<span class=normal>1391</span>
<span class=normal>1392</span>
<span class=normal>1393</span>
<span class=normal>1394</span>
<span class=normal>1395</span>
<span class=normal>1396</span>
<span class=normal>1397</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@keyword_equivalence</span><span class=p>(</span><span class=n>this_or_that</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;n_intervals&quot;</span><span class=p>:</span> <span class=s2>&quot;n_epochs&quot;</span><span class=p>})</span>
<span class=k>def</span><span class=w> </span><span class=nf>partition</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ds</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>n_intervals</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Returns a BaseEventArray whose support has been partitioned.</span>

<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    ds : float, optional</span>
<span class=sd>        Maximum duration (in seconds), for each interval.</span>
<span class=sd>    n_points : int, optional</span>
<span class=sd>        Number of intervals. If ds is None and n_intervals is None, then</span>
<span class=sd>        default is to use n_intervals = 100</span>

<span class=sd>    Returns</span>
<span class=sd>    -------</span>
<span class=sd>    out : BaseEventArray</span>
<span class=sd>        BaseEventArray that has been partitioned.</span>

<span class=sd>    Notes</span>
<span class=sd>    -----</span>
<span class=sd>    Irrespective of whether &#39;ds&#39; or &#39;n_intervals&#39; are used, the exact</span>
<span class=sd>    of the supports are always included, even if this would cause</span>
<span class=sd>    n_points or ds to be violated.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>partitioned</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=p>)(</span>
        <span class=n>core</span><span class=o>.</span><span class=n>RegularlySampledAnalogSignalArray</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span><span class=o>.</span><span class=n>partition</span><span class=p>(</span>
            <span class=n>ds</span><span class=o>=</span><span class=n>ds</span><span class=p>,</span> <span class=n>n_intervals</span><span class=o>=</span><span class=n>n_intervals</span>
        <span class=p>)</span>
    <span class=p>)</span>
    <span class=c1># partitioned.loc = ItemGetter_loc(partitioned)</span>
    <span class=c1># partitioned.iloc = ItemGetter_iloc(partitioned)</span>
    <span class=k>return</span> <span class=n>partitioned</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.BinnedEventArray.rebin class="doc doc-heading"> <code class="highlight language-python"><span class=n>rebin</span><span class=p>(</span><span class=n>w</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Rebin the BinnedEventArray into a coarser bin size.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>w</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>number of bins of width bst.ds to bin into new bin of width bst.ds*w. Default is w=1 (no re-binning).</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>out</code></td> <td> <code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray>BinnedEventArray</a></code> </td> <td> <div class=doc-md-description> <p>New BinnedEventArray with coarser resolution.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1941</span>
<span class=normal>1942</span>
<span class=normal>1943</span>
<span class=normal>1944</span>
<span class=normal>1945</span>
<span class=normal>1946</span>
<span class=normal>1947</span>
<span class=normal>1948</span>
<span class=normal>1949</span>
<span class=normal>1950</span>
<span class=normal>1951</span>
<span class=normal>1952</span>
<span class=normal>1953</span>
<span class=normal>1954</span>
<span class=normal>1955</span>
<span class=normal>1956</span>
<span class=normal>1957</span>
<span class=normal>1958</span>
<span class=normal>1959</span>
<span class=normal>1960</span>
<span class=normal>1961</span>
<span class=normal>1962</span>
<span class=normal>1963</span>
<span class=normal>1964</span>
<span class=normal>1965</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>rebin</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>w</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Rebin the BinnedEventArray into a coarser bin size.</span>

<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    w : int, optional</span>
<span class=sd>        number of bins of width bst.ds to bin into new bin of</span>
<span class=sd>        width bst.ds*w. Default is w=1 (no re-binning).</span>

<span class=sd>    Returns</span>
<span class=sd>    -------</span>
<span class=sd>    out : BinnedEventArray</span>
<span class=sd>        New BinnedEventArray with coarser resolution.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>if</span> <span class=n>w</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>w</span> <span class=o>=</span> <span class=mi>1</span>

    <span class=k>if</span> <span class=ow>not</span> <span class=nb>float</span><span class=p>(</span><span class=n>w</span><span class=p>)</span><span class=o>.</span><span class=n>is_integer</span><span class=p>:</span>
        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;w has to be an integer!&quot;</span><span class=p>)</span>

    <span class=n>w</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>w</span><span class=p>)</span>

    <span class=n>bst</span> <span class=o>=</span> <span class=bp>self</span>
    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_rebin_binnedeventarray</span><span class=p>(</span><span class=n>bst</span><span class=p>,</span> <span class=n>w</span><span class=o>=</span><span class=n>w</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.BinnedEventArray.smooth class="doc doc-heading"> <code class="highlight language-python"><span class=n>smooth</span><span class=p>(</span><span class=o>*</span><span class=p>,</span> <span class=n>sigma</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>truncate</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>within_intervals</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Smooth BinnedEventArray by convolving with a Gaussian kernel.</p> <p>Smoothing is applied in data, and the same smoothing is applied to each series in a BinnedEventArray.</p> <p>Smoothing is applied within each interval.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>sigma</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Standard deviation of Gaussian kernel, in seconds. Default is 0.01 (10 ms)</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>truncate</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Bandwidth outside of which the filter value will be zero. Default is 4.0</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>inplace</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>If True the data will be replaced with the smoothed data. Default is False.</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>out</code></td> <td> <code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray>BinnedEventArray</a></code> </td> <td> <div class=doc-md-description> <p>New BinnedEventArray with smoothed data.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1833</span>
<span class=normal>1834</span>
<span class=normal>1835</span>
<span class=normal>1836</span>
<span class=normal>1837</span>
<span class=normal>1838</span>
<span class=normal>1839</span>
<span class=normal>1840</span>
<span class=normal>1841</span>
<span class=normal>1842</span>
<span class=normal>1843</span>
<span class=normal>1844</span>
<span class=normal>1845</span>
<span class=normal>1846</span>
<span class=normal>1847</span>
<span class=normal>1848</span>
<span class=normal>1849</span>
<span class=normal>1850</span>
<span class=normal>1851</span>
<span class=normal>1852</span>
<span class=normal>1853</span>
<span class=normal>1854</span>
<span class=normal>1855</span>
<span class=normal>1856</span>
<span class=normal>1857</span>
<span class=normal>1858</span>
<span class=normal>1859</span>
<span class=normal>1860</span>
<span class=normal>1861</span>
<span class=normal>1862</span>
<span class=normal>1863</span>
<span class=normal>1864</span>
<span class=normal>1865</span>
<span class=normal>1866</span>
<span class=normal>1867</span>
<span class=normal>1868</span>
<span class=normal>1869</span>
<span class=normal>1870</span>
<span class=normal>1871</span>
<span class=normal>1872</span>
<span class=normal>1873</span>
<span class=normal>1874</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@keyword_deprecation</span><span class=p>(</span><span class=n>replace_x_with_y</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;bw&quot;</span><span class=p>:</span> <span class=s2>&quot;truncate&quot;</span><span class=p>})</span>
<span class=k>def</span><span class=w> </span><span class=nf>smooth</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>sigma</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>truncate</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>within_intervals</span><span class=o>=</span><span class=kc>False</span>
<span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Smooth BinnedEventArray by convolving with a Gaussian kernel.</span>

<span class=sd>    Smoothing is applied in data, and the same smoothing is applied</span>
<span class=sd>    to each series in a BinnedEventArray.</span>

<span class=sd>    Smoothing is applied within each interval.</span>

<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    sigma : float, optional</span>
<span class=sd>        Standard deviation of Gaussian kernel, in seconds. Default is 0.01 (10 ms)</span>
<span class=sd>    truncate : float, optional</span>
<span class=sd>        Bandwidth outside of which the filter value will be zero. Default is 4.0</span>
<span class=sd>    inplace : bool</span>
<span class=sd>        If True the data will be replaced with the smoothed data.</span>
<span class=sd>        Default is False.</span>

<span class=sd>    Returns</span>
<span class=sd>    -------</span>
<span class=sd>    out : BinnedEventArray</span>
<span class=sd>        New BinnedEventArray with smoothed data.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>if</span> <span class=n>truncate</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>truncate</span> <span class=o>=</span> <span class=mi>4</span>
    <span class=k>if</span> <span class=n>sigma</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>sigma</span> <span class=o>=</span> <span class=mf>0.01</span>  <span class=c1># 10 ms default</span>

    <span class=n>fs</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>/</span> <span class=bp>self</span><span class=o>.</span><span class=n>ds</span>

    <span class=k>return</span> <span class=n>utils</span><span class=o>.</span><span class=n>gaussian_filter</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>fs</span><span class=o>=</span><span class=n>fs</span><span class=p>,</span>
        <span class=n>sigma</span><span class=o>=</span><span class=n>sigma</span><span class=p>,</span>
        <span class=n>truncate</span><span class=o>=</span><span class=n>truncate</span><span class=p>,</span>
        <span class=n>inplace</span><span class=o>=</span><span class=n>inplace</span><span class=p>,</span>
        <span class=n>within_intervals</span><span class=o>=</span><span class=n>within_intervals</span><span class=p>,</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.BinnedEventArray.standardize class="doc doc-heading"> <code class="highlight language-python"><span class=n>standardize</span><span class=p>(</span><span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Standardize data (zero mean and unit std deviation).</p> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1353</span>
<span class=normal>1354</span>
<span class=normal>1355</span>
<span class=normal>1356</span>
<span class=normal>1357</span>
<span class=normal>1358</span>
<span class=normal>1359</span>
<span class=normal>1360</span>
<span class=normal>1361</span>
<span class=normal>1362</span>
<span class=normal>1363</span>
<span class=normal>1364</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>standardize</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Standardize data (zero mean and unit std deviation).&quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>inplace</span><span class=p>:</span>
        <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
    <span class=n>out</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=p>(</span><span class=n>out</span><span class=o>.</span><span class=n>_data</span><span class=o>.</span><span class=n>T</span> <span class=o>-</span> <span class=n>out</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span><span class=o>.</span><span class=n>T</span>
    <span class=n>std</span> <span class=o>=</span> <span class=n>out</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>
    <span class=n>std</span><span class=p>[</span><span class=n>std</span> <span class=o>==</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
    <span class=n>out</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=p>(</span><span class=n>out</span><span class=o>.</span><span class=n>_data</span><span class=o>.</span><span class=n>T</span> <span class=o>/</span> <span class=n>std</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>

    <span class=k>return</span> <span class=n>out</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.BinnedEventArray.std class="doc doc-heading"> <code class="highlight language-python"><span class=n>std</span><span class=p>(</span><span class=o>*</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Returns the standard deviation of each series in BinnedEventArray.</p> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1321</span>
<span class=normal>1322</span>
<span class=normal>1323</span>
<span class=normal>1324</span>
<span class=normal>1325</span>
<span class=normal>1326</span>
<span class=normal>1327</span>
<span class=normal>1328</span>
<span class=normal>1329</span>
<span class=normal>1330</span>
<span class=normal>1331</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>std</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Returns the standard deviation of each series in BinnedEventArray.&quot;&quot;&quot;</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>stds</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nanstd</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=n>axis</span><span class=p>)</span><span class=o>.</span><span class=n>squeeze</span><span class=p>()</span>
        <span class=k>if</span> <span class=n>stds</span><span class=o>.</span><span class=n>size</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
            <span class=k>return</span> <span class=n>stds</span><span class=o>.</span><span class=n>item</span><span class=p>()</span>
        <span class=k>return</span> <span class=n>stds</span>
    <span class=k>except</span> <span class=ne>IndexError</span><span class=p>:</span>
        <span class=k>raise</span> <span class=ne>IndexError</span><span class=p>(</span>
            <span class=s2>&quot;Empty BinnedEventArray; cannot calculate standard deviation&quot;</span>
        <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=nelpy.core._eventarray.BinnedSpikeTrainArray class="doc doc-heading"> <code>BinnedSpikeTrainArray</code> </h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray>BinnedEventArray</a></code></p> <p>Binned spike train array for analyzing neural spike data.</p> <p>A specialized version of BinnedEventArray designed specifically for spike train analysis. This class bins spike events into discrete time intervals and provides spike train-specific methods and properties through aliased attribute names.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>eventarray</code> </td> <td> <code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.EventArray>EventArray</a> or <a class="autorefs autorefs-internal" href=../analogsignalarray/#nelpy.core._analogsignalarray.RegularlySampledAnalogSignalArray>RegularlySampledAnalogSignalArray</a></code> </td> <td> <div class=doc-md-description> <p>Input spike train data to be binned.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>ds</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>The bin width, in seconds. Default is 0.0625 (62.5 ms).</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>empty</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether an empty BinnedSpikeTrainArray should be constructed (no data). Default is False.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>fs</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Sampling rate in Hz. If fs is passed as a parameter, then data is assumed to be in sample numbers instead of actual time values.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>support</code> </td> <td> <code><a class="autorefs autorefs-internal" href=../intervalarray/#nelpy.core._intervalarray.IntervalArray>IntervalArray</a></code> </td> <td> <div class=doc-md-description> <p>The support (time intervals) over which the spike trains are defined.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>unit_ids</code> </td> <td> <code>list of int</code> </td> <td> <div class=doc-md-description> <p>Unit IDs for each spike train. Default creates sequential IDs starting from 1.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>unit_labels</code> </td> <td> <code>list of str</code> </td> <td> <div class=doc-md-description> <p>Labels corresponding to units. Default casts unit_ids to str.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>unit_tags</code> </td> <td> <code><span title=optional>optional</span></code> </td> <td> <div class=doc-md-description> <p>Tags corresponding to units. Currently accepts any type.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>label</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Information pertaining to the source of the spike train data. Default is None.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>abscissa</code> </td> <td> <code><a class="autorefs autorefs-internal" href=../coordinates/#nelpy.core._coordinates.TemporalAbscissa>TemporalAbscissa</a></code> </td> <td> <div class=doc-md-description> <p>Object for the time (x-axis) coordinate. Default creates TemporalAbscissa.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>ordinate</code> </td> <td> <code><a class="autorefs autorefs-internal" href=../coordinates/#nelpy.core._coordinates.AnalogSignalArrayOrdinate>AnalogSignalArrayOrdinate</a></code> </td> <td> <div class=doc-md-description> <p>Object for the signal (y-axis) coordinate. Default creates AnalogSignalArrayOrdinate.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>**kwargs</code> </td> <td> <code><span title=optional>optional</span></code> </td> <td> <div class=doc-md-description> <p>Additional keyword arguments passed to the parent BinnedEventArray constructor.</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Attributes:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.BinnedSpikeTrainArray.Note>Note</span></code></td> <td> <code>Read the docstring for the BinnedEventArray parent class for additional</code> </td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="nelpy.core._eventarray.BinnedSpikeTrainArray.attributes that are defined there.">attributes that are defined there.</span></code></td> <td> </td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="nelpy.core._eventarray.BinnedSpikeTrainArray.Spike train-specific attributes (aliases)">Spike train-specific attributes (aliases)</span></code></td> <td> </td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.BinnedSpikeTrainArray.time>time</span></code></td> <td> <code><span title=numpy.array>array</span></code> </td> <td> <div class=doc-md-description> <p>Alias for data. Spike counts in all bins, with shape (n_units, n_bins).</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.BinnedSpikeTrainArray.n_epochs>n_epochs</span></code></td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Alias for n_intervals. The number of underlying time intervals.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.BinnedSpikeTrainArray.n_units>n_units</span></code></td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Alias for n_series. The number of units (neurons).</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.BinnedSpikeTrainArray.n_spikes>n_spikes</span></code></td> <td> <code><span title=numpy.ndarray>ndarray</span></code> </td> <td> <div class=doc-md-description> <p>Alias for n_events. The number of spikes in each unit.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.BinnedSpikeTrainArray.unit_ids>unit_ids</span></code></td> <td> <code>list of int</code> </td> <td> <div class=doc-md-description> <p>Alias for series_ids. Unit IDs contained in the spike train array.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.BinnedSpikeTrainArray.unit_labels>unit_labels</span></code></td> <td> <code>list of str</code> </td> <td> <div class=doc-md-description> <p>Alias for series_labels. Labels corresponding to units.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.BinnedSpikeTrainArray.unit_tags>unit_tags</span></code></td> <td> </td> <td> <div class=doc-md-description> <p>Alias for series_tags. Tags corresponding to units.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="nelpy.core._eventarray.BinnedSpikeTrainArray.Inherited attributes">Inherited attributes</span></code></td> <td> </td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BaseEventArray.isempty>isempty</a></code></td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether the BinnedSpikeTrainArray is empty (no data).</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.bin_centers>bin_centers</a></code></td> <td> <code><span title=numpy.ndarray>ndarray</span></code> </td> <td> <div class=doc-md-description> <p>The bin centers, in seconds.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.data>data</a></code></td> <td> <code>np.array, with shape (n_units, n_bins)</code> </td> <td> <div class=doc-md-description> <p>Spike counts in all bins.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.bins>bins</a></code></td> <td> <code><span title=numpy.ndarray>ndarray</span></code> </td> <td> <div class=doc-md-description> <p>The bin edges, in seconds.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.binned_support>binned_support</a></code></td> <td> <code>np.ndarray, with shape (n_intervals, 2)</code> </td> <td> <div class=doc-md-description> <p>The binned support of the array (in bin IDs).</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.lengths>lengths</a></code></td> <td> <code><span title=numpy.ndarray>ndarray</span></code> </td> <td> <div class=doc-md-description> <p>Lengths of contiguous segments, in number of bins.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.eventarray>eventarray</a></code></td> <td> <code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.EventArray>EventArray</a></code> </td> <td> <div class=doc-md-description> <p>The original EventArray associated with the binned spike data.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.n_bins>n_bins</a></code></td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>The number of bins.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.ds>ds</a></code></td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Bin width, in seconds.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.n_active>n_active</a></code></td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>The number of active units. A unit is considered active if it fired at least one spike.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BinnedEventArray.n_active_per_bin>n_active_per_bin</a></code></td> <td> <code>np.ndarray, with shape (n_bins, )</code> </td> <td> <div class=doc-md-description> <p>Number of active units per data bin.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BaseEventArray.support>support</a></code></td> <td> <code><a class="autorefs autorefs-internal" href=../intervalarray/#nelpy.core._intervalarray.IntervalArray>IntervalArray</a></code> </td> <td> <div class=doc-md-description> <p>The support of the BinnedSpikeTrainArray.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Methods:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title="nelpy.core._eventarray.BinnedSpikeTrainArray.All methods from BinnedEventArray are available, plus spike train-specific">All methods from BinnedEventArray are available, plus spike train-specific</span></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="nelpy.core._eventarray.BinnedSpikeTrainArray.aliases for method names:">aliases for method names:</span></code></td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.BinnedSpikeTrainArray.reorder_units_by_ids>reorder_units_by_ids</span></code></td> <td> <div class=doc-md-description> <p>Alias for reorder_series_by_ids. Reorder units by their IDs.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.BinnedSpikeTrainArray.reorder_units>reorder_units</span></code></td> <td> <div class=doc-md-description> <p>Alias for reorder_series. Reorder units.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span><span class=w> </span><span class=nn>nelpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>nel</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># Create a BinnedSpikeTrainArray from spike times</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>spike_times</span> <span class=o>=</span> <span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>0.1</span><span class=p>,</span> <span class=mf>0.3</span><span class=p>,</span> <span class=mf>0.7</span><span class=p>]),</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>0.2</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>,</span> <span class=mf>0.8</span><span class=p>])]</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>sta</span> <span class=o>=</span> <span class=n>SpikeTrainArray</span><span class=p>(</span><span class=n>spike_times</span><span class=p>,</span> <span class=n>unit_ids</span><span class=o>=</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=n>fs</span><span class=o>=</span><span class=mi>1000</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>bst</span> <span class=o>=</span> <span class=n>nel</span><span class=o>.</span><span class=n>BinnedSpikeTrainArray</span><span class=p>(</span><span class=n>sta</span><span class=p>,</span> <span class=n>ds</span><span class=o>=</span><span class=mf>0.1</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>bst</span><span class=o>.</span><span class=n>n_units</span><span class=p>)</span>
<span class=go>2</span>
<span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>bst</span><span class=o>.</span><span class=n>n_bins</span><span class=p>)</span>
<span class=go>7</span>
<span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>bst</span><span class=o>.</span><span class=n>time</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>  <span class=c1># alias for data</span>
<span class=go>(2, 7)</span>
</code></pre></div> <details class=see-also open> <summary>See Also</summary> <p>BinnedEventArray : Parent class for general event arrays EventArray : Unbinned event array class SpikeTrainArray : Unbinned spike train array class</p> </details> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2439</span>
<span class=normal>2440</span>
<span class=normal>2441</span>
<span class=normal>2442</span>
<span class=normal>2443</span>
<span class=normal>2444</span>
<span class=normal>2445</span>
<span class=normal>2446</span>
<span class=normal>2447</span>
<span class=normal>2448</span>
<span class=normal>2449</span>
<span class=normal>2450</span>
<span class=normal>2451</span>
<span class=normal>2452</span>
<span class=normal>2453</span>
<span class=normal>2454</span>
<span class=normal>2455</span>
<span class=normal>2456</span>
<span class=normal>2457</span>
<span class=normal>2458</span>
<span class=normal>2459</span>
<span class=normal>2460</span>
<span class=normal>2461</span>
<span class=normal>2462</span>
<span class=normal>2463</span>
<span class=normal>2464</span>
<span class=normal>2465</span>
<span class=normal>2466</span>
<span class=normal>2467</span>
<span class=normal>2468</span>
<span class=normal>2469</span>
<span class=normal>2470</span>
<span class=normal>2471</span>
<span class=normal>2472</span>
<span class=normal>2473</span>
<span class=normal>2474</span>
<span class=normal>2475</span>
<span class=normal>2476</span>
<span class=normal>2477</span>
<span class=normal>2478</span>
<span class=normal>2479</span>
<span class=normal>2480</span>
<span class=normal>2481</span>
<span class=normal>2482</span>
<span class=normal>2483</span>
<span class=normal>2484</span>
<span class=normal>2485</span>
<span class=normal>2486</span>
<span class=normal>2487</span>
<span class=normal>2488</span>
<span class=normal>2489</span>
<span class=normal>2490</span>
<span class=normal>2491</span>
<span class=normal>2492</span>
<span class=normal>2493</span>
<span class=normal>2494</span>
<span class=normal>2495</span>
<span class=normal>2496</span>
<span class=normal>2497</span>
<span class=normal>2498</span>
<span class=normal>2499</span>
<span class=normal>2500</span>
<span class=normal>2501</span>
<span class=normal>2502</span>
<span class=normal>2503</span>
<span class=normal>2504</span>
<span class=normal>2505</span>
<span class=normal>2506</span>
<span class=normal>2507</span>
<span class=normal>2508</span>
<span class=normal>2509</span>
<span class=normal>2510</span>
<span class=normal>2511</span>
<span class=normal>2512</span>
<span class=normal>2513</span>
<span class=normal>2514</span>
<span class=normal>2515</span>
<span class=normal>2516</span>
<span class=normal>2517</span>
<span class=normal>2518</span>
<span class=normal>2519</span>
<span class=normal>2520</span>
<span class=normal>2521</span>
<span class=normal>2522</span>
<span class=normal>2523</span>
<span class=normal>2524</span>
<span class=normal>2525</span>
<span class=normal>2526</span>
<span class=normal>2527</span>
<span class=normal>2528</span>
<span class=normal>2529</span>
<span class=normal>2530</span>
<span class=normal>2531</span>
<span class=normal>2532</span>
<span class=normal>2533</span>
<span class=normal>2534</span>
<span class=normal>2535</span>
<span class=normal>2536</span>
<span class=normal>2537</span>
<span class=normal>2538</span>
<span class=normal>2539</span>
<span class=normal>2540</span>
<span class=normal>2541</span>
<span class=normal>2542</span>
<span class=normal>2543</span>
<span class=normal>2544</span>
<span class=normal>2545</span>
<span class=normal>2546</span>
<span class=normal>2547</span>
<span class=normal>2548</span>
<span class=normal>2549</span>
<span class=normal>2550</span>
<span class=normal>2551</span>
<span class=normal>2552</span>
<span class=normal>2553</span>
<span class=normal>2554</span>
<span class=normal>2555</span>
<span class=normal>2556</span>
<span class=normal>2557</span>
<span class=normal>2558</span>
<span class=normal>2559</span>
<span class=normal>2560</span>
<span class=normal>2561</span>
<span class=normal>2562</span>
<span class=normal>2563</span>
<span class=normal>2564</span>
<span class=normal>2565</span>
<span class=normal>2566</span>
<span class=normal>2567</span>
<span class=normal>2568</span>
<span class=normal>2569</span>
<span class=normal>2570</span>
<span class=normal>2571</span>
<span class=normal>2572</span>
<span class=normal>2573</span>
<span class=normal>2574</span>
<span class=normal>2575</span>
<span class=normal>2576</span>
<span class=normal>2577</span>
<span class=normal>2578</span>
<span class=normal>2579</span>
<span class=normal>2580</span>
<span class=normal>2581</span>
<span class=normal>2582</span>
<span class=normal>2583</span>
<span class=normal>2584</span>
<span class=normal>2585</span>
<span class=normal>2586</span>
<span class=normal>2587</span>
<span class=normal>2588</span>
<span class=normal>2589</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>BinnedSpikeTrainArray</span><span class=p>(</span><span class=n>BinnedEventArray</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Binned spike train array for analyzing neural spike data.</span>

<span class=sd>    A specialized version of BinnedEventArray designed specifically for spike train</span>
<span class=sd>    analysis. This class bins spike events into discrete time intervals and provides</span>
<span class=sd>    spike train-specific methods and properties through aliased attribute names.</span>

<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    eventarray : nelpy.EventArray or nelpy.RegularlySampledAnalogSignalArray, optional</span>
<span class=sd>        Input spike train data to be binned.</span>
<span class=sd>    ds : float, optional</span>
<span class=sd>        The bin width, in seconds. Default is 0.0625 (62.5 ms).</span>
<span class=sd>    empty : bool, optional</span>
<span class=sd>        Whether an empty BinnedSpikeTrainArray should be constructed (no data).</span>
<span class=sd>        Default is False.</span>
<span class=sd>    fs : float, optional</span>
<span class=sd>        Sampling rate in Hz. If fs is passed as a parameter, then data</span>
<span class=sd>        is assumed to be in sample numbers instead of actual time values.</span>
<span class=sd>    support : nelpy.IntervalArray, optional</span>
<span class=sd>        The support (time intervals) over which the spike trains are defined.</span>
<span class=sd>    unit_ids : list of int, optional</span>
<span class=sd>        Unit IDs for each spike train. Default creates sequential IDs starting from 1.</span>
<span class=sd>    unit_labels : list of str, optional</span>
<span class=sd>        Labels corresponding to units. Default casts unit_ids to str.</span>
<span class=sd>    unit_tags : optional</span>
<span class=sd>        Tags corresponding to units. Currently accepts any type.</span>
<span class=sd>    label : str, optional</span>
<span class=sd>        Information pertaining to the source of the spike train data.</span>
<span class=sd>        Default is None.</span>
<span class=sd>    abscissa : nelpy.TemporalAbscissa, optional</span>
<span class=sd>        Object for the time (x-axis) coordinate. Default creates TemporalAbscissa.</span>
<span class=sd>    ordinate : nelpy.AnalogSignalArrayOrdinate, optional</span>
<span class=sd>        Object for the signal (y-axis) coordinate. Default creates AnalogSignalArrayOrdinate.</span>
<span class=sd>    **kwargs : optional</span>
<span class=sd>        Additional keyword arguments passed to the parent BinnedEventArray constructor.</span>

<span class=sd>    Attributes</span>
<span class=sd>    ----------</span>
<span class=sd>    Note : Read the docstring for the BinnedEventArray parent class for additional</span>
<span class=sd>    attributes that are defined there.</span>

<span class=sd>    Spike train-specific attributes (aliases):</span>
<span class=sd>    time : np.array</span>
<span class=sd>        Alias for data. Spike counts in all bins, with shape (n_units, n_bins).</span>
<span class=sd>    n_epochs : int</span>
<span class=sd>        Alias for n_intervals. The number of underlying time intervals.</span>
<span class=sd>    n_units : int</span>
<span class=sd>        Alias for n_series. The number of units (neurons).</span>
<span class=sd>    n_spikes : np.ndarray</span>
<span class=sd>        Alias for n_events. The number of spikes in each unit.</span>
<span class=sd>    unit_ids : list of int</span>
<span class=sd>        Alias for series_ids. Unit IDs contained in the spike train array.</span>
<span class=sd>    unit_labels : list of str</span>
<span class=sd>        Alias for series_labels. Labels corresponding to units.</span>
<span class=sd>    unit_tags :</span>
<span class=sd>        Alias for series_tags. Tags corresponding to units.</span>

<span class=sd>    Inherited attributes:</span>
<span class=sd>    isempty : bool</span>
<span class=sd>        Whether the BinnedSpikeTrainArray is empty (no data).</span>
<span class=sd>    bin_centers : np.ndarray</span>
<span class=sd>        The bin centers, in seconds.</span>
<span class=sd>    data : np.array, with shape (n_units, n_bins)</span>
<span class=sd>        Spike counts in all bins.</span>
<span class=sd>    bins : np.ndarray</span>
<span class=sd>        The bin edges, in seconds.</span>
<span class=sd>    binned_support : np.ndarray, with shape (n_intervals, 2)</span>
<span class=sd>        The binned support of the array (in bin IDs).</span>
<span class=sd>    lengths : np.ndarray</span>
<span class=sd>        Lengths of contiguous segments, in number of bins.</span>
<span class=sd>    eventarray : nelpy.EventArray</span>
<span class=sd>        The original EventArray associated with the binned spike data.</span>
<span class=sd>    n_bins : int</span>
<span class=sd>        The number of bins.</span>
<span class=sd>    ds : float</span>
<span class=sd>        Bin width, in seconds.</span>
<span class=sd>    n_active : int</span>
<span class=sd>        The number of active units. A unit is considered active if</span>
<span class=sd>        it fired at least one spike.</span>
<span class=sd>    n_active_per_bin : np.ndarray, with shape (n_bins, )</span>
<span class=sd>        Number of active units per data bin.</span>
<span class=sd>    support : nelpy.IntervalArray</span>
<span class=sd>        The support of the BinnedSpikeTrainArray.</span>

<span class=sd>    Methods</span>
<span class=sd>    -------</span>
<span class=sd>    All methods from BinnedEventArray are available, plus spike train-specific</span>
<span class=sd>    aliases for method names:</span>

<span class=sd>    reorder_units_by_ids(*args, **kwargs)</span>
<span class=sd>        Alias for reorder_series_by_ids. Reorder units by their IDs.</span>
<span class=sd>    reorder_units(*args, **kwargs)</span>
<span class=sd>        Alias for reorder_series. Reorder units.</span>

<span class=sd>    Examples</span>
<span class=sd>    --------</span>
<span class=sd>    &gt;&gt;&gt; import nelpy as nel</span>
<span class=sd>    &gt;&gt;&gt; # Create a BinnedSpikeTrainArray from spike times</span>
<span class=sd>    &gt;&gt;&gt; spike_times = [np.array([0.1, 0.3, 0.7]), np.array([0.2, 0.5, 0.8])]</span>
<span class=sd>    &gt;&gt;&gt; sta = SpikeTrainArray(spike_times, unit_ids=[1, 2], fs=1000)</span>
<span class=sd>    &gt;&gt;&gt; bst = nel.BinnedSpikeTrainArray(sta, ds=0.1)</span>
<span class=sd>    &gt;&gt;&gt; print(bst.n_units)</span>
<span class=sd>    2</span>
<span class=sd>    &gt;&gt;&gt; print(bst.n_bins)</span>
<span class=sd>    7</span>
<span class=sd>    &gt;&gt;&gt; print(bst.time.shape)  # alias for data</span>
<span class=sd>    (2, 7)</span>

<span class=sd>    See Also</span>
<span class=sd>    --------</span>
<span class=sd>    BinnedEventArray : Parent class for general event arrays</span>
<span class=sd>    EventArray : Unbinned event array class</span>
<span class=sd>    SpikeTrainArray : Unbinned spike train array class</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=c1># specify class-specific aliases:</span>
    <span class=n>__aliases__</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&quot;time&quot;</span><span class=p>:</span> <span class=s2>&quot;data&quot;</span><span class=p>,</span>
        <span class=s2>&quot;_time&quot;</span><span class=p>:</span> <span class=s2>&quot;_data&quot;</span><span class=p>,</span>
        <span class=s2>&quot;n_epochs&quot;</span><span class=p>:</span> <span class=s2>&quot;n_intervals&quot;</span><span class=p>,</span>
        <span class=s2>&quot;n_units&quot;</span><span class=p>:</span> <span class=s2>&quot;n_series&quot;</span><span class=p>,</span>
        <span class=s2>&quot;_unit_subset&quot;</span><span class=p>:</span> <span class=s2>&quot;_series_subset&quot;</span><span class=p>,</span>  <span class=c1># requires kw change</span>
        <span class=c1># &#39;get_event_firing_order&#39; : &#39;get_spike_firing_order&#39;</span>
        <span class=s2>&quot;reorder_units_by_ids&quot;</span><span class=p>:</span> <span class=s2>&quot;reorder_series_by_ids&quot;</span><span class=p>,</span>
        <span class=s2>&quot;reorder_units&quot;</span><span class=p>:</span> <span class=s2>&quot;reorder_series&quot;</span><span class=p>,</span>
        <span class=s2>&quot;_reorder_units_by_idx&quot;</span><span class=p>:</span> <span class=s2>&quot;_reorder_series_by_idx&quot;</span><span class=p>,</span>
        <span class=s2>&quot;n_spikes&quot;</span><span class=p>:</span> <span class=s2>&quot;n_events&quot;</span><span class=p>,</span>
        <span class=s2>&quot;unit_ids&quot;</span><span class=p>:</span> <span class=s2>&quot;series_ids&quot;</span><span class=p>,</span>
        <span class=s2>&quot;unit_labels&quot;</span><span class=p>:</span> <span class=s2>&quot;series_labels&quot;</span><span class=p>,</span>
        <span class=s2>&quot;unit_tags&quot;</span><span class=p>:</span> <span class=s2>&quot;series_tags&quot;</span><span class=p>,</span>
        <span class=s2>&quot;_unit_ids&quot;</span><span class=p>:</span> <span class=s2>&quot;_series_ids&quot;</span><span class=p>,</span>
        <span class=s2>&quot;_unit_labels&quot;</span><span class=p>:</span> <span class=s2>&quot;_series_labels&quot;</span><span class=p>,</span>
        <span class=s2>&quot;_unit_tags&quot;</span><span class=p>:</span> <span class=s2>&quot;_series_tags&quot;</span><span class=p>,</span>
    <span class=p>}</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
        <span class=c1># add class-specific aliases to existing aliases:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>__aliases__</span> <span class=o>=</span> <span class=p>{</span><span class=o>**</span><span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>__aliases__</span><span class=p>,</span> <span class=o>**</span><span class=bp>self</span><span class=o>.</span><span class=n>__aliases__</span><span class=p>}</span>

        <span class=n>support</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;support&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>support</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>abscissa</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;abscissa&quot;</span><span class=p>,</span> <span class=n>core</span><span class=o>.</span><span class=n>TemporalAbscissa</span><span class=p>(</span><span class=n>support</span><span class=o>=</span><span class=n>support</span><span class=p>))</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>abscissa</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;abscissa&quot;</span><span class=p>,</span> <span class=n>core</span><span class=o>.</span><span class=n>TemporalAbscissa</span><span class=p>())</span>
        <span class=n>ordinate</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;ordinate&quot;</span><span class=p>,</span> <span class=n>core</span><span class=o>.</span><span class=n>AnalogSignalArrayOrdinate</span><span class=p>())</span>

        <span class=n>kwargs</span><span class=p>[</span><span class=s2>&quot;abscissa&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>abscissa</span>
        <span class=n>kwargs</span><span class=p>[</span><span class=s2>&quot;ordinate&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>ordinate</span>

        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=nelpy.core._eventarray.EventArray class="doc doc-heading"> <code>EventArray</code> </h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BaseEventArray>BaseEventArray</a></code></p> <p>A multiseries eventarray with shared support.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>abscissa_vals</code> </td> <td> <code>array of np.array(dtype=np.float64) event datas in seconds.</code> </td> <td> <div class=doc-md-description> <p>Array of length n_series, each entry with shape (n_data,).</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>fs</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Sampling rate in Hz. Default is 30,000.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>support</code> </td> <td> <code><a class="autorefs autorefs-internal" href=../intervalarray/#nelpy.core._intervalarray.IntervalArray>IntervalArray</a></code> </td> <td> <div class=doc-md-description> <p>IntervalArray on which eventarrays are defined. Default is [0, last event] inclusive.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>series_ids</code> </td> <td> <code>list of int</code> </td> <td> <div class=doc-md-description> <p>Unit IDs.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>series_labels</code> </td> <td> <code>list of str</code> </td> <td> <div class=doc-md-description> <p>Labels corresponding to series. Default casts series_ids to str.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>series_tags</code> </td> <td> <code><span title=optional>optional</span></code> </td> <td> <div class=doc-md-description> <p>Tags correponding to series. NOTE: Currently we do not do any input validation so these can be any type. We also don't use these for anything yet.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>label</code> </td> <td> <code><span title=str>str</span> or None</code> </td> <td> <div class=doc-md-description> <p>Information pertaining to the source of the eventarray.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>empty</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether an empty EventArray should be constructed (no data).</p> </div> </td> <td> <code>False</code> </td> </tr> <tr class=doc-section-item> <td> <code>assume_sorted</code> </td> <td> <code><span title=boolean>boolean</span></code> </td> <td> <div class=doc-md-description> <p>Whether the abscissa values should be treated as sorted (non-decreasing) or not. Significant overhead during RSASA object creation can be removed if this is True, but note that unsorted abscissa values will mess everything up. Default is False</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>kwargs</code> </td> <td> <code><span title=optional>optional</span></code> </td> <td> <div class=doc-md-description> <p>Additional keyword arguments to forward along to the BaseEventArray constructor.</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Attributes:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.EventArray.Note>Note</span></code></td> <td> <code>Read the docstring for the BaseEventArray superclass for additional</code> </td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="nelpy.core._eventarray.EventArray.attributes that are defined there.">attributes that are defined there.</span></code></td> <td> </td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.EventArray.isempty>isempty</a></code></td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether the EventArray is empty (no data).</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.EventArray.n_series>n_series</a></code></td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>The number of series.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.EventArray.n_active>n_active</a></code></td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>The number of active series. A series is considered active if it fired at least one event.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.EventArray.data>data</a></code></td> <td> <code>array of np.array(dtype=np.float64) event datas in seconds.</code> </td> <td> <div class=doc-md-description> <p>Array of length n_series, each entry with shape (n_data,).</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.EventArray.n_events>n_events</a></code></td> <td> <code><span title=numpy.ndarray>ndarray</span></code> </td> <td> <div class=doc-md-description> <p>The number of events in each series.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.EventArray.issorted>issorted</a></code></td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether the data are sorted.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.EventArray.first_event>first_event</a></code></td> <td> <code><span title=numpy.float>float</span></code> </td> <td> <div class=doc-md-description> <p>The time of the very first event, across all series.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.EventArray.last_event>last_event</a></code></td> <td> <code><span title=numpy.float>float</span></code> </td> <td> <div class=doc-md-description> <p>The time of the very last event, across all series.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 375</span>
<span class=normal> 376</span>
<span class=normal> 377</span>
<span class=normal> 378</span>
<span class=normal> 379</span>
<span class=normal> 380</span>
<span class=normal> 381</span>
<span class=normal> 382</span>
<span class=normal> 383</span>
<span class=normal> 384</span>
<span class=normal> 385</span>
<span class=normal> 386</span>
<span class=normal> 387</span>
<span class=normal> 388</span>
<span class=normal> 389</span>
<span class=normal> 390</span>
<span class=normal> 391</span>
<span class=normal> 392</span>
<span class=normal> 393</span>
<span class=normal> 394</span>
<span class=normal> 395</span>
<span class=normal> 396</span>
<span class=normal> 397</span>
<span class=normal> 398</span>
<span class=normal> 399</span>
<span class=normal> 400</span>
<span class=normal> 401</span>
<span class=normal> 402</span>
<span class=normal> 403</span>
<span class=normal> 404</span>
<span class=normal> 405</span>
<span class=normal> 406</span>
<span class=normal> 407</span>
<span class=normal> 408</span>
<span class=normal> 409</span>
<span class=normal> 410</span>
<span class=normal> 411</span>
<span class=normal> 412</span>
<span class=normal> 413</span>
<span class=normal> 414</span>
<span class=normal> 415</span>
<span class=normal> 416</span>
<span class=normal> 417</span>
<span class=normal> 418</span>
<span class=normal> 419</span>
<span class=normal> 420</span>
<span class=normal> 421</span>
<span class=normal> 422</span>
<span class=normal> 423</span>
<span class=normal> 424</span>
<span class=normal> 425</span>
<span class=normal> 426</span>
<span class=normal> 427</span>
<span class=normal> 428</span>
<span class=normal> 429</span>
<span class=normal> 430</span>
<span class=normal> 431</span>
<span class=normal> 432</span>
<span class=normal> 433</span>
<span class=normal> 434</span>
<span class=normal> 435</span>
<span class=normal> 436</span>
<span class=normal> 437</span>
<span class=normal> 438</span>
<span class=normal> 439</span>
<span class=normal> 440</span>
<span class=normal> 441</span>
<span class=normal> 442</span>
<span class=normal> 443</span>
<span class=normal> 444</span>
<span class=normal> 445</span>
<span class=normal> 446</span>
<span class=normal> 447</span>
<span class=normal> 448</span>
<span class=normal> 449</span>
<span class=normal> 450</span>
<span class=normal> 451</span>
<span class=normal> 452</span>
<span class=normal> 453</span>
<span class=normal> 454</span>
<span class=normal> 455</span>
<span class=normal> 456</span>
<span class=normal> 457</span>
<span class=normal> 458</span>
<span class=normal> 459</span>
<span class=normal> 460</span>
<span class=normal> 461</span>
<span class=normal> 462</span>
<span class=normal> 463</span>
<span class=normal> 464</span>
<span class=normal> 465</span>
<span class=normal> 466</span>
<span class=normal> 467</span>
<span class=normal> 468</span>
<span class=normal> 469</span>
<span class=normal> 470</span>
<span class=normal> 471</span>
<span class=normal> 472</span>
<span class=normal> 473</span>
<span class=normal> 474</span>
<span class=normal> 475</span>
<span class=normal> 476</span>
<span class=normal> 477</span>
<span class=normal> 478</span>
<span class=normal> 479</span>
<span class=normal> 480</span>
<span class=normal> 481</span>
<span class=normal> 482</span>
<span class=normal> 483</span>
<span class=normal> 484</span>
<span class=normal> 485</span>
<span class=normal> 486</span>
<span class=normal> 487</span>
<span class=normal> 488</span>
<span class=normal> 489</span>
<span class=normal> 490</span>
<span class=normal> 491</span>
<span class=normal> 492</span>
<span class=normal> 493</span>
<span class=normal> 494</span>
<span class=normal> 495</span>
<span class=normal> 496</span>
<span class=normal> 497</span>
<span class=normal> 498</span>
<span class=normal> 499</span>
<span class=normal> 500</span>
<span class=normal> 501</span>
<span class=normal> 502</span>
<span class=normal> 503</span>
<span class=normal> 504</span>
<span class=normal> 505</span>
<span class=normal> 506</span>
<span class=normal> 507</span>
<span class=normal> 508</span>
<span class=normal> 509</span>
<span class=normal> 510</span>
<span class=normal> 511</span>
<span class=normal> 512</span>
<span class=normal> 513</span>
<span class=normal> 514</span>
<span class=normal> 515</span>
<span class=normal> 516</span>
<span class=normal> 517</span>
<span class=normal> 518</span>
<span class=normal> 519</span>
<span class=normal> 520</span>
<span class=normal> 521</span>
<span class=normal> 522</span>
<span class=normal> 523</span>
<span class=normal> 524</span>
<span class=normal> 525</span>
<span class=normal> 526</span>
<span class=normal> 527</span>
<span class=normal> 528</span>
<span class=normal> 529</span>
<span class=normal> 530</span>
<span class=normal> 531</span>
<span class=normal> 532</span>
<span class=normal> 533</span>
<span class=normal> 534</span>
<span class=normal> 535</span>
<span class=normal> 536</span>
<span class=normal> 537</span>
<span class=normal> 538</span>
<span class=normal> 539</span>
<span class=normal> 540</span>
<span class=normal> 541</span>
<span class=normal> 542</span>
<span class=normal> 543</span>
<span class=normal> 544</span>
<span class=normal> 545</span>
<span class=normal> 546</span>
<span class=normal> 547</span>
<span class=normal> 548</span>
<span class=normal> 549</span>
<span class=normal> 550</span>
<span class=normal> 551</span>
<span class=normal> 552</span>
<span class=normal> 553</span>
<span class=normal> 554</span>
<span class=normal> 555</span>
<span class=normal> 556</span>
<span class=normal> 557</span>
<span class=normal> 558</span>
<span class=normal> 559</span>
<span class=normal> 560</span>
<span class=normal> 561</span>
<span class=normal> 562</span>
<span class=normal> 563</span>
<span class=normal> 564</span>
<span class=normal> 565</span>
<span class=normal> 566</span>
<span class=normal> 567</span>
<span class=normal> 568</span>
<span class=normal> 569</span>
<span class=normal> 570</span>
<span class=normal> 571</span>
<span class=normal> 572</span>
<span class=normal> 573</span>
<span class=normal> 574</span>
<span class=normal> 575</span>
<span class=normal> 576</span>
<span class=normal> 577</span>
<span class=normal> 578</span>
<span class=normal> 579</span>
<span class=normal> 580</span>
<span class=normal> 581</span>
<span class=normal> 582</span>
<span class=normal> 583</span>
<span class=normal> 584</span>
<span class=normal> 585</span>
<span class=normal> 586</span>
<span class=normal> 587</span>
<span class=normal> 588</span>
<span class=normal> 589</span>
<span class=normal> 590</span>
<span class=normal> 591</span>
<span class=normal> 592</span>
<span class=normal> 593</span>
<span class=normal> 594</span>
<span class=normal> 595</span>
<span class=normal> 596</span>
<span class=normal> 597</span>
<span class=normal> 598</span>
<span class=normal> 599</span>
<span class=normal> 600</span>
<span class=normal> 601</span>
<span class=normal> 602</span>
<span class=normal> 603</span>
<span class=normal> 604</span>
<span class=normal> 605</span>
<span class=normal> 606</span>
<span class=normal> 607</span>
<span class=normal> 608</span>
<span class=normal> 609</span>
<span class=normal> 610</span>
<span class=normal> 611</span>
<span class=normal> 612</span>
<span class=normal> 613</span>
<span class=normal> 614</span>
<span class=normal> 615</span>
<span class=normal> 616</span>
<span class=normal> 617</span>
<span class=normal> 618</span>
<span class=normal> 619</span>
<span class=normal> 620</span>
<span class=normal> 621</span>
<span class=normal> 622</span>
<span class=normal> 623</span>
<span class=normal> 624</span>
<span class=normal> 625</span>
<span class=normal> 626</span>
<span class=normal> 627</span>
<span class=normal> 628</span>
<span class=normal> 629</span>
<span class=normal> 630</span>
<span class=normal> 631</span>
<span class=normal> 632</span>
<span class=normal> 633</span>
<span class=normal> 634</span>
<span class=normal> 635</span>
<span class=normal> 636</span>
<span class=normal> 637</span>
<span class=normal> 638</span>
<span class=normal> 639</span>
<span class=normal> 640</span>
<span class=normal> 641</span>
<span class=normal> 642</span>
<span class=normal> 643</span>
<span class=normal> 644</span>
<span class=normal> 645</span>
<span class=normal> 646</span>
<span class=normal> 647</span>
<span class=normal> 648</span>
<span class=normal> 649</span>
<span class=normal> 650</span>
<span class=normal> 651</span>
<span class=normal> 652</span>
<span class=normal> 653</span>
<span class=normal> 654</span>
<span class=normal> 655</span>
<span class=normal> 656</span>
<span class=normal> 657</span>
<span class=normal> 658</span>
<span class=normal> 659</span>
<span class=normal> 660</span>
<span class=normal> 661</span>
<span class=normal> 662</span>
<span class=normal> 663</span>
<span class=normal> 664</span>
<span class=normal> 665</span>
<span class=normal> 666</span>
<span class=normal> 667</span>
<span class=normal> 668</span>
<span class=normal> 669</span>
<span class=normal> 670</span>
<span class=normal> 671</span>
<span class=normal> 672</span>
<span class=normal> 673</span>
<span class=normal> 674</span>
<span class=normal> 675</span>
<span class=normal> 676</span>
<span class=normal> 677</span>
<span class=normal> 678</span>
<span class=normal> 679</span>
<span class=normal> 680</span>
<span class=normal> 681</span>
<span class=normal> 682</span>
<span class=normal> 683</span>
<span class=normal> 684</span>
<span class=normal> 685</span>
<span class=normal> 686</span>
<span class=normal> 687</span>
<span class=normal> 688</span>
<span class=normal> 689</span>
<span class=normal> 690</span>
<span class=normal> 691</span>
<span class=normal> 692</span>
<span class=normal> 693</span>
<span class=normal> 694</span>
<span class=normal> 695</span>
<span class=normal> 696</span>
<span class=normal> 697</span>
<span class=normal> 698</span>
<span class=normal> 699</span>
<span class=normal> 700</span>
<span class=normal> 701</span>
<span class=normal> 702</span>
<span class=normal> 703</span>
<span class=normal> 704</span>
<span class=normal> 705</span>
<span class=normal> 706</span>
<span class=normal> 707</span>
<span class=normal> 708</span>
<span class=normal> 709</span>
<span class=normal> 710</span>
<span class=normal> 711</span>
<span class=normal> 712</span>
<span class=normal> 713</span>
<span class=normal> 714</span>
<span class=normal> 715</span>
<span class=normal> 716</span>
<span class=normal> 717</span>
<span class=normal> 718</span>
<span class=normal> 719</span>
<span class=normal> 720</span>
<span class=normal> 721</span>
<span class=normal> 722</span>
<span class=normal> 723</span>
<span class=normal> 724</span>
<span class=normal> 725</span>
<span class=normal> 726</span>
<span class=normal> 727</span>
<span class=normal> 728</span>
<span class=normal> 729</span>
<span class=normal> 730</span>
<span class=normal> 731</span>
<span class=normal> 732</span>
<span class=normal> 733</span>
<span class=normal> 734</span>
<span class=normal> 735</span>
<span class=normal> 736</span>
<span class=normal> 737</span>
<span class=normal> 738</span>
<span class=normal> 739</span>
<span class=normal> 740</span>
<span class=normal> 741</span>
<span class=normal> 742</span>
<span class=normal> 743</span>
<span class=normal> 744</span>
<span class=normal> 745</span>
<span class=normal> 746</span>
<span class=normal> 747</span>
<span class=normal> 748</span>
<span class=normal> 749</span>
<span class=normal> 750</span>
<span class=normal> 751</span>
<span class=normal> 752</span>
<span class=normal> 753</span>
<span class=normal> 754</span>
<span class=normal> 755</span>
<span class=normal> 756</span>
<span class=normal> 757</span>
<span class=normal> 758</span>
<span class=normal> 759</span>
<span class=normal> 760</span>
<span class=normal> 761</span>
<span class=normal> 762</span>
<span class=normal> 763</span>
<span class=normal> 764</span>
<span class=normal> 765</span>
<span class=normal> 766</span>
<span class=normal> 767</span>
<span class=normal> 768</span>
<span class=normal> 769</span>
<span class=normal> 770</span>
<span class=normal> 771</span>
<span class=normal> 772</span>
<span class=normal> 773</span>
<span class=normal> 774</span>
<span class=normal> 775</span>
<span class=normal> 776</span>
<span class=normal> 777</span>
<span class=normal> 778</span>
<span class=normal> 779</span>
<span class=normal> 780</span>
<span class=normal> 781</span>
<span class=normal> 782</span>
<span class=normal> 783</span>
<span class=normal> 784</span>
<span class=normal> 785</span>
<span class=normal> 786</span>
<span class=normal> 787</span>
<span class=normal> 788</span>
<span class=normal> 789</span>
<span class=normal> 790</span>
<span class=normal> 791</span>
<span class=normal> 792</span>
<span class=normal> 793</span>
<span class=normal> 794</span>
<span class=normal> 795</span>
<span class=normal> 796</span>
<span class=normal> 797</span>
<span class=normal> 798</span>
<span class=normal> 799</span>
<span class=normal> 800</span>
<span class=normal> 801</span>
<span class=normal> 802</span>
<span class=normal> 803</span>
<span class=normal> 804</span>
<span class=normal> 805</span>
<span class=normal> 806</span>
<span class=normal> 807</span>
<span class=normal> 808</span>
<span class=normal> 809</span>
<span class=normal> 810</span>
<span class=normal> 811</span>
<span class=normal> 812</span>
<span class=normal> 813</span>
<span class=normal> 814</span>
<span class=normal> 815</span>
<span class=normal> 816</span>
<span class=normal> 817</span>
<span class=normal> 818</span>
<span class=normal> 819</span>
<span class=normal> 820</span>
<span class=normal> 821</span>
<span class=normal> 822</span>
<span class=normal> 823</span>
<span class=normal> 824</span>
<span class=normal> 825</span>
<span class=normal> 826</span>
<span class=normal> 827</span>
<span class=normal> 828</span>
<span class=normal> 829</span>
<span class=normal> 830</span>
<span class=normal> 831</span>
<span class=normal> 832</span>
<span class=normal> 833</span>
<span class=normal> 834</span>
<span class=normal> 835</span>
<span class=normal> 836</span>
<span class=normal> 837</span>
<span class=normal> 838</span>
<span class=normal> 839</span>
<span class=normal> 840</span>
<span class=normal> 841</span>
<span class=normal> 842</span>
<span class=normal> 843</span>
<span class=normal> 844</span>
<span class=normal> 845</span>
<span class=normal> 846</span>
<span class=normal> 847</span>
<span class=normal> 848</span>
<span class=normal> 849</span>
<span class=normal> 850</span>
<span class=normal> 851</span>
<span class=normal> 852</span>
<span class=normal> 853</span>
<span class=normal> 854</span>
<span class=normal> 855</span>
<span class=normal> 856</span>
<span class=normal> 857</span>
<span class=normal> 858</span>
<span class=normal> 859</span>
<span class=normal> 860</span>
<span class=normal> 861</span>
<span class=normal> 862</span>
<span class=normal> 863</span>
<span class=normal> 864</span>
<span class=normal> 865</span>
<span class=normal> 866</span>
<span class=normal> 867</span>
<span class=normal> 868</span>
<span class=normal> 869</span>
<span class=normal> 870</span>
<span class=normal> 871</span>
<span class=normal> 872</span>
<span class=normal> 873</span>
<span class=normal> 874</span>
<span class=normal> 875</span>
<span class=normal> 876</span>
<span class=normal> 877</span>
<span class=normal> 878</span>
<span class=normal> 879</span>
<span class=normal> 880</span>
<span class=normal> 881</span>
<span class=normal> 882</span>
<span class=normal> 883</span>
<span class=normal> 884</span>
<span class=normal> 885</span>
<span class=normal> 886</span>
<span class=normal> 887</span>
<span class=normal> 888</span>
<span class=normal> 889</span>
<span class=normal> 890</span>
<span class=normal> 891</span>
<span class=normal> 892</span>
<span class=normal> 893</span>
<span class=normal> 894</span>
<span class=normal> 895</span>
<span class=normal> 896</span>
<span class=normal> 897</span>
<span class=normal> 898</span>
<span class=normal> 899</span>
<span class=normal> 900</span>
<span class=normal> 901</span>
<span class=normal> 902</span>
<span class=normal> 903</span>
<span class=normal> 904</span>
<span class=normal> 905</span>
<span class=normal> 906</span>
<span class=normal> 907</span>
<span class=normal> 908</span>
<span class=normal> 909</span>
<span class=normal> 910</span>
<span class=normal> 911</span>
<span class=normal> 912</span>
<span class=normal> 913</span>
<span class=normal> 914</span>
<span class=normal> 915</span>
<span class=normal> 916</span>
<span class=normal> 917</span>
<span class=normal> 918</span>
<span class=normal> 919</span>
<span class=normal> 920</span>
<span class=normal> 921</span>
<span class=normal> 922</span>
<span class=normal> 923</span>
<span class=normal> 924</span>
<span class=normal> 925</span>
<span class=normal> 926</span>
<span class=normal> 927</span>
<span class=normal> 928</span>
<span class=normal> 929</span>
<span class=normal> 930</span>
<span class=normal> 931</span>
<span class=normal> 932</span>
<span class=normal> 933</span>
<span class=normal> 934</span>
<span class=normal> 935</span>
<span class=normal> 936</span>
<span class=normal> 937</span>
<span class=normal> 938</span>
<span class=normal> 939</span>
<span class=normal> 940</span>
<span class=normal> 941</span>
<span class=normal> 942</span>
<span class=normal> 943</span>
<span class=normal> 944</span>
<span class=normal> 945</span>
<span class=normal> 946</span>
<span class=normal> 947</span>
<span class=normal> 948</span>
<span class=normal> 949</span>
<span class=normal> 950</span>
<span class=normal> 951</span>
<span class=normal> 952</span>
<span class=normal> 953</span>
<span class=normal> 954</span>
<span class=normal> 955</span>
<span class=normal> 956</span>
<span class=normal> 957</span>
<span class=normal> 958</span>
<span class=normal> 959</span>
<span class=normal> 960</span>
<span class=normal> 961</span>
<span class=normal> 962</span>
<span class=normal> 963</span>
<span class=normal> 964</span>
<span class=normal> 965</span>
<span class=normal> 966</span>
<span class=normal> 967</span>
<span class=normal> 968</span>
<span class=normal> 969</span>
<span class=normal> 970</span>
<span class=normal> 971</span>
<span class=normal> 972</span>
<span class=normal> 973</span>
<span class=normal> 974</span>
<span class=normal> 975</span>
<span class=normal> 976</span>
<span class=normal> 977</span>
<span class=normal> 978</span>
<span class=normal> 979</span>
<span class=normal> 980</span>
<span class=normal> 981</span>
<span class=normal> 982</span>
<span class=normal> 983</span>
<span class=normal> 984</span>
<span class=normal> 985</span>
<span class=normal> 986</span>
<span class=normal> 987</span>
<span class=normal> 988</span>
<span class=normal> 989</span>
<span class=normal> 990</span>
<span class=normal> 991</span>
<span class=normal> 992</span>
<span class=normal> 993</span>
<span class=normal> 994</span>
<span class=normal> 995</span>
<span class=normal> 996</span>
<span class=normal> 997</span>
<span class=normal> 998</span>
<span class=normal> 999</span>
<span class=normal>1000</span>
<span class=normal>1001</span>
<span class=normal>1002</span>
<span class=normal>1003</span>
<span class=normal>1004</span>
<span class=normal>1005</span>
<span class=normal>1006</span>
<span class=normal>1007</span>
<span class=normal>1008</span>
<span class=normal>1009</span>
<span class=normal>1010</span>
<span class=normal>1011</span>
<span class=normal>1012</span>
<span class=normal>1013</span>
<span class=normal>1014</span>
<span class=normal>1015</span>
<span class=normal>1016</span>
<span class=normal>1017</span>
<span class=normal>1018</span>
<span class=normal>1019</span>
<span class=normal>1020</span>
<span class=normal>1021</span>
<span class=normal>1022</span>
<span class=normal>1023</span>
<span class=normal>1024</span>
<span class=normal>1025</span>
<span class=normal>1026</span>
<span class=normal>1027</span>
<span class=normal>1028</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>EventArray</span><span class=p>(</span><span class=n>BaseEventArray</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;A multiseries eventarray with shared support.</span>

<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    abscissa_vals : array of np.array(dtype=np.float64) event datas in seconds.</span>
<span class=sd>        Array of length n_series, each entry with shape (n_data,).</span>
<span class=sd>    fs : float, optional</span>
<span class=sd>        Sampling rate in Hz. Default is 30,000.</span>
<span class=sd>    support : IntervalArray, optional</span>
<span class=sd>        IntervalArray on which eventarrays are defined.</span>
<span class=sd>        Default is [0, last event] inclusive.</span>
<span class=sd>    series_ids : list of int, optional</span>
<span class=sd>        Unit IDs.</span>
<span class=sd>    series_labels : list of str, optional</span>
<span class=sd>        Labels corresponding to series. Default casts series_ids to str.</span>
<span class=sd>    series_tags : optional</span>
<span class=sd>        Tags correponding to series.</span>
<span class=sd>        NOTE: Currently we do not do any input validation so these can</span>
<span class=sd>        be any type. We also don&#39;t use these for anything yet.</span>
<span class=sd>    label : str or None, optional</span>
<span class=sd>        Information pertaining to the source of the eventarray.</span>
<span class=sd>    empty : bool, optional</span>
<span class=sd>        Whether an empty EventArray should be constructed (no data).</span>
<span class=sd>    assume_sorted : boolean, optional</span>
<span class=sd>        Whether the abscissa values should be treated as sorted (non-decreasing)</span>
<span class=sd>        or not. Significant overhead during RSASA object creation can be removed</span>
<span class=sd>        if this is True, but note that unsorted abscissa values will mess</span>
<span class=sd>        everything up.</span>
<span class=sd>        Default is False</span>
<span class=sd>    kwargs : optional</span>
<span class=sd>        Additional keyword arguments to forward along to the BaseEventArray</span>
<span class=sd>        constructor.</span>

<span class=sd>    Attributes</span>
<span class=sd>    ----------</span>
<span class=sd>    Note : Read the docstring for the BaseEventArray superclass for additional</span>
<span class=sd>    attributes that are defined there.</span>
<span class=sd>    isempty : bool</span>
<span class=sd>        Whether the EventArray is empty (no data).</span>
<span class=sd>    n_series : int</span>
<span class=sd>        The number of series.</span>
<span class=sd>    n_active : int</span>
<span class=sd>        The number of active series. A series is considered active if</span>
<span class=sd>        it fired at least one event.</span>
<span class=sd>    data : array of np.array(dtype=np.float64) event datas in seconds.</span>
<span class=sd>        Array of length n_series, each entry with shape (n_data,).</span>
<span class=sd>    n_events : np.ndarray</span>
<span class=sd>        The number of events in each series.</span>
<span class=sd>    issorted : bool</span>
<span class=sd>        Whether the data are sorted.</span>
<span class=sd>    first_event : np.float</span>
<span class=sd>        The time of the very first event, across all series.</span>
<span class=sd>    last_event : np.float</span>
<span class=sd>        The time of the very last event, across all series.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>__attributes__</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;_data&quot;</span><span class=p>]</span>
    <span class=n>__attributes__</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>BaseEventArray</span><span class=o>.</span><span class=n>__attributes__</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>abscissa_vals</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=o>*</span><span class=p>,</span>
        <span class=n>fs</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>support</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>series_ids</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>series_labels</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>series_tags</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>label</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>empty</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
        <span class=n>assume_sorted</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
    <span class=p>):</span>
        <span class=k>if</span> <span class=n>assume_sorted</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>assume_sorted</span> <span class=o>=</span> <span class=kc>False</span>

        <span class=c1># if an empty object is requested, return it:</span>
        <span class=k>if</span> <span class=n>empty</span><span class=p>:</span>
            <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>empty</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
            <span class=k>for</span> <span class=n>attr</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>__attributes__</span><span class=p>:</span>
                <span class=n>exec</span><span class=p>(</span><span class=s2>&quot;self.&quot;</span> <span class=o>+</span> <span class=n>attr</span> <span class=o>+</span> <span class=s2>&quot; = None&quot;</span><span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)(</span><span class=n>empty</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
            <span class=k>return</span>

        <span class=c1># set default sampling rate</span>
        <span class=k>if</span> <span class=n>fs</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>fs</span> <span class=o>=</span> <span class=mi>30000</span>
            <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
                <span class=s2>&quot;No sampling rate was specified! Assuming default of </span><span class=si>{}</span><span class=s2> Hz.&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>fs</span><span class=p>)</span>
            <span class=p>)</span>

        <span class=k>def</span><span class=w> </span><span class=nf>is_singletons</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
<span class=w>            </span><span class=sd>&quot;&quot;&quot;Returns True if data is a list of singletons (more than one).&quot;&quot;&quot;</span>
            <span class=n>data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>object</span><span class=p>)</span>
            <span class=k>try</span><span class=p>:</span>
                <span class=k>if</span> <span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>2</span> <span class=ow>and</span> <span class=n>np</span><span class=o>.</span><span class=n>max</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
                    <span class=k>return</span> <span class=kc>True</span>
                <span class=k>if</span> <span class=nb>max</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>data</span><span class=p>)</span><span class=o>.</span><span class=n>shape</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span> <span class=o>&gt;</span> <span class=mi>1</span> <span class=ow>and</span> <span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
                    <span class=k>return</span> <span class=kc>True</span>
            <span class=k>except</span> <span class=p>(</span><span class=ne>IndexError</span><span class=p>,</span> <span class=ne>TypeError</span><span class=p>,</span> <span class=ne>ValueError</span><span class=p>):</span>
                <span class=k>return</span> <span class=kc>False</span>
            <span class=k>return</span> <span class=kc>False</span>

        <span class=k>def</span><span class=w> </span><span class=nf>is_single_series</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
<span class=w>            </span><span class=sd>&quot;&quot;&quot;Returns True if data represents event datas from a single series.</span>

<span class=sd>            Examples</span>
<span class=sd>            --------</span>
<span class=sd>            [1, 2, 3]           : True</span>
<span class=sd>            [[1, 2, 3]]         : True</span>
<span class=sd>            [[1, 2, 3], []]     : False</span>
<span class=sd>            [[], [], []]        : False</span>
<span class=sd>            [[[[1, 2, 3]]]]     : True</span>
<span class=sd>            [[[[[1],[2],[3]]]]] : False</span>
<span class=sd>            &quot;&quot;&quot;</span>
            <span class=k>try</span><span class=p>:</span>
                <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>],</span> <span class=nb>list</span><span class=p>)</span> <span class=ow>or</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>],</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>):</span>
                    <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;event datas input has too many layers!&quot;</span><span class=p>)</span>
                    <span class=k>try</span><span class=p>:</span>
                        <span class=k>if</span> <span class=nb>max</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>data</span><span class=p>)</span><span class=o>.</span><span class=n>shape</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
                            <span class=c1>#                 singletons = True</span>
                            <span class=k>return</span> <span class=kc>False</span>
                    <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
                        <span class=k>return</span> <span class=kc>False</span>
                    <span class=n>data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>squeeze</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
            <span class=k>except</span> <span class=p>(</span><span class=ne>IndexError</span><span class=p>,</span> <span class=ne>TypeError</span><span class=p>):</span>
                <span class=k>pass</span>
            <span class=k>try</span><span class=p>:</span>
                <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=nb>list</span><span class=p>)</span> <span class=ow>or</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>):</span>
                    <span class=k>return</span> <span class=kc>False</span>
            <span class=k>except</span> <span class=p>(</span><span class=ne>IndexError</span><span class=p>,</span> <span class=ne>TypeError</span><span class=p>):</span>
                <span class=k>pass</span>
            <span class=k>return</span> <span class=kc>True</span>

        <span class=k>def</span><span class=w> </span><span class=nf>standardize_to_2d</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
            <span class=k>if</span> <span class=n>is_single_series</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
                <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>squeeze</span><span class=p>(</span><span class=n>data</span><span class=p>),</span> <span class=n>ndmin</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>is_singletons</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
                <span class=n>data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>squeeze</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
                <span class=n>n</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>max</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
                <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
                    <span class=n>m</span> <span class=o>=</span> <span class=mi>1</span>
                <span class=k>else</span><span class=p>:</span>
                    <span class=n>m</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>min</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
                <span class=n>data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>m</span><span class=p>))</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>squeeze</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
                <span class=k>if</span> <span class=n>data</span><span class=o>.</span><span class=n>dtype</span> <span class=o>==</span> <span class=n>np</span><span class=o>.</span><span class=n>dtype</span><span class=p>(</span><span class=s2>&quot;O&quot;</span><span class=p>):</span>
                    <span class=n>jagged</span> <span class=o>=</span> <span class=kc>True</span>
                <span class=k>else</span><span class=p>:</span>
                    <span class=n>jagged</span> <span class=o>=</span> <span class=kc>False</span>
                <span class=k>if</span> <span class=n>jagged</span><span class=p>:</span>  <span class=c1># jagged array</span>
                    <span class=c1># standardize input so that a list of lists is converted</span>
                    <span class=c1># to an array of arrays:</span>
                    <span class=n>data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>np</span><span class=o>.</span><span class=n>asarray</span><span class=p>(</span><span class=n>st</span><span class=p>)</span> <span class=k>for</span> <span class=n>st</span> <span class=ow>in</span> <span class=n>data</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>object</span><span class=p>)</span>
                <span class=k>else</span><span class=p>:</span>
                    <span class=n>data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>ndmin</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
            <span class=k>return</span> <span class=n>data</span>

        <span class=c1># standardize input data to 2D array</span>
        <span class=n>data</span> <span class=o>=</span> <span class=n>standardize_to_2d</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>abscissa_vals</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>object</span><span class=p>))</span>

        <span class=c1># If user said to assume the absicssa vals are sorted but they actually</span>
        <span class=c1># aren&#39;t, then the mistake will get propagated down. The responsibility</span>
        <span class=c1># therefore lies on the user whenever he/she uses assume_sorted=True</span>
        <span class=c1># as a constructor argument</span>
        <span class=k>for</span> <span class=n>ii</span><span class=p>,</span> <span class=n>train</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>assume_sorted</span><span class=p>:</span>
                <span class=c1># sort event series, but only if necessary</span>
                <span class=k>if</span> <span class=ow>not</span> <span class=n>utils</span><span class=o>.</span><span class=n>is_sorted</span><span class=p>(</span><span class=n>train</span><span class=p>):</span>
                    <span class=n>data</span><span class=p>[</span><span class=n>ii</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span><span class=n>train</span><span class=p>)</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>data</span><span class=p>[</span><span class=n>ii</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span><span class=n>train</span><span class=p>)</span>

        <span class=n>kwargs</span><span class=p>[</span><span class=s2>&quot;fs&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>fs</span>
        <span class=n>kwargs</span><span class=p>[</span><span class=s2>&quot;series_ids&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>series_ids</span>
        <span class=n>kwargs</span><span class=p>[</span><span class=s2>&quot;series_labels&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>series_labels</span>
        <span class=n>kwargs</span><span class=p>[</span><span class=s2>&quot;series_tags&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>series_tags</span>
        <span class=n>kwargs</span><span class=p>[</span><span class=s2>&quot;label&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>label</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>data</span>  <span class=c1># this is necessary so that</span>
        <span class=c1># super() can determine self.n_series when initializing.</span>

        <span class=c1># initialize super so that self.fs is set:</span>
        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>

        <span class=c1># print(self.type_name, kwargs)</span>

        <span class=c1># if only empty data were received AND no support, attach an</span>
        <span class=c1># empty support:</span>
        <span class=k>if</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>([</span><span class=n>st</span><span class=o>.</span><span class=n>size</span> <span class=k>for</span> <span class=n>st</span> <span class=ow>in</span> <span class=n>data</span><span class=p>])</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>support</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;no events; cannot automatically determine support&quot;</span><span class=p>)</span>
            <span class=n>support</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)(</span><span class=n>empty</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

        <span class=c1># determine eventarray support:</span>
        <span class=k>if</span> <span class=n>support</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>first_spk</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nanmin</span><span class=p>(</span>
                <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>series</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=k>for</span> <span class=n>series</span> <span class=ow>in</span> <span class=n>data</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>series</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>])</span>
            <span class=p>)</span>
            <span class=c1># BUG: if eventseries is empty np.array([]) then series[-1]</span>
            <span class=c1># raises an error in the following:</span>
            <span class=c1># FIX: list[-1] raises an IndexError for an empty list,</span>
            <span class=c1># whereas list[-1:] returns an empty list.</span>
            <span class=n>last_spk</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nanmax</span><span class=p>(</span>
                <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>series</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>:]</span> <span class=k>for</span> <span class=n>series</span> <span class=ow>in</span> <span class=n>data</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>series</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>])</span>
            <span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)(</span>
                <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>first_spk</span><span class=p>,</span> <span class=n>last_spk</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>/</span> <span class=n>fs</span><span class=p>])</span>
            <span class=p>)</span>
            <span class=c1># in the above, there&#39;s no reason to restrict to support</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=c1># restrict events to only those within the eventseries</span>
            <span class=c1># array&#39;s support:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=n>support</span>

        <span class=c1># TODO: if sorted, we may as well use the fast restrict here as well?</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_restrict_to_interval</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>)</span>

    <span class=nd>@keyword_equivalence</span><span class=p>(</span><span class=n>this_or_that</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;n_intervals&quot;</span><span class=p>:</span> <span class=s2>&quot;n_epochs&quot;</span><span class=p>})</span>
    <span class=k>def</span><span class=w> </span><span class=nf>partition</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ds</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>n_intervals</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Returns a BaseEventArray whose support has been partitioned.</span>

<span class=sd>        Parameters</span>
<span class=sd>        ----------</span>
<span class=sd>        ds : float, optional</span>
<span class=sd>            Maximum duration (in seconds), for each interval.</span>
<span class=sd>        n_points : int, optional</span>
<span class=sd>            Number of intervals. If ds is None and n_intervals is None, then</span>
<span class=sd>            default is to use n_intervals = 100</span>

<span class=sd>        Returns</span>
<span class=sd>        -------</span>
<span class=sd>        out : BaseEventArray</span>
<span class=sd>            BaseEventArray that has been partitioned.</span>

<span class=sd>        Notes</span>
<span class=sd>        -----</span>
<span class=sd>        Irrespective of whether &#39;ds&#39; or &#39;n_intervals&#39; are used, the exact</span>
<span class=sd>        underlying support is propagated, and the first and last points</span>
<span class=sd>        of the supports are always included, even if this would cause</span>
<span class=sd>        n_points or ds to be violated.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
        <span class=n>abscissa</span> <span class=o>=</span> <span class=n>copy</span><span class=o>.</span><span class=n>deepcopy</span><span class=p>(</span><span class=n>out</span><span class=o>.</span><span class=n>_abscissa</span><span class=p>)</span>
        <span class=n>abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=n>abscissa</span><span class=o>.</span><span class=n>support</span><span class=o>.</span><span class=n>partition</span><span class=p>(</span><span class=n>ds</span><span class=o>=</span><span class=n>ds</span><span class=p>,</span> <span class=n>n_intervals</span><span class=o>=</span><span class=n>n_intervals</span><span class=p>)</span>
        <span class=n>out</span><span class=o>.</span><span class=n>_abscissa</span> <span class=o>=</span> <span class=n>abscissa</span>
        <span class=n>out</span><span class=o>.</span><span class=n>__renew__</span><span class=p>()</span>

        <span class=k>return</span> <span class=n>out</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_copy_without_data</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Return a copy of self, without event datas.</span>
<span class=sd>        Note: the support is left unchanged.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>out</span> <span class=o>=</span> <span class=n>copy</span><span class=o>.</span><span class=n>copy</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>  <span class=c1># shallow copy</span>
        <span class=n>out</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>n_series</span> <span class=o>*</span> <span class=p>[</span><span class=kc>None</span><span class=p>])</span>
        <span class=n>out</span> <span class=o>=</span> <span class=n>copy</span><span class=o>.</span><span class=n>deepcopy</span><span class=p>(</span>
            <span class=n>out</span>
        <span class=p>)</span>  <span class=c1># just to be on the safe side, but at least now we are not copying the data!</span>
        <span class=n>out</span><span class=o>.</span><span class=n>__renew__</span><span class=p>()</span>
        <span class=k>return</span> <span class=n>out</span>

    <span class=k>def</span><span class=w> </span><span class=nf>copy</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Returns a copy of the EventArray.&quot;&quot;&quot;</span>
        <span class=n>newcopy</span> <span class=o>=</span> <span class=n>copy</span><span class=o>.</span><span class=n>deepcopy</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>
        <span class=n>newcopy</span><span class=o>.</span><span class=n>__renew__</span><span class=p>()</span>
        <span class=k>return</span> <span class=n>newcopy</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__iter__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;EventArray iterator initialization.&quot;&quot;&quot;</span>
        <span class=c1># initialize the internal index to zero when used as iterator</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_index</span> <span class=o>=</span> <span class=mi>0</span>
        <span class=k>return</span> <span class=bp>self</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__next__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;EventArray iterator advancer.&quot;&quot;&quot;</span>
        <span class=n>index</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_index</span>
        <span class=k>if</span> <span class=n>index</span> <span class=o>&gt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=o>.</span><span class=n>n_intervals</span> <span class=o>-</span> <span class=mi>1</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>StopIteration</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_index</span> <span class=o>+=</span> <span class=mi>1</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>index</span><span class=p>]</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__getitem__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>idx</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;EventArray index access.</span>

<span class=sd>        By default, this method is bound to EventArray.loc</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>isempty</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(bool) Empty EventArray.&quot;&quot;&quot;</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>([</span><span class=nb>len</span><span class=p>(</span><span class=n>st</span><span class=p>)</span> <span class=k>for</span> <span class=n>st</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>])</span> <span class=o>==</span> <span class=mi>0</span>
        <span class=k>except</span> <span class=ne>TypeError</span><span class=p>:</span>
            <span class=k>return</span> <span class=kc>True</span>  <span class=c1># this happens when self.data is None</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>n_series</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(int) The number of series.&quot;&quot;&quot;</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=k>return</span> <span class=n>utils</span><span class=o>.</span><span class=n>PrettyInt</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>))</span>
        <span class=k>except</span> <span class=ne>TypeError</span><span class=p>:</span>
            <span class=k>return</span> <span class=mi>0</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>n_active</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(int) The number of active series.</span>

<span class=sd>        A series is considered active if it fired at least one event.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>isempty</span><span class=p>:</span>
            <span class=k>return</span> <span class=mi>0</span>
        <span class=k>return</span> <span class=n>utils</span><span class=o>.</span><span class=n>PrettyInt</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>count_nonzero</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>n_events</span><span class=p>))</span>

    <span class=k>def</span><span class=w> </span><span class=nf>flatten</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>series_id</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>series_label</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Collapse events across series.</span>

<span class=sd>        WARNING! series_tags are thrown away when flattening.</span>

<span class=sd>        Parameters</span>
<span class=sd>        ----------</span>
<span class=sd>        series_id: (int)</span>
<span class=sd>            (series) ID to assign to flattened event series, default is 0.</span>
<span class=sd>        series_label (str)</span>
<span class=sd>            (series) Label for event series, default is &#39;flattened&#39;.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>n_series</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=p>:</span>  <span class=c1># already flattened</span>
            <span class=k>return</span> <span class=bp>self</span>

        <span class=c1># default args:</span>
        <span class=k>if</span> <span class=n>series_id</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>series_id</span> <span class=o>=</span> <span class=mi>0</span>
        <span class=k>if</span> <span class=n>series_label</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>series_label</span> <span class=o>=</span> <span class=s2>&quot;flattened&quot;</span>

        <span class=n>flattened</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_copy_without_data</span><span class=p>()</span>
        <span class=n>flattened</span><span class=o>.</span><span class=n>_series_ids</span> <span class=o>=</span> <span class=p>[</span><span class=n>series_id</span><span class=p>]</span>
        <span class=n>flattened</span><span class=o>.</span><span class=n>_series_labels</span> <span class=o>=</span> <span class=p>[</span><span class=n>series_label</span><span class=p>]</span>
        <span class=n>flattened</span><span class=o>.</span><span class=n>_series_tags</span> <span class=o>=</span> <span class=kc>None</span>

        <span class=c1># Efficient: concatenate all events, sort once</span>
        <span class=n>all_events</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>)</span>
        <span class=n>all_events</span><span class=o>.</span><span class=n>sort</span><span class=p>()</span>
        <span class=n>flattened</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>all_events</span><span class=p>],</span> <span class=n>ndmin</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
        <span class=n>flattened</span><span class=o>.</span><span class=n>__renew__</span><span class=p>()</span>
        <span class=k>return</span> <span class=n>flattened</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_restrict</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>intervalslice</span><span class=p>,</span> <span class=n>seriesslice</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>subseriesslice</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_restrict_to_series_subset</span><span class=p>(</span><span class=n>seriesslice</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_restrict_to_interval</span><span class=p>(</span><span class=n>intervalslice</span><span class=p>)</span>
        <span class=k>return</span> <span class=bp>self</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_restrict_to_series_subset</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>idx</span><span class=p>):</span>
        <span class=c1># Warning: This function can mutate data</span>

        <span class=c1># TODO: Update tags</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_data</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span>
            <span class=n>singleseries</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_data</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span>
            <span class=k>if</span> <span class=n>singleseries</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_data</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>ndmin</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_series_ids</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>atleast_1d</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>atleast_1d</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_series_ids</span><span class=p>)[</span><span class=n>idx</span><span class=p>]))</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_series_labels</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span>
                <span class=n>np</span><span class=o>.</span><span class=n>atleast_1d</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>atleast_1d</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_series_labels</span><span class=p>)[</span><span class=n>idx</span><span class=p>])</span>
            <span class=p>)</span>
        <span class=k>except</span> <span class=ne>AttributeError</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_data</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span>
            <span class=n>singleseries</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_data</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span>
            <span class=k>if</span> <span class=n>singleseries</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_data</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>ndmin</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_series_ids</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>atleast_1d</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>atleast_1d</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_series_ids</span><span class=p>)[</span><span class=n>idx</span><span class=p>]))</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_series_labels</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span>
                <span class=n>np</span><span class=o>.</span><span class=n>atleast_1d</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>atleast_1d</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_series_labels</span><span class=p>)[</span><span class=n>idx</span><span class=p>])</span>
            <span class=p>)</span>
        <span class=k>except</span> <span class=ne>IndexError</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>IndexError</span><span class=p>(</span>
                <span class=s2>&quot;One of more indices were out of bounds for n_series with size </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                    <span class=bp>self</span><span class=o>.</span><span class=n>n_series</span>
                <span class=p>)</span>
            <span class=p>)</span>
        <span class=k>except</span> <span class=ne>Exception</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s2>&quot;Unsupported indexing type </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=n>idx</span><span class=p>)))</span>

        <span class=k>return</span> <span class=bp>self</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_restrict_to_interval</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>intervalslice</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Return data restricted to an intervalarray.</span>

<span class=sd>        This function assumes sorted event datas, so that binary search can</span>
<span class=sd>        be used to quickly identify slices that should be kept in the</span>
<span class=sd>        restriction. It does not check every event data.</span>

<span class=sd>        Parameters</span>
<span class=sd>        ----------</span>
<span class=sd>        intervalarray : nelpy.IntervalArray</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=c1># Warning: this function can mutate data</span>
        <span class=c1># This should be called from _restrict only. That&#39;s where</span>
        <span class=c1># intervalarray is first checked against the support.</span>
        <span class=c1># This function assumes that has happened already, so</span>
        <span class=c1># every point in intervalarray is also in the support</span>

        <span class=c1># NOTE: this used to assume multiple series for the enumeration to work</span>

        <span class=k>if</span> <span class=n>data</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_data</span>

        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>intervalslice</span><span class=p>,</span> <span class=nb>slice</span><span class=p>):</span>
            <span class=k>if</span> <span class=p>(</span>
                <span class=n>intervalslice</span><span class=o>.</span><span class=n>start</span> <span class=ow>is</span> <span class=kc>None</span>
                <span class=ow>and</span> <span class=n>intervalslice</span><span class=o>.</span><span class=n>stop</span> <span class=ow>is</span> <span class=kc>None</span>
                <span class=ow>and</span> <span class=n>intervalslice</span><span class=o>.</span><span class=n>step</span> <span class=ow>is</span> <span class=kc>None</span>
            <span class=p>):</span>
                <span class=c1># no restriction on interval</span>
                <span class=k>return</span> <span class=bp>self</span>

        <span class=n>newintervals</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>[</span><span class=n>intervalslice</span><span class=p>]</span><span class=o>.</span><span class=n>merge</span><span class=p>()</span>
        <span class=k>if</span> <span class=n>newintervals</span><span class=o>.</span><span class=n>isempty</span><span class=p>:</span>
            <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;Index resulted in empty interval array&quot;</span><span class=p>)</span>
            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>empty</span><span class=p>(</span><span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

        <span class=n>issue_warning</span> <span class=o>=</span> <span class=kc>False</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>isempty</span><span class=p>:</span>
            <span class=k>for</span> <span class=n>series</span><span class=p>,</span> <span class=n>evt_data</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
                <span class=n>indices</span> <span class=o>=</span> <span class=p>[]</span>
                <span class=k>for</span> <span class=n>epdata</span> <span class=ow>in</span> <span class=n>newintervals</span><span class=o>.</span><span class=n>data</span><span class=p>:</span>
                    <span class=n>t_start</span> <span class=o>=</span> <span class=n>epdata</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
                    <span class=n>t_stop</span> <span class=o>=</span> <span class=n>epdata</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
                    <span class=n>frm</span><span class=p>,</span> <span class=n>to</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>searchsorted</span><span class=p>(</span><span class=n>evt_data</span><span class=p>,</span> <span class=p>(</span><span class=n>t_start</span><span class=p>,</span> <span class=n>t_stop</span><span class=p>))</span>
                    <span class=n>indices</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>frm</span><span class=p>,</span> <span class=n>to</span><span class=p>))</span>
                <span class=n>indices</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>indices</span><span class=p>,</span> <span class=n>ndmin</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
                <span class=k>if</span> <span class=n>np</span><span class=o>.</span><span class=n>diff</span><span class=p>(</span><span class=n>indices</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>evt_data</span><span class=p>):</span>
                    <span class=n>issue_warning</span> <span class=o>=</span> <span class=kc>True</span>
                <span class=n>singleseries</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_data</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span>
                <span class=k>if</span> <span class=n>singleseries</span><span class=p>:</span>
                    <span class=n>data_list</span> <span class=o>=</span> <span class=p>[]</span>
                    <span class=k>for</span> <span class=n>start</span><span class=p>,</span> <span class=n>stop</span> <span class=ow>in</span> <span class=n>indices</span><span class=p>:</span>
                        <span class=n>data_list</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>evt_data</span><span class=p>[</span><span class=n>start</span><span class=p>:</span><span class=n>stop</span><span class=p>])</span>
                    <span class=n>data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>data_list</span><span class=p>,</span> <span class=n>ndmin</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
                <span class=k>else</span><span class=p>:</span>
                    <span class=c1># here we have to do some annoying conversion between</span>
                    <span class=c1># arrays and lists to fully support jagged array</span>
                    <span class=c1># mutation</span>
                    <span class=n>data_list</span> <span class=o>=</span> <span class=p>[]</span>
                    <span class=k>for</span> <span class=n>start</span><span class=p>,</span> <span class=n>stop</span> <span class=ow>in</span> <span class=n>indices</span><span class=p>:</span>
                        <span class=n>data_list</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>evt_data</span><span class=p>[</span><span class=n>start</span><span class=p>:</span><span class=n>stop</span><span class=p>])</span>
                    <span class=n>data_</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>  <span class=c1># this creates copy</span>
                    <span class=n>data_</span><span class=p>[</span><span class=n>series</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>data_list</span><span class=p>)</span>
                    <span class=n>data</span> <span class=o>=</span> <span class=n>utils</span><span class=o>.</span><span class=n>ragged_array</span><span class=p>(</span><span class=n>data_</span><span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>data</span>
            <span class=k>if</span> <span class=n>issue_warning</span><span class=p>:</span>
                <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;ignoring events outside of eventarray support&quot;</span><span class=p>)</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=n>newintervals</span>
        <span class=k>return</span> <span class=bp>self</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__repr__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=n>address_str</span> <span class=o>=</span> <span class=s2>&quot; at &quot;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=nb>hex</span><span class=p>(</span><span class=nb>id</span><span class=p>(</span><span class=bp>self</span><span class=p>)))</span>
        <span class=n>logging</span><span class=o>.</span><span class=n>disable</span><span class=p>(</span><span class=n>logging</span><span class=o>.</span><span class=n>CRITICAL</span><span class=p>)</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>isempty</span><span class=p>:</span>
            <span class=k>return</span> <span class=s2>&quot;&lt;empty &quot;</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>type_name</span> <span class=o>+</span> <span class=n>address_str</span> <span class=o>+</span> <span class=s2>&quot;&gt;&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=o>.</span><span class=n>n_intervals</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
            <span class=n>epstr</span> <span class=o>=</span> <span class=s2>&quot; (</span><span class=si>{}</span><span class=s2> segments)&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=o>.</span><span class=n>n_intervals</span><span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>epstr</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>fs</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>fsstr</span> <span class=o>=</span> <span class=s2>&quot; at </span><span class=si>%s</span><span class=s2> Hz&quot;</span> <span class=o>%</span> <span class=bp>self</span><span class=o>.</span><span class=n>fs</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>fsstr</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>label</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>labelstr</span> <span class=o>=</span> <span class=s2>&quot; from </span><span class=si>%s</span><span class=s2>&quot;</span> <span class=o>%</span> <span class=bp>self</span><span class=o>.</span><span class=n>label</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>labelstr</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span>
        <span class=n>numstr</span> <span class=o>=</span> <span class=s2>&quot; </span><span class=si>%s</span><span class=s2> </span><span class=si>%s</span><span class=s2>&quot;</span> <span class=o>%</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>n_series</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_series_label</span><span class=p>)</span>
        <span class=n>logging</span><span class=o>.</span><span class=n>disable</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
        <span class=k>return</span> <span class=s2>&quot;&lt;</span><span class=si>%s%s</span><span class=s2>:</span><span class=si>%s%s</span><span class=s2>&gt;</span><span class=si>%s%s</span><span class=s2>&quot;</span> <span class=o>%</span> <span class=p>(</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>type_name</span><span class=p>,</span>
            <span class=n>address_str</span><span class=p>,</span>
            <span class=n>numstr</span><span class=p>,</span>
            <span class=n>epstr</span><span class=p>,</span>
            <span class=n>fsstr</span><span class=p>,</span>
            <span class=n>labelstr</span><span class=p>,</span>
        <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>bin</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>ds</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Return a binned eventarray.&quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=n>BinnedEventArray</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ds</span><span class=o>=</span><span class=n>ds</span><span class=p>)</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>data</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Event datas in seconds.&quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_data</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>n_events</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(np.array) The number of events in each series.&quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>isempty</span><span class=p>:</span>
            <span class=k>return</span> <span class=mi>0</span>
        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=nb>len</span><span class=p>(</span><span class=n>series</span><span class=p>)</span> <span class=k>for</span> <span class=n>series</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>])</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>issorted</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;(bool) Sorted EventArray.&quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>isempty</span><span class=p>:</span>
            <span class=k>return</span> <span class=kc>True</span>
        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>utils</span><span class=o>.</span><span class=n>is_sorted</span><span class=p>(</span><span class=n>eventarray</span><span class=p>)</span> <span class=k>for</span> <span class=n>eventarray</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>])</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_reorder_series_by_idx</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>neworder</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Reorder series according to a specified order.</span>

<span class=sd>        neworder must be list-like, of size (n_series,)</span>

<span class=sd>        Return</span>
<span class=sd>        ------</span>
<span class=sd>        out : reordered EventArray</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=n>inplace</span><span class=p>:</span>
            <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>

        <span class=n>oldorder</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>neworder</span><span class=p>)))</span>
        <span class=k>for</span> <span class=n>oi</span><span class=p>,</span> <span class=n>ni</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>neworder</span><span class=p>):</span>
            <span class=n>frm</span> <span class=o>=</span> <span class=n>oldorder</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>ni</span><span class=p>)</span>
            <span class=n>to</span> <span class=o>=</span> <span class=n>oi</span>
            <span class=n>utils</span><span class=o>.</span><span class=n>swap_rows</span><span class=p>(</span><span class=n>out</span><span class=o>.</span><span class=n>_data</span><span class=p>,</span> <span class=n>frm</span><span class=p>,</span> <span class=n>to</span><span class=p>)</span>
            <span class=n>out</span><span class=o>.</span><span class=n>_series_ids</span><span class=p>[</span><span class=n>frm</span><span class=p>],</span> <span class=n>out</span><span class=o>.</span><span class=n>_series_ids</span><span class=p>[</span><span class=n>to</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
                <span class=n>out</span><span class=o>.</span><span class=n>_series_ids</span><span class=p>[</span><span class=n>to</span><span class=p>],</span>
                <span class=n>out</span><span class=o>.</span><span class=n>_series_ids</span><span class=p>[</span><span class=n>frm</span><span class=p>],</span>
            <span class=p>)</span>
            <span class=n>out</span><span class=o>.</span><span class=n>_series_labels</span><span class=p>[</span><span class=n>frm</span><span class=p>],</span> <span class=n>out</span><span class=o>.</span><span class=n>_series_labels</span><span class=p>[</span><span class=n>to</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
                <span class=n>out</span><span class=o>.</span><span class=n>_series_labels</span><span class=p>[</span><span class=n>to</span><span class=p>],</span>
                <span class=n>out</span><span class=o>.</span><span class=n>_series_labels</span><span class=p>[</span><span class=n>frm</span><span class=p>],</span>
            <span class=p>)</span>
            <span class=c1># TODO: re-build series tags (tag system not yet implemented)</span>
            <span class=n>oldorder</span><span class=p>[</span><span class=n>frm</span><span class=p>],</span> <span class=n>oldorder</span><span class=p>[</span><span class=n>to</span><span class=p>]</span> <span class=o>=</span> <span class=n>oldorder</span><span class=p>[</span><span class=n>to</span><span class=p>],</span> <span class=n>oldorder</span><span class=p>[</span><span class=n>frm</span><span class=p>]</span>

        <span class=n>out</span><span class=o>.</span><span class=n>__renew__</span><span class=p>()</span>
        <span class=k>return</span> <span class=n>out</span>

    <span class=k>def</span><span class=w> </span><span class=nf>reorder_series</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>neworder</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Reorder series according to a specified order.</span>

<span class=sd>        neworder must be list-like, of size (n_series,) and in terms of</span>
<span class=sd>        series_ids</span>

<span class=sd>        Return</span>
<span class=sd>        ------</span>
<span class=sd>        out : reordered EventArray</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>raise</span> <span class=ne>DeprecationWarning</span><span class=p>(</span>
            <span class=s2>&quot;reorder_series has been deprecated. Use reorder_series_by_id(x/s) instead!&quot;</span>
        <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>reorder_series_by_ids</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>neworder</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Reorder series according to a specified order.</span>

<span class=sd>        neworder must be list-like, of size (n_series,) and in terms of</span>
<span class=sd>        series_ids</span>

<span class=sd>        Return</span>
<span class=sd>        ------</span>
<span class=sd>        out : reordered EventArray</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=n>inplace</span><span class=p>:</span>
            <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>

        <span class=n>neworder</span> <span class=o>=</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>series_ids</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>neworder</span><span class=p>]</span>

        <span class=n>oldorder</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>neworder</span><span class=p>)))</span>
        <span class=k>for</span> <span class=n>oi</span><span class=p>,</span> <span class=n>ni</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>neworder</span><span class=p>):</span>
            <span class=n>frm</span> <span class=o>=</span> <span class=n>oldorder</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>ni</span><span class=p>)</span>
            <span class=n>to</span> <span class=o>=</span> <span class=n>oi</span>
            <span class=n>utils</span><span class=o>.</span><span class=n>swap_rows</span><span class=p>(</span><span class=n>out</span><span class=o>.</span><span class=n>_data</span><span class=p>,</span> <span class=n>frm</span><span class=p>,</span> <span class=n>to</span><span class=p>)</span>
            <span class=n>out</span><span class=o>.</span><span class=n>_series_ids</span><span class=p>[</span><span class=n>frm</span><span class=p>],</span> <span class=n>out</span><span class=o>.</span><span class=n>_series_ids</span><span class=p>[</span><span class=n>to</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
                <span class=n>out</span><span class=o>.</span><span class=n>_series_ids</span><span class=p>[</span><span class=n>to</span><span class=p>],</span>
                <span class=n>out</span><span class=o>.</span><span class=n>_series_ids</span><span class=p>[</span><span class=n>frm</span><span class=p>],</span>
            <span class=p>)</span>
            <span class=n>out</span><span class=o>.</span><span class=n>_series_labels</span><span class=p>[</span><span class=n>frm</span><span class=p>],</span> <span class=n>out</span><span class=o>.</span><span class=n>_series_labels</span><span class=p>[</span><span class=n>to</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
                <span class=n>out</span><span class=o>.</span><span class=n>_series_labels</span><span class=p>[</span><span class=n>to</span><span class=p>],</span>
                <span class=n>out</span><span class=o>.</span><span class=n>_series_labels</span><span class=p>[</span><span class=n>frm</span><span class=p>],</span>
            <span class=p>)</span>
            <span class=c1># TODO: re-build series tags (tag system not yet implemented)</span>
            <span class=n>oldorder</span><span class=p>[</span><span class=n>frm</span><span class=p>],</span> <span class=n>oldorder</span><span class=p>[</span><span class=n>to</span><span class=p>]</span> <span class=o>=</span> <span class=n>oldorder</span><span class=p>[</span><span class=n>to</span><span class=p>],</span> <span class=n>oldorder</span><span class=p>[</span><span class=n>frm</span><span class=p>]</span>

        <span class=n>out</span><span class=o>.</span><span class=n>__renew__</span><span class=p>()</span>
        <span class=k>return</span> <span class=n>out</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_event_firing_order</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Returns a list of series_ids such that the series are ordered</span>
<span class=sd>        by when they first fire in the EventArray.</span>

<span class=sd>        Return</span>
<span class=sd>        ------</span>
<span class=sd>        firing_order : list of series_ids</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=n>first_events</span> <span class=o>=</span> <span class=p>[</span>
            <span class=p>(</span><span class=n>ii</span><span class=p>,</span> <span class=n>series</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=k>for</span> <span class=p>(</span><span class=n>ii</span><span class=p>,</span> <span class=n>series</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>)</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>series</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span>
        <span class=p>]</span>
        <span class=n>first_events_series_ids</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>series_ids</span><span class=p>)[</span>
            <span class=p>[</span><span class=n>fs</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=k>for</span> <span class=n>fs</span> <span class=ow>in</span> <span class=n>first_events</span><span class=p>]</span>
        <span class=p>]</span>
        <span class=n>first_events_datas</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>fs</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>for</span> <span class=n>fs</span> <span class=ow>in</span> <span class=n>first_events</span><span class=p>])</span>
        <span class=n>sortorder</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argsort</span><span class=p>(</span><span class=n>first_events_datas</span><span class=p>)</span>
        <span class=n>first_events_series_ids</span> <span class=o>=</span> <span class=n>first_events_series_ids</span><span class=p>[</span><span class=n>sortorder</span><span class=p>]</span>
        <span class=n>remaining_ids</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>series_ids</span><span class=p>)</span> <span class=o>-</span> <span class=nb>set</span><span class=p>(</span><span class=n>first_events_series_ids</span><span class=p>))</span>
        <span class=n>firing_order</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>first_events_series_ids</span><span class=p>)</span>
        <span class=n>firing_order</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>remaining_ids</span><span class=p>)</span>

        <span class=k>return</span> <span class=n>firing_order</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>first_event</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Returns the [time of the] first event across all series.&quot;&quot;&quot;</span>
        <span class=n>first</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>inf</span>
        <span class=k>for</span> <span class=n>series</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>series</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>first</span><span class=p>:</span>
                <span class=n>first</span> <span class=o>=</span> <span class=n>series</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
        <span class=k>return</span> <span class=n>first</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>last_event</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Returns the [time of the] last event across all series.&quot;&quot;&quot;</span>
        <span class=n>last</span> <span class=o>=</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>inf</span>
        <span class=k>for</span> <span class=n>series</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>series</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>last</span><span class=p>:</span>
                <span class=n>last</span> <span class=o>=</span> <span class=n>series</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
        <span class=k>return</span> <span class=n>last</span>

    <span class=k>def</span><span class=w> </span><span class=nf>empty</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Remove data (but not metadata) from EventArray.</span>

<span class=sd>        Attributes &#39;data&#39;, and &#39;support&#39; are both emptied.</span>

<span class=sd>        Note: n_series, series_ids, etc. are all preserved.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>inplace</span><span class=p>:</span>
            <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_copy_without_data</span><span class=p>()</span>
            <span class=n>out</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)(</span><span class=n>empty</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
            <span class=k>return</span> <span class=n>out</span>
        <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span>
        <span class=n>out</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>n_series</span> <span class=o>*</span> <span class=p>[</span><span class=kc>None</span><span class=p>])</span>
        <span class=n>out</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)(</span><span class=n>empty</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=n>out</span><span class=o>.</span><span class=n>__renew__</span><span class=p>()</span>
        <span class=k>return</span> <span class=n>out</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.EventArray.data class="doc doc-heading"> <code class="highlight language-python"><span class=n>data</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>Event datas in seconds.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.EventArray.first_event class="doc doc-heading"> <code class="highlight language-python"><span class=n>first_event</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>Returns the [time of the] first event across all series.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.EventArray.isempty class="doc doc-heading"> <code class="highlight language-python"><span class=n>isempty</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>(bool) Empty EventArray.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.EventArray.issorted class="doc doc-heading"> <code class="highlight language-python"><span class=n>issorted</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>(bool) Sorted EventArray.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.EventArray.last_event class="doc doc-heading"> <code class="highlight language-python"><span class=n>last_event</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>Returns the [time of the] last event across all series.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.EventArray.n_active class="doc doc-heading"> <code class="highlight language-python"><span class=n>n_active</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>(int) The number of active series.</p> <p>A series is considered active if it fired at least one event.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.EventArray.n_events class="doc doc-heading"> <code class="highlight language-python"><span class=n>n_events</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>(np.array) The number of events in each series.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=nelpy.core._eventarray.EventArray.n_series class="doc doc-heading"> <code class="highlight language-python"><span class=n>n_series</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc doc-contents "> <p>(int) The number of series.</p> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.EventArray.bin class="doc doc-heading"> <code class="highlight language-python"><span class=nb>bin</span><span class=p>(</span><span class=o>*</span><span class=p>,</span> <span class=n>ds</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Return a binned eventarray.</p> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>864</span>
<span class=normal>865</span>
<span class=normal>866</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>bin</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>ds</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return a binned eventarray.&quot;&quot;&quot;</span>
    <span class=k>return</span> <span class=n>BinnedEventArray</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ds</span><span class=o>=</span><span class=n>ds</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.EventArray.copy class="doc doc-heading"> <code class="highlight language-python"><span class=n>copy</span><span class=p>()</span></code> </h3> <div class="doc doc-contents "> <p>Returns a copy of the EventArray.</p> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>639</span>
<span class=normal>640</span>
<span class=normal>641</span>
<span class=normal>642</span>
<span class=normal>643</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>copy</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Returns a copy of the EventArray.&quot;&quot;&quot;</span>
    <span class=n>newcopy</span> <span class=o>=</span> <span class=n>copy</span><span class=o>.</span><span class=n>deepcopy</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>
    <span class=n>newcopy</span><span class=o>.</span><span class=n>__renew__</span><span class=p>()</span>
    <span class=k>return</span> <span class=n>newcopy</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.EventArray.empty class="doc doc-heading"> <code class="highlight language-python"><span class=n>empty</span><span class=p>(</span><span class=o>*</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Remove data (but not metadata) from EventArray.</p> <p>Attributes 'data', and 'support' are both emptied.</p> <p>Note: n_series, series_ids, etc. are all preserved.</p> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1013</span>
<span class=normal>1014</span>
<span class=normal>1015</span>
<span class=normal>1016</span>
<span class=normal>1017</span>
<span class=normal>1018</span>
<span class=normal>1019</span>
<span class=normal>1020</span>
<span class=normal>1021</span>
<span class=normal>1022</span>
<span class=normal>1023</span>
<span class=normal>1024</span>
<span class=normal>1025</span>
<span class=normal>1026</span>
<span class=normal>1027</span>
<span class=normal>1028</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>empty</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Remove data (but not metadata) from EventArray.</span>

<span class=sd>    Attributes &#39;data&#39;, and &#39;support&#39; are both emptied.</span>

<span class=sd>    Note: n_series, series_ids, etc. are all preserved.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>inplace</span><span class=p>:</span>
        <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_copy_without_data</span><span class=p>()</span>
        <span class=n>out</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)(</span><span class=n>empty</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>out</span>
    <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span>
    <span class=n>out</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>n_series</span> <span class=o>*</span> <span class=p>[</span><span class=kc>None</span><span class=p>])</span>
    <span class=n>out</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_abscissa</span><span class=o>.</span><span class=n>support</span><span class=p>)(</span><span class=n>empty</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=n>out</span><span class=o>.</span><span class=n>__renew__</span><span class=p>()</span>
    <span class=k>return</span> <span class=n>out</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.EventArray.flatten class="doc doc-heading"> <code class="highlight language-python"><span class=n>flatten</span><span class=p>(</span><span class=o>*</span><span class=p>,</span> <span class=n>series_id</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>series_label</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Collapse events across series.</p> <p>WARNING! series_tags are thrown away when flattening.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>series_id</code> </td> <td> </td> <td> <div class=doc-md-description> <p>(series) ID to assign to flattened event series, default is 0.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>series_label</code> </td> <td> </td> <td> <div class=doc-md-description> <p>(series) Label for event series, default is 'flattened'.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>693</span>
<span class=normal>694</span>
<span class=normal>695</span>
<span class=normal>696</span>
<span class=normal>697</span>
<span class=normal>698</span>
<span class=normal>699</span>
<span class=normal>700</span>
<span class=normal>701</span>
<span class=normal>702</span>
<span class=normal>703</span>
<span class=normal>704</span>
<span class=normal>705</span>
<span class=normal>706</span>
<span class=normal>707</span>
<span class=normal>708</span>
<span class=normal>709</span>
<span class=normal>710</span>
<span class=normal>711</span>
<span class=normal>712</span>
<span class=normal>713</span>
<span class=normal>714</span>
<span class=normal>715</span>
<span class=normal>716</span>
<span class=normal>717</span>
<span class=normal>718</span>
<span class=normal>719</span>
<span class=normal>720</span>
<span class=normal>721</span>
<span class=normal>722</span>
<span class=normal>723</span>
<span class=normal>724</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>flatten</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>series_id</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>series_label</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Collapse events across series.</span>

<span class=sd>    WARNING! series_tags are thrown away when flattening.</span>

<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    series_id: (int)</span>
<span class=sd>        (series) ID to assign to flattened event series, default is 0.</span>
<span class=sd>    series_label (str)</span>
<span class=sd>        (series) Label for event series, default is &#39;flattened&#39;.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>n_series</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=p>:</span>  <span class=c1># already flattened</span>
        <span class=k>return</span> <span class=bp>self</span>

    <span class=c1># default args:</span>
    <span class=k>if</span> <span class=n>series_id</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>series_id</span> <span class=o>=</span> <span class=mi>0</span>
    <span class=k>if</span> <span class=n>series_label</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>series_label</span> <span class=o>=</span> <span class=s2>&quot;flattened&quot;</span>

    <span class=n>flattened</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_copy_without_data</span><span class=p>()</span>
    <span class=n>flattened</span><span class=o>.</span><span class=n>_series_ids</span> <span class=o>=</span> <span class=p>[</span><span class=n>series_id</span><span class=p>]</span>
    <span class=n>flattened</span><span class=o>.</span><span class=n>_series_labels</span> <span class=o>=</span> <span class=p>[</span><span class=n>series_label</span><span class=p>]</span>
    <span class=n>flattened</span><span class=o>.</span><span class=n>_series_tags</span> <span class=o>=</span> <span class=kc>None</span>

    <span class=c1># Efficient: concatenate all events, sort once</span>
    <span class=n>all_events</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>)</span>
    <span class=n>all_events</span><span class=o>.</span><span class=n>sort</span><span class=p>()</span>
    <span class=n>flattened</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>all_events</span><span class=p>],</span> <span class=n>ndmin</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
    <span class=n>flattened</span><span class=o>.</span><span class=n>__renew__</span><span class=p>()</span>
    <span class=k>return</span> <span class=n>flattened</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.EventArray.get_event_firing_order class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_event_firing_order</span><span class=p>()</span></code> </h3> <div class="doc doc-contents "> <p>Returns a list of series_ids such that the series are ordered by when they first fire in the EventArray.</p> <details class=return open> <summary>Return</summary> <p>firing_order : list of series_ids</p> </details> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>971</span>
<span class=normal>972</span>
<span class=normal>973</span>
<span class=normal>974</span>
<span class=normal>975</span>
<span class=normal>976</span>
<span class=normal>977</span>
<span class=normal>978</span>
<span class=normal>979</span>
<span class=normal>980</span>
<span class=normal>981</span>
<span class=normal>982</span>
<span class=normal>983</span>
<span class=normal>984</span>
<span class=normal>985</span>
<span class=normal>986</span>
<span class=normal>987</span>
<span class=normal>988</span>
<span class=normal>989</span>
<span class=normal>990</span>
<span class=normal>991</span>
<span class=normal>992</span>
<span class=normal>993</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_event_firing_order</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Returns a list of series_ids such that the series are ordered</span>
<span class=sd>    by when they first fire in the EventArray.</span>

<span class=sd>    Return</span>
<span class=sd>    ------</span>
<span class=sd>    firing_order : list of series_ids</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>first_events</span> <span class=o>=</span> <span class=p>[</span>
        <span class=p>(</span><span class=n>ii</span><span class=p>,</span> <span class=n>series</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=k>for</span> <span class=p>(</span><span class=n>ii</span><span class=p>,</span> <span class=n>series</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>)</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>series</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span>
    <span class=p>]</span>
    <span class=n>first_events_series_ids</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>series_ids</span><span class=p>)[</span>
        <span class=p>[</span><span class=n>fs</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=k>for</span> <span class=n>fs</span> <span class=ow>in</span> <span class=n>first_events</span><span class=p>]</span>
    <span class=p>]</span>
    <span class=n>first_events_datas</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>fs</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>for</span> <span class=n>fs</span> <span class=ow>in</span> <span class=n>first_events</span><span class=p>])</span>
    <span class=n>sortorder</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argsort</span><span class=p>(</span><span class=n>first_events_datas</span><span class=p>)</span>
    <span class=n>first_events_series_ids</span> <span class=o>=</span> <span class=n>first_events_series_ids</span><span class=p>[</span><span class=n>sortorder</span><span class=p>]</span>
    <span class=n>remaining_ids</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>series_ids</span><span class=p>)</span> <span class=o>-</span> <span class=nb>set</span><span class=p>(</span><span class=n>first_events_series_ids</span><span class=p>))</span>
    <span class=n>firing_order</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>first_events_series_ids</span><span class=p>)</span>
    <span class=n>firing_order</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>remaining_ids</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>firing_order</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.EventArray.partition class="doc doc-heading"> <code class="highlight language-python"><span class=n>partition</span><span class=p>(</span><span class=n>ds</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>n_intervals</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Returns a BaseEventArray whose support has been partitioned.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>ds</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Maximum duration (in seconds), for each interval.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>n_points</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of intervals. If ds is None and n_intervals is None, then default is to use n_intervals = 100</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>out</code></td> <td> <code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BaseEventArray>BaseEventArray</a></code> </td> <td> <div class=doc-md-description> <p>BaseEventArray that has been partitioned.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>Irrespective of whether 'ds' or 'n_intervals' are used, the exact underlying support is propagated, and the first and last points of the supports are always included, even if this would cause n_points or ds to be violated.</p> </details> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>594</span>
<span class=normal>595</span>
<span class=normal>596</span>
<span class=normal>597</span>
<span class=normal>598</span>
<span class=normal>599</span>
<span class=normal>600</span>
<span class=normal>601</span>
<span class=normal>602</span>
<span class=normal>603</span>
<span class=normal>604</span>
<span class=normal>605</span>
<span class=normal>606</span>
<span class=normal>607</span>
<span class=normal>608</span>
<span class=normal>609</span>
<span class=normal>610</span>
<span class=normal>611</span>
<span class=normal>612</span>
<span class=normal>613</span>
<span class=normal>614</span>
<span class=normal>615</span>
<span class=normal>616</span>
<span class=normal>617</span>
<span class=normal>618</span>
<span class=normal>619</span>
<span class=normal>620</span>
<span class=normal>621</span>
<span class=normal>622</span>
<span class=normal>623</span>
<span class=normal>624</span>
<span class=normal>625</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@keyword_equivalence</span><span class=p>(</span><span class=n>this_or_that</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;n_intervals&quot;</span><span class=p>:</span> <span class=s2>&quot;n_epochs&quot;</span><span class=p>})</span>
<span class=k>def</span><span class=w> </span><span class=nf>partition</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ds</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>n_intervals</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Returns a BaseEventArray whose support has been partitioned.</span>

<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    ds : float, optional</span>
<span class=sd>        Maximum duration (in seconds), for each interval.</span>
<span class=sd>    n_points : int, optional</span>
<span class=sd>        Number of intervals. If ds is None and n_intervals is None, then</span>
<span class=sd>        default is to use n_intervals = 100</span>

<span class=sd>    Returns</span>
<span class=sd>    -------</span>
<span class=sd>    out : BaseEventArray</span>
<span class=sd>        BaseEventArray that has been partitioned.</span>

<span class=sd>    Notes</span>
<span class=sd>    -----</span>
<span class=sd>    Irrespective of whether &#39;ds&#39; or &#39;n_intervals&#39; are used, the exact</span>
<span class=sd>    underlying support is propagated, and the first and last points</span>
<span class=sd>    of the supports are always included, even if this would cause</span>
<span class=sd>    n_points or ds to be violated.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
    <span class=n>abscissa</span> <span class=o>=</span> <span class=n>copy</span><span class=o>.</span><span class=n>deepcopy</span><span class=p>(</span><span class=n>out</span><span class=o>.</span><span class=n>_abscissa</span><span class=p>)</span>
    <span class=n>abscissa</span><span class=o>.</span><span class=n>support</span> <span class=o>=</span> <span class=n>abscissa</span><span class=o>.</span><span class=n>support</span><span class=o>.</span><span class=n>partition</span><span class=p>(</span><span class=n>ds</span><span class=o>=</span><span class=n>ds</span><span class=p>,</span> <span class=n>n_intervals</span><span class=o>=</span><span class=n>n_intervals</span><span class=p>)</span>
    <span class=n>out</span><span class=o>.</span><span class=n>_abscissa</span> <span class=o>=</span> <span class=n>abscissa</span>
    <span class=n>out</span><span class=o>.</span><span class=n>__renew__</span><span class=p>()</span>

    <span class=k>return</span> <span class=n>out</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.EventArray.reorder_series class="doc doc-heading"> <code class="highlight language-python"><span class=n>reorder_series</span><span class=p>(</span><span class=n>neworder</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Reorder series according to a specified order.</p> <p>neworder must be list-like, of size (n_series,) and in terms of series_ids</p> <details class=return open> <summary>Return</summary> <p>out : reordered EventArray</p> </details> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>921</span>
<span class=normal>922</span>
<span class=normal>923</span>
<span class=normal>924</span>
<span class=normal>925</span>
<span class=normal>926</span>
<span class=normal>927</span>
<span class=normal>928</span>
<span class=normal>929</span>
<span class=normal>930</span>
<span class=normal>931</span>
<span class=normal>932</span>
<span class=normal>933</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>reorder_series</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>neworder</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Reorder series according to a specified order.</span>

<span class=sd>    neworder must be list-like, of size (n_series,) and in terms of</span>
<span class=sd>    series_ids</span>

<span class=sd>    Return</span>
<span class=sd>    ------</span>
<span class=sd>    out : reordered EventArray</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>raise</span> <span class=ne>DeprecationWarning</span><span class=p>(</span>
        <span class=s2>&quot;reorder_series has been deprecated. Use reorder_series_by_id(x/s) instead!&quot;</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.EventArray.reorder_series_by_ids class="doc doc-heading"> <code class="highlight language-python"><span class=n>reorder_series_by_ids</span><span class=p>(</span><span class=n>neworder</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Reorder series according to a specified order.</p> <p>neworder must be list-like, of size (n_series,) and in terms of series_ids</p> <details class=return open> <summary>Return</summary> <p>out : reordered EventArray</p> </details> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>935</span>
<span class=normal>936</span>
<span class=normal>937</span>
<span class=normal>938</span>
<span class=normal>939</span>
<span class=normal>940</span>
<span class=normal>941</span>
<span class=normal>942</span>
<span class=normal>943</span>
<span class=normal>944</span>
<span class=normal>945</span>
<span class=normal>946</span>
<span class=normal>947</span>
<span class=normal>948</span>
<span class=normal>949</span>
<span class=normal>950</span>
<span class=normal>951</span>
<span class=normal>952</span>
<span class=normal>953</span>
<span class=normal>954</span>
<span class=normal>955</span>
<span class=normal>956</span>
<span class=normal>957</span>
<span class=normal>958</span>
<span class=normal>959</span>
<span class=normal>960</span>
<span class=normal>961</span>
<span class=normal>962</span>
<span class=normal>963</span>
<span class=normal>964</span>
<span class=normal>965</span>
<span class=normal>966</span>
<span class=normal>967</span>
<span class=normal>968</span>
<span class=normal>969</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>reorder_series_by_ids</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>neworder</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Reorder series according to a specified order.</span>

<span class=sd>    neworder must be list-like, of size (n_series,) and in terms of</span>
<span class=sd>    series_ids</span>

<span class=sd>    Return</span>
<span class=sd>    ------</span>
<span class=sd>    out : reordered EventArray</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>inplace</span><span class=p>:</span>
        <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=n>out</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>

    <span class=n>neworder</span> <span class=o>=</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>series_ids</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>neworder</span><span class=p>]</span>

    <span class=n>oldorder</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>neworder</span><span class=p>)))</span>
    <span class=k>for</span> <span class=n>oi</span><span class=p>,</span> <span class=n>ni</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>neworder</span><span class=p>):</span>
        <span class=n>frm</span> <span class=o>=</span> <span class=n>oldorder</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>ni</span><span class=p>)</span>
        <span class=n>to</span> <span class=o>=</span> <span class=n>oi</span>
        <span class=n>utils</span><span class=o>.</span><span class=n>swap_rows</span><span class=p>(</span><span class=n>out</span><span class=o>.</span><span class=n>_data</span><span class=p>,</span> <span class=n>frm</span><span class=p>,</span> <span class=n>to</span><span class=p>)</span>
        <span class=n>out</span><span class=o>.</span><span class=n>_series_ids</span><span class=p>[</span><span class=n>frm</span><span class=p>],</span> <span class=n>out</span><span class=o>.</span><span class=n>_series_ids</span><span class=p>[</span><span class=n>to</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
            <span class=n>out</span><span class=o>.</span><span class=n>_series_ids</span><span class=p>[</span><span class=n>to</span><span class=p>],</span>
            <span class=n>out</span><span class=o>.</span><span class=n>_series_ids</span><span class=p>[</span><span class=n>frm</span><span class=p>],</span>
        <span class=p>)</span>
        <span class=n>out</span><span class=o>.</span><span class=n>_series_labels</span><span class=p>[</span><span class=n>frm</span><span class=p>],</span> <span class=n>out</span><span class=o>.</span><span class=n>_series_labels</span><span class=p>[</span><span class=n>to</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
            <span class=n>out</span><span class=o>.</span><span class=n>_series_labels</span><span class=p>[</span><span class=n>to</span><span class=p>],</span>
            <span class=n>out</span><span class=o>.</span><span class=n>_series_labels</span><span class=p>[</span><span class=n>frm</span><span class=p>],</span>
        <span class=p>)</span>
        <span class=c1># TODO: re-build series tags (tag system not yet implemented)</span>
        <span class=n>oldorder</span><span class=p>[</span><span class=n>frm</span><span class=p>],</span> <span class=n>oldorder</span><span class=p>[</span><span class=n>to</span><span class=p>]</span> <span class=o>=</span> <span class=n>oldorder</span><span class=p>[</span><span class=n>to</span><span class=p>],</span> <span class=n>oldorder</span><span class=p>[</span><span class=n>frm</span><span class=p>]</span>

    <span class=n>out</span><span class=o>.</span><span class=n>__renew__</span><span class=p>()</span>
    <span class=k>return</span> <span class=n>out</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=nelpy.core._eventarray.SpikeTrainArray class="doc doc-heading"> <code>SpikeTrainArray</code> </h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.EventArray>EventArray</a></code></p> <p>A multiseries spike train array with shared support.</p> <p>SpikeTrainArray is a specialized EventArray for handling neural spike train data. It provides unit-specific aliases and methods for analyzing spike timing data across multiple recording units with a common temporal support.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>fs</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Sampling rate in Hz. Default is 30,000.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>support</code> </td> <td> <code><a class="autorefs autorefs-internal" href=../intervalarray/#nelpy.core._intervalarray.IntervalArray>IntervalArray</a></code> </td> <td> <div class=doc-md-description> <p>IntervalArray on which spike trains are defined. Default is [0, last spike] inclusive.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>unit_ids</code> </td> <td> <code>list of int</code> </td> <td> <div class=doc-md-description> <p>Unit IDs. Alias for series_ids.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>unit_labels</code> </td> <td> <code>list of str</code> </td> <td> <div class=doc-md-description> <p>Labels corresponding to units. Default casts unit_ids to str. Alias for series_labels.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>unit_tags</code> </td> <td> <code><span title=optional>optional</span></code> </td> <td> <div class=doc-md-description> <p>Tags corresponding to units. Alias for series_tags. NOTE: Currently we do not do any input validation so these can be any type. We also don't use these for anything yet.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>label</code> </td> <td> <code><span title=str>str</span> or None</code> </td> <td> <div class=doc-md-description> <p>Information pertaining to the source of the spike train array.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>empty</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether an empty SpikeTrainArray should be constructed (no data).</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>**kwargs</code> </td> <td> <code><span title=optional>optional</span></code> </td> <td> <div class=doc-md-description> <p>Additional keyword arguments forwarded to the BaseEventArray constructor.</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Attributes:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.SpikeTrainArray.Note>Note</span></code></td> <td> <code>Read the docstring for the BaseEventArray and EventArray superclasses</code> </td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="nelpy.core._eventarray.SpikeTrainArray.for additional attributes that are defined there.">for additional attributes that are defined there.</span></code></td> <td> </td> <td> <div class=doc-md-description> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BaseEventArray.isempty>isempty</a></code></td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether the SpikeTrainArray is empty (no data).</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.SpikeTrainArray.n_units>n_units</span></code></td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>The number of units. Alias for n_series.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.EventArray.n_active>n_active</a></code></td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>The number of active units. A unit is considered active if it fired at least one spike.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.SpikeTrainArray.time>time</span></code></td> <td> <code>array of np.array(dtype=np.float64)</code> </td> <td> <div class=doc-md-description> <p>Spike time data in seconds. Array of length n_units, each entry with shape (n_spikes,). Alias for data.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.SpikeTrainArray.n_spikes>n_spikes</span></code></td> <td> <code><span title=numpy.ndarray>ndarray</span></code> </td> <td> <div class=doc-md-description> <p>The number of spikes in each unit. Alias for n_events.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.EventArray.issorted>issorted</a></code></td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether the spike times are sorted.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.SpikeTrainArray.first_spike>first_spike</span></code></td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>The time of the very first spike, across all units.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.SpikeTrainArray.last_spike>last_spike</span></code></td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>The time of the very last spike, across all units.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.SpikeTrainArray.unit_ids>unit_ids</span></code></td> <td> <code>list of int</code> </td> <td> <div class=doc-md-description> <p>Unit IDs. Alias for series_ids.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.SpikeTrainArray.unit_labels>unit_labels</span></code></td> <td> <code>list of str</code> </td> <td> <div class=doc-md-description> <p>Labels corresponding to units. Alias for series_labels.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.SpikeTrainArray.unit_tags>unit_tags</span></code></td> <td> </td> <td> <div class=doc-md-description> <p>Tags corresponding to units. Alias for series_tags.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.SpikeTrainArray.n_epochs>n_epochs</span></code></td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>The number of epochs/intervals. Alias for n_intervals.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BaseEventArray.support>support</a></code></td> <td> <code><a class="autorefs autorefs-internal" href=../intervalarray/#nelpy.core._intervalarray.IntervalArray>IntervalArray</a></code> </td> <td> <div class=doc-md-description> <p>The support of the SpikeTrainArray.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BaseEventArray.fs>fs</a></code></td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Sampling frequency (Hz).</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BaseEventArray.label>label</a></code></td> <td> <code><span title=str>str</span> or None</code> </td> <td> <div class=doc-md-description> <p>Information pertaining to the source of the spike train array.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Methods:</span></p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.SpikeTrainArray.bin>bin</a></code></td> <td> <div class=doc-md-description> <p>Return a BinnedSpikeTrainArray.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.SpikeTrainArray.get_spike_firing_order>get_spike_firing_order</span></code></td> <td> <div class=doc-md-description> <p>Returns unit_ids ordered by when they first fire.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=nelpy.core._eventarray.SpikeTrainArray.reorder_units_by_ids>reorder_units_by_ids</span></code></td> <td> <div class=doc-md-description> <p>Reorder units according to specified unit_ids.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.EventArray.flatten>flatten</a></code></td> <td> <div class=doc-md-description> <p>Collapse spikes across units into a single unit.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.BaseEventArray.partition>partition</a></code></td> <td> <div class=doc-md-description> <p>Returns a SpikeTrainArray whose support has been partitioned.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.EventArray.copy>copy</a></code></td> <td> <div class=doc-md-description> <p>Returns a copy of the SpikeTrainArray.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" href=#nelpy.core._eventarray.EventArray.empty>empty</a></code></td> <td> <div class=doc-md-description> <p>Remove data (but not metadata) from SpikeTrainArray.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <p>Create a SpikeTrainArray with two units:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>spike_times</span> <span class=o>=</span> <span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>0.1</span><span class=p>,</span> <span class=mf>0.3</span><span class=p>,</span> <span class=mf>0.7</span><span class=p>]),</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>0.2</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>,</span> <span class=mf>0.8</span><span class=p>])]</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>sta</span> <span class=o>=</span> <span class=n>SpikeTrainArray</span><span class=p>(</span><span class=n>spike_times</span><span class=p>,</span> <span class=n>unit_ids</span><span class=o>=</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=n>fs</span><span class=o>=</span><span class=mi>1000</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>sta</span><span class=o>.</span><span class=n>n_units</span><span class=p>)</span>
<span class=go>2</span>
<span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>sta</span><span class=o>.</span><span class=n>n_spikes</span><span class=p>)</span>
<span class=go>[3 3]</span>
</code></pre></div> <p>Access spike times using the time alias:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>sta</span><span class=o>.</span><span class=n>time</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>  <span class=c1># First unit&#39;s spike times</span>
<span class=go>[0.1 0.3 0.7]</span>
</code></pre></div> <p>Create a binned version:</p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>binned</span> <span class=o>=</span> <span class=n>sta</span><span class=o>.</span><span class=n>bin</span><span class=p>(</span><span class=n>ds</span><span class=o>=</span><span class=mf>0.1</span><span class=p>)</span>  <span class=c1># 100ms bins</span>
</code></pre></div> <details class=note open> <summary>Notes</summary> <p>SpikeTrainArray provides neuroscience-specific aliases for EventArray functionality. For example, 'units' instead of 'series', 'spikes' instead of 'events', and 'time' instead of 'data'. This makes the API more intuitive for neuroscience applications while maintaining full compatibility with the underlying EventArray infrastructure.</p> <p>The class automatically handles spike time sorting and provides efficient methods for common spike train analyses. All spike times are stored in seconds and should be non-negative values within the support interval.</p> </details> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2258</span>
<span class=normal>2259</span>
<span class=normal>2260</span>
<span class=normal>2261</span>
<span class=normal>2262</span>
<span class=normal>2263</span>
<span class=normal>2264</span>
<span class=normal>2265</span>
<span class=normal>2266</span>
<span class=normal>2267</span>
<span class=normal>2268</span>
<span class=normal>2269</span>
<span class=normal>2270</span>
<span class=normal>2271</span>
<span class=normal>2272</span>
<span class=normal>2273</span>
<span class=normal>2274</span>
<span class=normal>2275</span>
<span class=normal>2276</span>
<span class=normal>2277</span>
<span class=normal>2278</span>
<span class=normal>2279</span>
<span class=normal>2280</span>
<span class=normal>2281</span>
<span class=normal>2282</span>
<span class=normal>2283</span>
<span class=normal>2284</span>
<span class=normal>2285</span>
<span class=normal>2286</span>
<span class=normal>2287</span>
<span class=normal>2288</span>
<span class=normal>2289</span>
<span class=normal>2290</span>
<span class=normal>2291</span>
<span class=normal>2292</span>
<span class=normal>2293</span>
<span class=normal>2294</span>
<span class=normal>2295</span>
<span class=normal>2296</span>
<span class=normal>2297</span>
<span class=normal>2298</span>
<span class=normal>2299</span>
<span class=normal>2300</span>
<span class=normal>2301</span>
<span class=normal>2302</span>
<span class=normal>2303</span>
<span class=normal>2304</span>
<span class=normal>2305</span>
<span class=normal>2306</span>
<span class=normal>2307</span>
<span class=normal>2308</span>
<span class=normal>2309</span>
<span class=normal>2310</span>
<span class=normal>2311</span>
<span class=normal>2312</span>
<span class=normal>2313</span>
<span class=normal>2314</span>
<span class=normal>2315</span>
<span class=normal>2316</span>
<span class=normal>2317</span>
<span class=normal>2318</span>
<span class=normal>2319</span>
<span class=normal>2320</span>
<span class=normal>2321</span>
<span class=normal>2322</span>
<span class=normal>2323</span>
<span class=normal>2324</span>
<span class=normal>2325</span>
<span class=normal>2326</span>
<span class=normal>2327</span>
<span class=normal>2328</span>
<span class=normal>2329</span>
<span class=normal>2330</span>
<span class=normal>2331</span>
<span class=normal>2332</span>
<span class=normal>2333</span>
<span class=normal>2334</span>
<span class=normal>2335</span>
<span class=normal>2336</span>
<span class=normal>2337</span>
<span class=normal>2338</span>
<span class=normal>2339</span>
<span class=normal>2340</span>
<span class=normal>2341</span>
<span class=normal>2342</span>
<span class=normal>2343</span>
<span class=normal>2344</span>
<span class=normal>2345</span>
<span class=normal>2346</span>
<span class=normal>2347</span>
<span class=normal>2348</span>
<span class=normal>2349</span>
<span class=normal>2350</span>
<span class=normal>2351</span>
<span class=normal>2352</span>
<span class=normal>2353</span>
<span class=normal>2354</span>
<span class=normal>2355</span>
<span class=normal>2356</span>
<span class=normal>2357</span>
<span class=normal>2358</span>
<span class=normal>2359</span>
<span class=normal>2360</span>
<span class=normal>2361</span>
<span class=normal>2362</span>
<span class=normal>2363</span>
<span class=normal>2364</span>
<span class=normal>2365</span>
<span class=normal>2366</span>
<span class=normal>2367</span>
<span class=normal>2368</span>
<span class=normal>2369</span>
<span class=normal>2370</span>
<span class=normal>2371</span>
<span class=normal>2372</span>
<span class=normal>2373</span>
<span class=normal>2374</span>
<span class=normal>2375</span>
<span class=normal>2376</span>
<span class=normal>2377</span>
<span class=normal>2378</span>
<span class=normal>2379</span>
<span class=normal>2380</span>
<span class=normal>2381</span>
<span class=normal>2382</span>
<span class=normal>2383</span>
<span class=normal>2384</span>
<span class=normal>2385</span>
<span class=normal>2386</span>
<span class=normal>2387</span>
<span class=normal>2388</span>
<span class=normal>2389</span>
<span class=normal>2390</span>
<span class=normal>2391</span>
<span class=normal>2392</span>
<span class=normal>2393</span>
<span class=normal>2394</span>
<span class=normal>2395</span>
<span class=normal>2396</span>
<span class=normal>2397</span>
<span class=normal>2398</span>
<span class=normal>2399</span>
<span class=normal>2400</span>
<span class=normal>2401</span>
<span class=normal>2402</span>
<span class=normal>2403</span>
<span class=normal>2404</span>
<span class=normal>2405</span>
<span class=normal>2406</span>
<span class=normal>2407</span>
<span class=normal>2408</span>
<span class=normal>2409</span>
<span class=normal>2410</span>
<span class=normal>2411</span>
<span class=normal>2412</span>
<span class=normal>2413</span>
<span class=normal>2414</span>
<span class=normal>2415</span>
<span class=normal>2416</span>
<span class=normal>2417</span>
<span class=normal>2418</span>
<span class=normal>2419</span>
<span class=normal>2420</span>
<span class=normal>2421</span>
<span class=normal>2422</span>
<span class=normal>2423</span>
<span class=normal>2424</span>
<span class=normal>2425</span>
<span class=normal>2426</span>
<span class=normal>2427</span>
<span class=normal>2428</span>
<span class=normal>2429</span>
<span class=normal>2430</span>
<span class=normal>2431</span>
<span class=normal>2432</span>
<span class=normal>2433</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>SpikeTrainArray</span><span class=p>(</span><span class=n>EventArray</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;A multiseries spike train array with shared support.</span>

<span class=sd>    SpikeTrainArray is a specialized EventArray for handling neural spike train data.</span>
<span class=sd>    It provides unit-specific aliases and methods for analyzing spike timing data</span>
<span class=sd>    across multiple recording units with a common temporal support.</span>

<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    fs : float, optional</span>
<span class=sd>        Sampling rate in Hz. Default is 30,000.</span>
<span class=sd>    support : IntervalArray, optional</span>
<span class=sd>        IntervalArray on which spike trains are defined.</span>
<span class=sd>        Default is [0, last spike] inclusive.</span>
<span class=sd>    unit_ids : list of int, optional</span>
<span class=sd>        Unit IDs. Alias for series_ids.</span>
<span class=sd>    unit_labels : list of str, optional</span>
<span class=sd>        Labels corresponding to units. Default casts unit_ids to str.</span>
<span class=sd>        Alias for series_labels.</span>
<span class=sd>    unit_tags : optional</span>
<span class=sd>        Tags corresponding to units. Alias for series_tags.</span>
<span class=sd>        NOTE: Currently we do not do any input validation so these can</span>
<span class=sd>        be any type. We also don&#39;t use these for anything yet.</span>
<span class=sd>    label : str or None, optional</span>
<span class=sd>        Information pertaining to the source of the spike train array.</span>
<span class=sd>    empty : bool, optional</span>
<span class=sd>        Whether an empty SpikeTrainArray should be constructed (no data).</span>
<span class=sd>    **kwargs : optional</span>
<span class=sd>        Additional keyword arguments forwarded to the BaseEventArray</span>
<span class=sd>        constructor.</span>

<span class=sd>    Attributes</span>
<span class=sd>    ----------</span>
<span class=sd>    Note : Read the docstring for the BaseEventArray and EventArray superclasses</span>
<span class=sd>    for additional attributes that are defined there.</span>

<span class=sd>    isempty : bool</span>
<span class=sd>        Whether the SpikeTrainArray is empty (no data).</span>
<span class=sd>    n_units : int</span>
<span class=sd>        The number of units. Alias for n_series.</span>
<span class=sd>    n_active : int</span>
<span class=sd>        The number of active units. A unit is considered active if</span>
<span class=sd>        it fired at least one spike.</span>
<span class=sd>    time : array of np.array(dtype=np.float64)</span>
<span class=sd>        Spike time data in seconds. Array of length n_units, each entry with</span>
<span class=sd>        shape (n_spikes,). Alias for data.</span>
<span class=sd>    n_spikes : np.ndarray</span>
<span class=sd>        The number of spikes in each unit. Alias for n_events.</span>
<span class=sd>    issorted : bool</span>
<span class=sd>        Whether the spike times are sorted.</span>
<span class=sd>    first_spike : float</span>
<span class=sd>        The time of the very first spike, across all units.</span>
<span class=sd>    last_spike : float</span>
<span class=sd>        The time of the very last spike, across all units.</span>
<span class=sd>    unit_ids : list of int</span>
<span class=sd>        Unit IDs. Alias for series_ids.</span>
<span class=sd>    unit_labels : list of str</span>
<span class=sd>        Labels corresponding to units. Alias for series_labels.</span>
<span class=sd>    unit_tags :</span>
<span class=sd>        Tags corresponding to units. Alias for series_tags.</span>
<span class=sd>    n_epochs : int</span>
<span class=sd>        The number of epochs/intervals. Alias for n_intervals.</span>
<span class=sd>    support : IntervalArray</span>
<span class=sd>        The support of the SpikeTrainArray.</span>
<span class=sd>    fs : float</span>
<span class=sd>        Sampling frequency (Hz).</span>
<span class=sd>    label : str or None</span>
<span class=sd>        Information pertaining to the source of the spike train array.</span>

<span class=sd>    Methods</span>
<span class=sd>    -------</span>
<span class=sd>    bin(ds=None)</span>
<span class=sd>        Return a BinnedSpikeTrainArray.</span>
<span class=sd>    get_spike_firing_order()</span>
<span class=sd>        Returns unit_ids ordered by when they first fire.</span>
<span class=sd>    reorder_units_by_ids(neworder, inplace=False)</span>
<span class=sd>        Reorder units according to specified unit_ids.</span>
<span class=sd>    flatten(unit_id=None, unit_label=None)</span>
<span class=sd>        Collapse spikes across units into a single unit.</span>
<span class=sd>    partition(ds=None, n_epochs=None)</span>
<span class=sd>        Returns a SpikeTrainArray whose support has been partitioned.</span>
<span class=sd>    copy()</span>
<span class=sd>        Returns a copy of the SpikeTrainArray.</span>
<span class=sd>    empty(inplace=False)</span>
<span class=sd>        Remove data (but not metadata) from SpikeTrainArray.</span>

<span class=sd>    Examples</span>
<span class=sd>    --------</span>
<span class=sd>    Create a SpikeTrainArray with two units:</span>

<span class=sd>    &gt;&gt;&gt; import numpy as np</span>
<span class=sd>    &gt;&gt;&gt; spike_times = [np.array([0.1, 0.3, 0.7]), np.array([0.2, 0.5, 0.8])]</span>
<span class=sd>    &gt;&gt;&gt; sta = SpikeTrainArray(spike_times, unit_ids=[1, 2], fs=1000)</span>
<span class=sd>    &gt;&gt;&gt; print(sta.n_units)</span>
<span class=sd>    2</span>
<span class=sd>    &gt;&gt;&gt; print(sta.n_spikes)</span>
<span class=sd>    [3 3]</span>

<span class=sd>    Access spike times using the time alias:</span>

<span class=sd>    &gt;&gt;&gt; print(sta.time[0])  # First unit&#39;s spike times</span>
<span class=sd>    [0.1 0.3 0.7]</span>

<span class=sd>    Create a binned version:</span>

<span class=sd>    &gt;&gt;&gt; binned = sta.bin(ds=0.1)  # 100ms bins</span>

<span class=sd>    Notes</span>
<span class=sd>    -----</span>
<span class=sd>    SpikeTrainArray provides neuroscience-specific aliases for EventArray</span>
<span class=sd>    functionality. For example, &#39;units&#39; instead of &#39;series&#39;, &#39;spikes&#39; instead</span>
<span class=sd>    of &#39;events&#39;, and &#39;time&#39; instead of &#39;data&#39;. This makes the API more intuitive</span>
<span class=sd>    for neuroscience applications while maintaining full compatibility with the</span>
<span class=sd>    underlying EventArray infrastructure.</span>

<span class=sd>    The class automatically handles spike time sorting and provides efficient</span>
<span class=sd>    methods for common spike train analyses. All spike times are stored in</span>
<span class=sd>    seconds and should be non-negative values within the support interval.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=c1># specify class-specific aliases:</span>
    <span class=n>__aliases__</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&quot;time&quot;</span><span class=p>:</span> <span class=s2>&quot;data&quot;</span><span class=p>,</span>
        <span class=s2>&quot;_time&quot;</span><span class=p>:</span> <span class=s2>&quot;_data&quot;</span><span class=p>,</span>
        <span class=s2>&quot;n_epochs&quot;</span><span class=p>:</span> <span class=s2>&quot;n_intervals&quot;</span><span class=p>,</span>
        <span class=s2>&quot;n_units&quot;</span><span class=p>:</span> <span class=s2>&quot;n_series&quot;</span><span class=p>,</span>
        <span class=s2>&quot;_unit_subset&quot;</span><span class=p>:</span> <span class=s2>&quot;_series_subset&quot;</span><span class=p>,</span>  <span class=c1># requires kw change</span>
        <span class=s2>&quot;get_event_firing_order&quot;</span><span class=p>:</span> <span class=s2>&quot;get_spike_firing_order&quot;</span><span class=p>,</span>
        <span class=s2>&quot;reorder_units_by_ids&quot;</span><span class=p>:</span> <span class=s2>&quot;reorder_series_by_ids&quot;</span><span class=p>,</span>
        <span class=s2>&quot;reorder_units&quot;</span><span class=p>:</span> <span class=s2>&quot;reorder_series&quot;</span><span class=p>,</span>
        <span class=s2>&quot;_reorder_units_by_idx&quot;</span><span class=p>:</span> <span class=s2>&quot;_reorder_series_by_idx&quot;</span><span class=p>,</span>
        <span class=s2>&quot;n_spikes&quot;</span><span class=p>:</span> <span class=s2>&quot;n_events&quot;</span><span class=p>,</span>
        <span class=s2>&quot;unit_ids&quot;</span><span class=p>:</span> <span class=s2>&quot;series_ids&quot;</span><span class=p>,</span>
        <span class=s2>&quot;unit_labels&quot;</span><span class=p>:</span> <span class=s2>&quot;series_labels&quot;</span><span class=p>,</span>
        <span class=s2>&quot;unit_tags&quot;</span><span class=p>:</span> <span class=s2>&quot;series_tags&quot;</span><span class=p>,</span>
        <span class=s2>&quot;_unit_ids&quot;</span><span class=p>:</span> <span class=s2>&quot;_series_ids&quot;</span><span class=p>,</span>
        <span class=s2>&quot;_unit_labels&quot;</span><span class=p>:</span> <span class=s2>&quot;_series_labels&quot;</span><span class=p>,</span>
        <span class=s2>&quot;_unit_tags&quot;</span><span class=p>:</span> <span class=s2>&quot;_series_tags&quot;</span><span class=p>,</span>
        <span class=s2>&quot;first_spike&quot;</span><span class=p>:</span> <span class=s2>&quot;first_event&quot;</span><span class=p>,</span>
        <span class=s2>&quot;last_spike&quot;</span><span class=p>:</span> <span class=s2>&quot;last_event&quot;</span><span class=p>,</span>
    <span class=p>}</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
        <span class=c1># add class-specific aliases to existing aliases:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>__aliases__</span> <span class=o>=</span> <span class=p>{</span><span class=o>**</span><span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>__aliases__</span><span class=p>,</span> <span class=o>**</span><span class=bp>self</span><span class=o>.</span><span class=n>__aliases__</span><span class=p>}</span>

        <span class=n>series_label</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;series_label&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>series_label</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>series_label</span> <span class=o>=</span> <span class=s2>&quot;units&quot;</span>
        <span class=n>kwargs</span><span class=p>[</span><span class=s2>&quot;series_label&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>series_label</span>

        <span class=c1># legacy STA constructor support for backward compatibility</span>
        <span class=n>kwargs</span> <span class=o>=</span> <span class=n>legacySTAkwargs</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>

        <span class=n>support</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;support&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>support</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>abscissa</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;abscissa&quot;</span><span class=p>,</span> <span class=n>core</span><span class=o>.</span><span class=n>TemporalAbscissa</span><span class=p>(</span><span class=n>support</span><span class=o>=</span><span class=n>support</span><span class=p>))</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>abscissa</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;abscissa&quot;</span><span class=p>,</span> <span class=n>core</span><span class=o>.</span><span class=n>TemporalAbscissa</span><span class=p>())</span>
        <span class=n>ordinate</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;ordinate&quot;</span><span class=p>,</span> <span class=n>core</span><span class=o>.</span><span class=n>AnalogSignalArrayOrdinate</span><span class=p>())</span>

        <span class=n>kwargs</span><span class=p>[</span><span class=s2>&quot;abscissa&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>abscissa</span>
        <span class=n>kwargs</span><span class=p>[</span><span class=s2>&quot;ordinate&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>ordinate</span>

        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>

    <span class=c1># @keyword_equivalence(this_or_that={&#39;n_intervals&#39;:&#39;n_epochs&#39;})</span>
    <span class=c1># def partition(self, ds=None, n_intervals=None, n_epochs=None):</span>
    <span class=c1>#     if n_intervals is None:</span>
    <span class=c1>#         n_intervals = n_epochs</span>
    <span class=c1>#     kwargs = {&#39;ds&#39;:ds, &#39;n_intervals&#39;: n_intervals}</span>
    <span class=c1>#     return super().partition(**kwargs)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>bin</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>ds</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Return a BinnedSpikeTrainArray.&quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=n>BinnedSpikeTrainArray</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ds</span><span class=o>=</span><span class=n>ds</span><span class=p>)</span>  <span class=c1># TODO #FIXME</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=nelpy.core._eventarray.SpikeTrainArray.bin class="doc doc-heading"> <code class="highlight language-python"><span class=nb>bin</span><span class=p>(</span><span class=o>*</span><span class=p>,</span> <span class=n>ds</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Return a BinnedSpikeTrainArray.</p> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2431</span>
<span class=normal>2432</span>
<span class=normal>2433</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>bin</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>ds</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return a BinnedSpikeTrainArray.&quot;&quot;&quot;</span>
    <span class=k>return</span> <span class=n>BinnedSpikeTrainArray</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ds</span><span class=o>=</span><span class=n>ds</span><span class=p>)</span>  <span class=c1># TODO #FIXME</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-function"> <h2 id=nelpy.core._eventarray.legacySTAkwargs class="doc doc-heading"> <code class="highlight language-python"><span class=n>legacySTAkwargs</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Provide support for legacy SpikeTrainArray kwargs. This function is primarily intended to be a helper for the new STA constructor, not for general-purpose use.</p> <p>kwarg: time &lt;==&gt; timestamps &lt;==&gt; abscissa_vals kwarg: data &lt;==&gt; ydata kwarg: unit_ids &lt;==&gt; series_ids kwarg: unit_labels &lt;==&gt; series_labels kwarg: unit_tags &lt;==&gt; series_tags</p> <p><span class=doc-section-title>Examples:</span></p> <p>sta = nel.SpikeTrainArray(time=..., ) sta = nel.SpikeTrainArray(timestamps=..., ) sta = nel.SpikeTrainArray(abscissa_vals=..., )</p> <details class=quote> <summary>Source code in <code>nelpy/core/_eventarray.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2197</span>
<span class=normal>2198</span>
<span class=normal>2199</span>
<span class=normal>2200</span>
<span class=normal>2201</span>
<span class=normal>2202</span>
<span class=normal>2203</span>
<span class=normal>2204</span>
<span class=normal>2205</span>
<span class=normal>2206</span>
<span class=normal>2207</span>
<span class=normal>2208</span>
<span class=normal>2209</span>
<span class=normal>2210</span>
<span class=normal>2211</span>
<span class=normal>2212</span>
<span class=normal>2213</span>
<span class=normal>2214</span>
<span class=normal>2215</span>
<span class=normal>2216</span>
<span class=normal>2217</span>
<span class=normal>2218</span>
<span class=normal>2219</span>
<span class=normal>2220</span>
<span class=normal>2221</span>
<span class=normal>2222</span>
<span class=normal>2223</span>
<span class=normal>2224</span>
<span class=normal>2225</span>
<span class=normal>2226</span>
<span class=normal>2227</span>
<span class=normal>2228</span>
<span class=normal>2229</span>
<span class=normal>2230</span>
<span class=normal>2231</span>
<span class=normal>2232</span>
<span class=normal>2233</span>
<span class=normal>2234</span>
<span class=normal>2235</span>
<span class=normal>2236</span>
<span class=normal>2237</span>
<span class=normal>2238</span>
<span class=normal>2239</span>
<span class=normal>2240</span>
<span class=normal>2241</span>
<span class=normal>2242</span>
<span class=normal>2243</span>
<span class=normal>2244</span>
<span class=normal>2245</span>
<span class=normal>2246</span>
<span class=normal>2247</span>
<span class=normal>2248</span>
<span class=normal>2249</span>
<span class=normal>2250</span>
<span class=normal>2251</span>
<span class=normal>2252</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>legacySTAkwargs</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Provide support for legacy SpikeTrainArray</span>
<span class=sd>    kwargs. This function is primarily intended to be</span>
<span class=sd>    a helper for the new STA constructor, not for</span>
<span class=sd>    general-purpose use.</span>

<span class=sd>    kwarg: time        &lt;==&gt; timestamps &lt;==&gt; abscissa_vals</span>
<span class=sd>    kwarg: data        &lt;==&gt; ydata</span>
<span class=sd>    kwarg: unit_ids    &lt;==&gt; series_ids</span>
<span class=sd>    kwarg: unit_labels &lt;==&gt; series_labels</span>
<span class=sd>    kwarg: unit_tags   &lt;==&gt; series_tags</span>

<span class=sd>    Examples</span>
<span class=sd>    --------</span>
<span class=sd>    sta = nel.SpikeTrainArray(time=..., )</span>
<span class=sd>    sta = nel.SpikeTrainArray(timestamps=..., )</span>
<span class=sd>    sta = nel.SpikeTrainArray(abscissa_vals=..., )</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>def</span><span class=w> </span><span class=nf>only_one_of</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>):</span>
        <span class=n>num_non_null_args</span> <span class=o>=</span> <span class=mi>0</span>
        <span class=n>out</span> <span class=o>=</span> <span class=kc>None</span>
        <span class=k>for</span> <span class=n>arg</span> <span class=ow>in</span> <span class=n>args</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>arg</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                <span class=n>num_non_null_args</span> <span class=o>+=</span> <span class=mi>1</span>
                <span class=n>out</span> <span class=o>=</span> <span class=n>arg</span>
        <span class=k>if</span> <span class=n>num_non_null_args</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;multiple conflicting arguments received&quot;</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>out</span>

    <span class=c1># legacy STA constructor support for backward compatibility</span>
    <span class=n>abscissa_vals</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;abscissa_vals&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
    <span class=n>timestamps</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;timestamps&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
    <span class=n>time</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;time&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
    <span class=c1># only one of the above, otherwise raise exception</span>
    <span class=n>abscissa_vals</span> <span class=o>=</span> <span class=n>only_one_of</span><span class=p>(</span><span class=n>abscissa_vals</span><span class=p>,</span> <span class=n>timestamps</span><span class=p>,</span> <span class=n>time</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>abscissa_vals</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>kwargs</span><span class=p>[</span><span class=s2>&quot;abscissa_vals&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>abscissa_vals</span>

    <span class=c1># Other legacy attributes</span>
    <span class=n>series_ids</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;series_ids&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
    <span class=n>unit_ids</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;unit_ids&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
    <span class=n>series_ids</span> <span class=o>=</span> <span class=n>only_one_of</span><span class=p>(</span><span class=n>series_ids</span><span class=p>,</span> <span class=n>unit_ids</span><span class=p>)</span>
    <span class=n>kwargs</span><span class=p>[</span><span class=s2>&quot;series_ids&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>series_ids</span>

    <span class=n>series_labels</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;series_labels&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
    <span class=n>unit_labels</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;unit_labels&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
    <span class=n>series_labels</span> <span class=o>=</span> <span class=n>only_one_of</span><span class=p>(</span><span class=n>series_labels</span><span class=p>,</span> <span class=n>unit_labels</span><span class=p>)</span>
    <span class=n>kwargs</span><span class=p>[</span><span class=s2>&quot;series_labels&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>series_labels</span>

    <span class=n>series_tags</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;series_tags&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
    <span class=n>unit_tags</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;unit_tags&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
    <span class=n>series_tags</span> <span class=o>=</span> <span class=n>only_one_of</span><span class=p>(</span><span class=n>series_tags</span><span class=p>,</span> <span class=n>unit_tags</span><span class=p>)</span>
    <span class=n>kwargs</span><span class=p>[</span><span class=s2>&quot;series_tags&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>series_tags</span>

    <span class=k>return</span> <span class=n>kwargs</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../../.. class="md-footer__link md-footer__link--prev" aria-label="Previous: Home"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Home </div> </div> </a> <a href=../analogsignalarray/ class="md-footer__link md-footer__link--next" aria-label="Next: AnalogSignalArray"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> AnalogSignalArray </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "content.tabs.link", "navigation.footer", "navigation.indexes", "navigation.instant.prefetch", "navigation.instant.preview", "navigation.instant.progress", "navigation.path", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../../assets/javascripts/bundle.50899def.min.js></script> </body> </html>