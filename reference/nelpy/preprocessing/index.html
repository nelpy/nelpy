<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.16"><title>nelpy.preprocessing - nelpy</title><link rel=stylesheet href=../../../assets/stylesheets/main.7e37652d.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../stylesheets/extra.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#nelpy.preprocessing class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=nelpy class="md-header__button md-logo" aria-label=nelpy data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> nelpy </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> nelpy.preprocessing </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=light data-md-color-primary=custom data-md-color-accent=custom aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=blue aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/nelpy/nelpy title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> nelpy/nelpy </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../core/eventarray/ class=md-tabs__link> API Reference </a> </li> <li class=md-tabs__item> <a href=../../../tutorials/GettingStarted/ class=md-tabs__link> Tutorials </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=nelpy class="md-nav__button md-logo" aria-label=nelpy data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> nelpy </label> <div class=md-nav__source> <a href=https://github.com/nelpy/nelpy title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> nelpy/nelpy </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> API Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> API Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../core/eventarray/ class=md-nav__link> <span class=md-ellipsis> EventArray </span> </a> </li> <li class=md-nav__item> <a href=../../core/analogsignalarray/ class=md-nav__link> <span class=md-ellipsis> AnalogSignalArray </span> </a> </li> <li class=md-nav__item> <a href=../../core/intervalarray/ class=md-nav__link> <span class=md-ellipsis> IntervalArray </span> </a> </li> <li class=md-nav__item> <a href=../../core/valeventarray/ class=md-nav__link> <span class=md-ellipsis> ValeventArray </span> </a> </li> <li class=md-nav__item> <a href=../../core/coordinates/ class=md-nav__link> <span class=md-ellipsis> Coordinates </span> </a> </li> <li class=md-nav__item> <a href=../../analysis/ class=md-nav__link> <span class=md-ellipsis> Analysis </span> </a> </li> <li class=md-nav__item> <a href=../../auxiliary/ class=md-nav__link> <span class=md-ellipsis> Auxiliary </span> </a> </li> <li class=md-nav__item> <a href=../../decoding/ class=md-nav__link> <span class=md-ellipsis> Decoding </span> </a> </li> <li class=md-nav__item> <a href=../../plotting/ class=md-nav__link> <span class=md-ellipsis> Plotting </span> </a> </li> <li class=md-nav__item> <a href=../../utils/ class=md-nav__link> <span class=md-ellipsis> Utilities </span> </a> </li> <li class=md-nav__item> <a href=../../estimators/ class=md-nav__link> <span class=md-ellipsis> Estimators </span> </a> </li> <li class=md-nav__item> <a href=../../filtering/ class=md-nav__link> <span class=md-ellipsis> Filtering </span> </a> </li> <li class=md-nav__item> <a href=../../preprocessing/ class=md-nav__link> <span class=md-ellipsis> Preprocessing </span> </a> </li> <li class=md-nav__item> <a href=../../hmmutils/ class=md-nav__link> <span class=md-ellipsis> HMM Utils </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tutorials/GettingStarted/ class=md-nav__link> <span class=md-ellipsis> Getting Started </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/AnalogSignalArrayTutorial/ class=md-nav__link> <span class=md-ellipsis> AnalogSignalArray Tutorial </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/EpochArrayTutorial/ class=md-nav__link> <span class=md-ellipsis> EpochArray Tutorial </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/LinearTrackDemo/ class=md-nav__link> <span class=md-ellipsis> Linear Track Demo </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/SpikeTrainSmoothing/ class=md-nav__link> <span class=md-ellipsis> SpikeTrain Smoothing </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/plotting/ class=md-nav__link> <span class=md-ellipsis> plotting </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/WMazeDemo/ class=md-nav__link> <span class=md-ellipsis> WMaze Demo </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/BackyardBrainsEEG/ class=md-nav__link> <span class=md-ellipsis> Backyard Brains EEG </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/develop/ class=md-nav__link> <span class=md-ellipsis> develop </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#nelpy.preprocessing class=md-nav__link> <span class=md-ellipsis> preprocessing </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.preprocessing.DataWindow class=md-nav__link> <span class=md-ellipsis> DataWindow </span> </a> <nav class=md-nav aria-label=DataWindow> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nelpy.preprocessing.DataWindow--implicit-bin-size-of-1-second-centered-window-of-duration-5-seconds-stride-of-2-seconds class=md-nav__link> <span class=md-ellipsis> Implicit bin size of 1 second, centered window of duration 5 seconds, stride of 2 seconds: </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.preprocessing.DataWindow--excplicit-bin-size-of-1-second-centered-window-of-duration-5-seconds-stride-of-2-seconds class=md-nav__link> <span class=md-ellipsis> Excplicit bin size of 1 second, centered window of duration 5 seconds, stride of 2 seconds: </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.preprocessing.DataWindow.fit class=md-nav__link> <span class=md-ellipsis> fit </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.preprocessing.DataWindow.stream class=md-nav__link> <span class=md-ellipsis> stream </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.preprocessing.DataWindow.transform class=md-nav__link> <span class=md-ellipsis> transform </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#nelpy.preprocessing.StandardScaler class=md-nav__link> <span class=md-ellipsis> StandardScaler </span> </a> <nav class=md-nav aria-label=StandardScaler> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nelpy.preprocessing.StandardScaler.fit class=md-nav__link> <span class=md-ellipsis> fit </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.preprocessing.StandardScaler.inverse_transform class=md-nav__link> <span class=md-ellipsis> inverse_transform </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.preprocessing.StandardScaler.partial_fit class=md-nav__link> <span class=md-ellipsis> partial_fit </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.preprocessing.StandardScaler.transform class=md-nav__link> <span class=md-ellipsis> transform </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#nelpy.preprocessing.StreamingDataWindow class=md-nav__link> <span class=md-ellipsis> StreamingDataWindow </span> </a> </li> <li class=md-nav__item> <a href=#nelpy.preprocessing.standardize_asa class=md-nav__link> <span class=md-ellipsis> standardize_asa </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/nelpy/nelpy/edit/master/docs/nelpy/preprocessing.py title="Edit this page" class="md-content__button md-icon" rel=edit> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <a href=https://github.com/nelpy/nelpy/raw/master/docs/nelpy/preprocessing.py title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg> </a> <h1>nelpy.preprocessing</h1> <div class="doc doc-object doc-module"> <a id=nelpy.preprocessing></a> <div class="doc doc-contents first"> <p>Data preprocessing objects and functions.</p> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 id=nelpy.preprocessing.DataWindow class="doc doc-heading"> <code>DataWindow</code> </h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=sklearn.base.BaseEstimator>BaseEstimator</span></code></p> <p>DataWindow Data window description to describe stride and/or data aggregation.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>bins_before</code> </td> <td> <code>(<span title=int>int</span>, <span title=optional>optional</span>(default=0))</code> </td> <td> <div class=doc-md-description> <p>How many bins before the output to include in the window.</p> </div> </td> <td> <code>0</code> </td> </tr> <tr class=doc-section-item> <td> <code>bins_after</code> </td> <td> <code>(<span title=int>int</span>, <span title=optional>optional</span>(default=0))</code> </td> <td> <div class=doc-md-description> <p>How many bins after the output to include in the window.</p> </div> </td> <td> <code>0</code> </td> </tr> <tr class=doc-section-item> <td> <code>bins_current</code> </td> <td> <code>(<span title=int>int</span>, <span title=optional>optional</span>(default=1))</code> </td> <td> <div class=doc-md-description> <p>Whether (1) or not (0) to include the concurrent bin in the window.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>bins_stride</code> </td> <td> <code>(<span title=int>int</span>, <span title=optional>optional</span>(default=1))</code> </td> <td> <div class=doc-md-description> <p>Number of bins to advance the window during each time step.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>bin_width</code> </td> <td> <code>(<span title=float>float</span>, <span title=optional>optional</span>(default=None))</code> </td> <td> <div class=doc-md-description> <p>Width of single bin (default units are in seconds).</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>w</span> <span class=o>=</span> <span class=n>DataWindow</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<span class=go>DataWindow(bins_before=1, bins_after=1, bins_current=1, bins_stride=1, bin_width=None)</span>
</code></pre></div> <h3 id=nelpy.preprocessing.DataWindow--implicit-bin-size-of-1-second-centered-window-of-duration-5-seconds-stride-of-2-seconds>Implicit bin size of 1 second, centered window of duration 5 seconds, stride of 2 seconds:</h3> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>w</span> <span class=o>=</span> <span class=n>DataWindow</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
<span class=go>DataWindow(bins_before=2, bins_after=2, bins_current=1, bins_stride=2)</span>
</code></pre></div> <h3 id=nelpy.preprocessing.DataWindow--excplicit-bin-size-of-1-second-centered-window-of-duration-5-seconds-stride-of-2-seconds>Excplicit bin size of 1 second, centered window of duration 5 seconds, stride of 2 seconds:</h3> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>w</span> <span class=o>=</span> <span class=n>DataWindow</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<span class=go>DataWindow(bins_before=2, bins_after=2, bins_current=1, bins_stride=2, bin_width=1)</span>
<span class=go>        Total bin width = 5 seconds</span>
</code></pre></div> <details class=quote> <summary>Source code in <code>nelpy/preprocessing.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>169</span>
<span class=normal>170</span>
<span class=normal>171</span>
<span class=normal>172</span>
<span class=normal>173</span>
<span class=normal>174</span>
<span class=normal>175</span>
<span class=normal>176</span>
<span class=normal>177</span>
<span class=normal>178</span>
<span class=normal>179</span>
<span class=normal>180</span>
<span class=normal>181</span>
<span class=normal>182</span>
<span class=normal>183</span>
<span class=normal>184</span>
<span class=normal>185</span>
<span class=normal>186</span>
<span class=normal>187</span>
<span class=normal>188</span>
<span class=normal>189</span>
<span class=normal>190</span>
<span class=normal>191</span>
<span class=normal>192</span>
<span class=normal>193</span>
<span class=normal>194</span>
<span class=normal>195</span>
<span class=normal>196</span>
<span class=normal>197</span>
<span class=normal>198</span>
<span class=normal>199</span>
<span class=normal>200</span>
<span class=normal>201</span>
<span class=normal>202</span>
<span class=normal>203</span>
<span class=normal>204</span>
<span class=normal>205</span>
<span class=normal>206</span>
<span class=normal>207</span>
<span class=normal>208</span>
<span class=normal>209</span>
<span class=normal>210</span>
<span class=normal>211</span>
<span class=normal>212</span>
<span class=normal>213</span>
<span class=normal>214</span>
<span class=normal>215</span>
<span class=normal>216</span>
<span class=normal>217</span>
<span class=normal>218</span>
<span class=normal>219</span>
<span class=normal>220</span>
<span class=normal>221</span>
<span class=normal>222</span>
<span class=normal>223</span>
<span class=normal>224</span>
<span class=normal>225</span>
<span class=normal>226</span>
<span class=normal>227</span>
<span class=normal>228</span>
<span class=normal>229</span>
<span class=normal>230</span>
<span class=normal>231</span>
<span class=normal>232</span>
<span class=normal>233</span>
<span class=normal>234</span>
<span class=normal>235</span>
<span class=normal>236</span>
<span class=normal>237</span>
<span class=normal>238</span>
<span class=normal>239</span>
<span class=normal>240</span>
<span class=normal>241</span>
<span class=normal>242</span>
<span class=normal>243</span>
<span class=normal>244</span>
<span class=normal>245</span>
<span class=normal>246</span>
<span class=normal>247</span>
<span class=normal>248</span>
<span class=normal>249</span>
<span class=normal>250</span>
<span class=normal>251</span>
<span class=normal>252</span>
<span class=normal>253</span>
<span class=normal>254</span>
<span class=normal>255</span>
<span class=normal>256</span>
<span class=normal>257</span>
<span class=normal>258</span>
<span class=normal>259</span>
<span class=normal>260</span>
<span class=normal>261</span>
<span class=normal>262</span>
<span class=normal>263</span>
<span class=normal>264</span>
<span class=normal>265</span>
<span class=normal>266</span>
<span class=normal>267</span>
<span class=normal>268</span>
<span class=normal>269</span>
<span class=normal>270</span>
<span class=normal>271</span>
<span class=normal>272</span>
<span class=normal>273</span>
<span class=normal>274</span>
<span class=normal>275</span>
<span class=normal>276</span>
<span class=normal>277</span>
<span class=normal>278</span>
<span class=normal>279</span>
<span class=normal>280</span>
<span class=normal>281</span>
<span class=normal>282</span>
<span class=normal>283</span>
<span class=normal>284</span>
<span class=normal>285</span>
<span class=normal>286</span>
<span class=normal>287</span>
<span class=normal>288</span>
<span class=normal>289</span>
<span class=normal>290</span>
<span class=normal>291</span>
<span class=normal>292</span>
<span class=normal>293</span>
<span class=normal>294</span>
<span class=normal>295</span>
<span class=normal>296</span>
<span class=normal>297</span>
<span class=normal>298</span>
<span class=normal>299</span>
<span class=normal>300</span>
<span class=normal>301</span>
<span class=normal>302</span>
<span class=normal>303</span>
<span class=normal>304</span>
<span class=normal>305</span>
<span class=normal>306</span>
<span class=normal>307</span>
<span class=normal>308</span>
<span class=normal>309</span>
<span class=normal>310</span>
<span class=normal>311</span>
<span class=normal>312</span>
<span class=normal>313</span>
<span class=normal>314</span>
<span class=normal>315</span>
<span class=normal>316</span>
<span class=normal>317</span>
<span class=normal>318</span>
<span class=normal>319</span>
<span class=normal>320</span>
<span class=normal>321</span>
<span class=normal>322</span>
<span class=normal>323</span>
<span class=normal>324</span>
<span class=normal>325</span>
<span class=normal>326</span>
<span class=normal>327</span>
<span class=normal>328</span>
<span class=normal>329</span>
<span class=normal>330</span>
<span class=normal>331</span>
<span class=normal>332</span>
<span class=normal>333</span>
<span class=normal>334</span>
<span class=normal>335</span>
<span class=normal>336</span>
<span class=normal>337</span>
<span class=normal>338</span>
<span class=normal>339</span>
<span class=normal>340</span>
<span class=normal>341</span>
<span class=normal>342</span>
<span class=normal>343</span>
<span class=normal>344</span>
<span class=normal>345</span>
<span class=normal>346</span>
<span class=normal>347</span>
<span class=normal>348</span>
<span class=normal>349</span>
<span class=normal>350</span>
<span class=normal>351</span>
<span class=normal>352</span>
<span class=normal>353</span>
<span class=normal>354</span>
<span class=normal>355</span>
<span class=normal>356</span>
<span class=normal>357</span>
<span class=normal>358</span>
<span class=normal>359</span>
<span class=normal>360</span>
<span class=normal>361</span>
<span class=normal>362</span>
<span class=normal>363</span>
<span class=normal>364</span>
<span class=normal>365</span>
<span class=normal>366</span>
<span class=normal>367</span>
<span class=normal>368</span>
<span class=normal>369</span>
<span class=normal>370</span>
<span class=normal>371</span>
<span class=normal>372</span>
<span class=normal>373</span>
<span class=normal>374</span>
<span class=normal>375</span>
<span class=normal>376</span>
<span class=normal>377</span>
<span class=normal>378</span>
<span class=normal>379</span>
<span class=normal>380</span>
<span class=normal>381</span>
<span class=normal>382</span>
<span class=normal>383</span>
<span class=normal>384</span>
<span class=normal>385</span>
<span class=normal>386</span>
<span class=normal>387</span>
<span class=normal>388</span>
<span class=normal>389</span>
<span class=normal>390</span>
<span class=normal>391</span>
<span class=normal>392</span>
<span class=normal>393</span>
<span class=normal>394</span>
<span class=normal>395</span>
<span class=normal>396</span>
<span class=normal>397</span>
<span class=normal>398</span>
<span class=normal>399</span>
<span class=normal>400</span>
<span class=normal>401</span>
<span class=normal>402</span>
<span class=normal>403</span>
<span class=normal>404</span>
<span class=normal>405</span>
<span class=normal>406</span>
<span class=normal>407</span>
<span class=normal>408</span>
<span class=normal>409</span>
<span class=normal>410</span>
<span class=normal>411</span>
<span class=normal>412</span>
<span class=normal>413</span>
<span class=normal>414</span>
<span class=normal>415</span>
<span class=normal>416</span>
<span class=normal>417</span>
<span class=normal>418</span>
<span class=normal>419</span>
<span class=normal>420</span>
<span class=normal>421</span>
<span class=normal>422</span>
<span class=normal>423</span>
<span class=normal>424</span>
<span class=normal>425</span>
<span class=normal>426</span>
<span class=normal>427</span>
<span class=normal>428</span>
<span class=normal>429</span>
<span class=normal>430</span>
<span class=normal>431</span>
<span class=normal>432</span>
<span class=normal>433</span>
<span class=normal>434</span>
<span class=normal>435</span>
<span class=normal>436</span>
<span class=normal>437</span>
<span class=normal>438</span>
<span class=normal>439</span>
<span class=normal>440</span>
<span class=normal>441</span>
<span class=normal>442</span>
<span class=normal>443</span>
<span class=normal>444</span>
<span class=normal>445</span>
<span class=normal>446</span>
<span class=normal>447</span>
<span class=normal>448</span>
<span class=normal>449</span>
<span class=normal>450</span>
<span class=normal>451</span>
<span class=normal>452</span>
<span class=normal>453</span>
<span class=normal>454</span>
<span class=normal>455</span>
<span class=normal>456</span>
<span class=normal>457</span>
<span class=normal>458</span>
<span class=normal>459</span>
<span class=normal>460</span>
<span class=normal>461</span>
<span class=normal>462</span>
<span class=normal>463</span>
<span class=normal>464</span>
<span class=normal>465</span>
<span class=normal>466</span>
<span class=normal>467</span>
<span class=normal>468</span>
<span class=normal>469</span>
<span class=normal>470</span>
<span class=normal>471</span>
<span class=normal>472</span>
<span class=normal>473</span>
<span class=normal>474</span>
<span class=normal>475</span>
<span class=normal>476</span>
<span class=normal>477</span>
<span class=normal>478</span>
<span class=normal>479</span>
<span class=normal>480</span>
<span class=normal>481</span>
<span class=normal>482</span>
<span class=normal>483</span>
<span class=normal>484</span>
<span class=normal>485</span>
<span class=normal>486</span>
<span class=normal>487</span>
<span class=normal>488</span>
<span class=normal>489</span>
<span class=normal>490</span>
<span class=normal>491</span>
<span class=normal>492</span>
<span class=normal>493</span>
<span class=normal>494</span>
<span class=normal>495</span>
<span class=normal>496</span>
<span class=normal>497</span>
<span class=normal>498</span>
<span class=normal>499</span>
<span class=normal>500</span>
<span class=normal>501</span>
<span class=normal>502</span>
<span class=normal>503</span>
<span class=normal>504</span>
<span class=normal>505</span>
<span class=normal>506</span>
<span class=normal>507</span>
<span class=normal>508</span>
<span class=normal>509</span>
<span class=normal>510</span>
<span class=normal>511</span>
<span class=normal>512</span>
<span class=normal>513</span>
<span class=normal>514</span>
<span class=normal>515</span>
<span class=normal>516</span>
<span class=normal>517</span>
<span class=normal>518</span>
<span class=normal>519</span>
<span class=normal>520</span>
<span class=normal>521</span>
<span class=normal>522</span>
<span class=normal>523</span>
<span class=normal>524</span>
<span class=normal>525</span>
<span class=normal>526</span>
<span class=normal>527</span>
<span class=normal>528</span>
<span class=normal>529</span>
<span class=normal>530</span>
<span class=normal>531</span>
<span class=normal>532</span>
<span class=normal>533</span>
<span class=normal>534</span>
<span class=normal>535</span>
<span class=normal>536</span>
<span class=normal>537</span>
<span class=normal>538</span>
<span class=normal>539</span>
<span class=normal>540</span>
<span class=normal>541</span>
<span class=normal>542</span>
<span class=normal>543</span>
<span class=normal>544</span>
<span class=normal>545</span>
<span class=normal>546</span>
<span class=normal>547</span>
<span class=normal>548</span>
<span class=normal>549</span>
<span class=normal>550</span>
<span class=normal>551</span>
<span class=normal>552</span>
<span class=normal>553</span>
<span class=normal>554</span>
<span class=normal>555</span>
<span class=normal>556</span>
<span class=normal>557</span>
<span class=normal>558</span>
<span class=normal>559</span>
<span class=normal>560</span>
<span class=normal>561</span>
<span class=normal>562</span>
<span class=normal>563</span>
<span class=normal>564</span>
<span class=normal>565</span>
<span class=normal>566</span>
<span class=normal>567</span>
<span class=normal>568</span>
<span class=normal>569</span>
<span class=normal>570</span>
<span class=normal>571</span>
<span class=normal>572</span>
<span class=normal>573</span>
<span class=normal>574</span>
<span class=normal>575</span>
<span class=normal>576</span>
<span class=normal>577</span>
<span class=normal>578</span>
<span class=normal>579</span>
<span class=normal>580</span>
<span class=normal>581</span>
<span class=normal>582</span>
<span class=normal>583</span>
<span class=normal>584</span>
<span class=normal>585</span>
<span class=normal>586</span>
<span class=normal>587</span>
<span class=normal>588</span>
<span class=normal>589</span>
<span class=normal>590</span>
<span class=normal>591</span>
<span class=normal>592</span>
<span class=normal>593</span>
<span class=normal>594</span>
<span class=normal>595</span>
<span class=normal>596</span>
<span class=normal>597</span>
<span class=normal>598</span>
<span class=normal>599</span>
<span class=normal>600</span>
<span class=normal>601</span>
<span class=normal>602</span>
<span class=normal>603</span>
<span class=normal>604</span>
<span class=normal>605</span>
<span class=normal>606</span>
<span class=normal>607</span>
<span class=normal>608</span>
<span class=normal>609</span>
<span class=normal>610</span>
<span class=normal>611</span>
<span class=normal>612</span>
<span class=normal>613</span>
<span class=normal>614</span>
<span class=normal>615</span>
<span class=normal>616</span>
<span class=normal>617</span>
<span class=normal>618</span>
<span class=normal>619</span>
<span class=normal>620</span>
<span class=normal>621</span>
<span class=normal>622</span>
<span class=normal>623</span>
<span class=normal>624</span>
<span class=normal>625</span>
<span class=normal>626</span>
<span class=normal>627</span>
<span class=normal>628</span>
<span class=normal>629</span>
<span class=normal>630</span>
<span class=normal>631</span>
<span class=normal>632</span>
<span class=normal>633</span>
<span class=normal>634</span>
<span class=normal>635</span>
<span class=normal>636</span>
<span class=normal>637</span>
<span class=normal>638</span>
<span class=normal>639</span>
<span class=normal>640</span>
<span class=normal>641</span>
<span class=normal>642</span>
<span class=normal>643</span>
<span class=normal>644</span>
<span class=normal>645</span>
<span class=normal>646</span>
<span class=normal>647</span>
<span class=normal>648</span>
<span class=normal>649</span>
<span class=normal>650</span>
<span class=normal>651</span>
<span class=normal>652</span>
<span class=normal>653</span>
<span class=normal>654</span>
<span class=normal>655</span>
<span class=normal>656</span>
<span class=normal>657</span>
<span class=normal>658</span>
<span class=normal>659</span>
<span class=normal>660</span>
<span class=normal>661</span>
<span class=normal>662</span>
<span class=normal>663</span>
<span class=normal>664</span>
<span class=normal>665</span>
<span class=normal>666</span>
<span class=normal>667</span>
<span class=normal>668</span>
<span class=normal>669</span>
<span class=normal>670</span>
<span class=normal>671</span>
<span class=normal>672</span>
<span class=normal>673</span>
<span class=normal>674</span>
<span class=normal>675</span>
<span class=normal>676</span>
<span class=normal>677</span>
<span class=normal>678</span>
<span class=normal>679</span>
<span class=normal>680</span>
<span class=normal>681</span>
<span class=normal>682</span>
<span class=normal>683</span>
<span class=normal>684</span>
<span class=normal>685</span>
<span class=normal>686</span>
<span class=normal>687</span>
<span class=normal>688</span>
<span class=normal>689</span>
<span class=normal>690</span>
<span class=normal>691</span>
<span class=normal>692</span>
<span class=normal>693</span>
<span class=normal>694</span>
<span class=normal>695</span>
<span class=normal>696</span>
<span class=normal>697</span>
<span class=normal>698</span>
<span class=normal>699</span>
<span class=normal>700</span>
<span class=normal>701</span>
<span class=normal>702</span>
<span class=normal>703</span>
<span class=normal>704</span>
<span class=normal>705</span>
<span class=normal>706</span>
<span class=normal>707</span>
<span class=normal>708</span>
<span class=normal>709</span>
<span class=normal>710</span>
<span class=normal>711</span>
<span class=normal>712</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>DataWindow</span><span class=p>(</span><span class=n>BaseEstimator</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    DataWindow</span>
<span class=sd>    Data window description to describe stride and/or data aggregation.</span>

<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    bins_before : int, optional (default=0)</span>
<span class=sd>        How many bins before the output to include in the window.</span>
<span class=sd>    bins_after : int, optional (default=0)</span>
<span class=sd>        How many bins after the output to include in the window.</span>
<span class=sd>    bins_current : int, optional (default=1)</span>
<span class=sd>        Whether (1) or not (0) to include the concurrent bin in the window.</span>
<span class=sd>    bins_stride : int, optional (default=1)</span>
<span class=sd>        Number of bins to advance the window during each time step.</span>
<span class=sd>    bin_width : float, optional (default=None)</span>
<span class=sd>        Width of single bin (default units are in seconds).</span>

<span class=sd>    Examples</span>
<span class=sd>    --------</span>
<span class=sd>    &gt;&gt;&gt; w = DataWindow(1, 1, 1, 1)</span>
<span class=sd>    DataWindow(bins_before=1, bins_after=1, bins_current=1, bins_stride=1, bin_width=None)</span>

<span class=sd>    # Implicit bin size of 1 second, centered window of duration 5 seconds, stride of 2 seconds:</span>
<span class=sd>    &gt;&gt;&gt; w = DataWindow(2, 2, 1, 2)</span>
<span class=sd>    DataWindow(bins_before=2, bins_after=2, bins_current=1, bins_stride=2)</span>

<span class=sd>    # Excplicit bin size of 1 second, centered window of duration 5 seconds, stride of 2 seconds:</span>
<span class=sd>    &gt;&gt;&gt; w = DataWindow(2, 2, 1, 2, 1)</span>
<span class=sd>    DataWindow(bins_before=2, bins_after=2, bins_current=1, bins_stride=2, bin_width=1)</span>
<span class=sd>            Total bin width = 5 seconds</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>bins_before</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
        <span class=n>bins_after</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
        <span class=n>bins_current</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
        <span class=n>bins_stride</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
        <span class=n>bin_width</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>flatten</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
        <span class=nb>sum</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
    <span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>bins_before</span> <span class=o>=</span> <span class=n>bins_before</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>bins_after</span> <span class=o>=</span> <span class=n>bins_after</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>bins_current</span> <span class=o>=</span> <span class=n>bins_current</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>bins_stride</span> <span class=o>=</span> <span class=n>bins_stride</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>bin_width</span> <span class=o>=</span> <span class=n>bin_width</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_flatten</span> <span class=o>=</span> <span class=n>flatten</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_sum</span> <span class=o>=</span> <span class=nb>sum</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>bin_width</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>repr_string</span> <span class=o>=</span> <span class=s2>&quot;DataWindow(bins_before=</span><span class=si>{}</span><span class=s2>, bins_after=</span><span class=si>{}</span><span class=s2>, bins_current=</span><span class=si>{}</span><span class=s2>, bins_stride=</span><span class=si>{}</span><span class=s2>, bin_width=</span><span class=si>{}</span><span class=s2>)&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_bins_before</span><span class=p>,</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_bins_after</span><span class=p>,</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_bins_current</span><span class=p>,</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_bins_stride</span><span class=p>,</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_bin_width</span><span class=p>,</span>
            <span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>repr_string</span> <span class=o>=</span> <span class=s2>&quot;DataWindow(bins_before=</span><span class=si>{}</span><span class=s2>, bins_after=</span><span class=si>{}</span><span class=s2>, bins_current=</span><span class=si>{}</span><span class=s2>, bins_stride=</span><span class=si>{}</span><span class=s2>)&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_bins_before</span><span class=p>,</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_bins_after</span><span class=p>,</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_bins_current</span><span class=p>,</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_bins_stride</span><span class=p>,</span>
            <span class=p>)</span>
        <span class=k>return</span> <span class=n>repr_string</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__repr__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>bin_width</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>repr_string</span> <span class=o>=</span> <span class=s2>&quot;DataWindow(bins_before=</span><span class=si>{}</span><span class=s2>, bins_after=</span><span class=si>{}</span><span class=s2>, bins_current=</span><span class=si>{}</span><span class=s2>, bins_stride=</span><span class=si>{}</span><span class=s2>, bin_width=</span><span class=si>{}</span><span class=s2>)&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>bins_before</span><span class=p>,</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>bins_after</span><span class=p>,</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>bins_current</span><span class=p>,</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>bins_stride</span><span class=p>,</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>bin_width</span><span class=p>,</span>
            <span class=p>)</span>
            <span class=n>repr_string</span> <span class=o>+=</span> <span class=s2>&quot;</span><span class=se>\n\t</span><span class=s2>Total bin width = </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                <span class=n>PrettyDuration</span><span class=p>(</span>
                    <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>bins_before</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>bins_after</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>bins_current</span><span class=p>)</span>
                    <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>bin_width</span>
                <span class=p>)</span>
            <span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>repr_string</span> <span class=o>=</span> <span class=s2>&quot;DataWindow(bins_before=</span><span class=si>{}</span><span class=s2>, bins_after=</span><span class=si>{}</span><span class=s2>, bins_current=</span><span class=si>{}</span><span class=s2>, bins_stride=</span><span class=si>{}</span><span class=s2>)&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>bins_before</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>bins_after</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>bins_current</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>bins_stride</span>
            <span class=p>)</span>
        <span class=k>return</span> <span class=n>repr_string</span>

    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>T</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>lengths</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>flatten</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Dummy fit function to support sklearn pipelines.</span>
<span class=sd>        Parameters</span>
<span class=sd>        ----------</span>
<span class=sd>        X</span>
<span class=sd>            Ignored</span>
<span class=sd>        y</span>
<span class=sd>            Ignored</span>
<span class=sd>        flatten : bool, optional (default=False)</span>
<span class=sd>            Whether or not to flatten the output data during transformation.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=n>flatten</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_flatten</span> <span class=o>=</span> <span class=n>flatten</span>

        <span class=n>bins_before</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>bins_before</span>
        <span class=n>bins_after</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>bins_after</span>
        <span class=c1># bins_current = self.bins_current</span>
        <span class=n>stride</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>bins_stride</span>

        <span class=n>X</span><span class=p>,</span> <span class=n>T</span><span class=p>,</span> <span class=n>lengths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tidy</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>X</span><span class=p>,</span> <span class=n>T</span><span class=o>=</span><span class=n>T</span><span class=p>,</span> <span class=n>lengths</span><span class=o>=</span><span class=n>lengths</span><span class=p>)</span>
        <span class=n>L</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>cumsum</span><span class=p>(</span><span class=n>lengths</span><span class=p>),</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
        <span class=n>idx</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=n>n_zamples_tot</span> <span class=o>=</span> <span class=mi>0</span>
        <span class=k>for</span> <span class=n>kk</span><span class=p>,</span> <span class=p>(</span><span class=n>ii</span><span class=p>,</span> <span class=n>jj</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_iter_from_X_lengths</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>X</span><span class=p>,</span> <span class=n>lengths</span><span class=o>=</span><span class=n>lengths</span><span class=p>)):</span>
            <span class=n>X_</span> <span class=o>=</span> <span class=n>X</span><span class=p>[</span><span class=n>ii</span><span class=p>:</span><span class=n>jj</span><span class=p>]</span>  <span class=c1># , T[ii:jj]</span>
            <span class=n>n_samples</span><span class=p>,</span> <span class=n>n_features</span> <span class=o>=</span> <span class=n>X_</span><span class=o>.</span><span class=n>shape</span>
            <span class=n>n_zamples</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>ceil</span><span class=p>((</span><span class=n>n_samples</span> <span class=o>-</span> <span class=n>bins_before</span> <span class=o>-</span> <span class=n>bins_after</span><span class=p>)</span> <span class=o>/</span> <span class=n>stride</span><span class=p>))</span>
            <span class=n>n_zamples_tot</span> <span class=o>+=</span> <span class=n>n_zamples</span>
            <span class=n>idx</span> <span class=o>+=</span> <span class=nb>list</span><span class=p>(</span>
                <span class=n>L</span><span class=p>[</span><span class=n>kk</span><span class=p>]</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=n>bins_before</span><span class=p>,</span> <span class=n>n_samples</span> <span class=o>-</span> <span class=n>bins_after</span><span class=p>,</span> <span class=n>stride</span><span class=p>))</span>
            <span class=p>)</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>n_samples</span> <span class=o>=</span> <span class=n>n_zamples_tot</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>idx</span> <span class=o>=</span> <span class=n>idx</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>T</span> <span class=o>=</span> <span class=n>T</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span>
        <span class=k>return</span> <span class=bp>self</span>

    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>T</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>lengths</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>flatten</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=nb>sum</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Apply window specification to data in X.</span>

<span class=sd>        NOTE: this function is epoch-aware.</span>

<span class=sd>        WARNING: this function works in-core, and may use a lot of memory</span>
<span class=sd>                 to represent the unwrapped (windowed) data. If you have</span>
<span class=sd>                 a large dataset, using the streaming version may be better.</span>

<span class=sd>        Parameters</span>
<span class=sd>        ----------</span>
<span class=sd>        X : numpy 2d array of shape (n_samples, n_features)</span>
<span class=sd>                OR</span>
<span class=sd>            array-like of shape (n_epochs, ), each element of which is</span>
<span class=sd>            a numpy 2d array of shape (n_samples, n_features)</span>
<span class=sd>                OR</span>
<span class=sd>            nelpy.core.BinnedEventArray / BinnedSpikeTrainArray</span>
<span class=sd>                The number of spikes in each time bin for each neuron/unit.</span>
<span class=sd>        T : array-like of shape (n_samples,), optional (default=None)</span>
<span class=sd>                Timestamps / sample numbers corresponding to data in X.</span>
<span class=sd>        lengths : array-like, optional (default=None)</span>
<span class=sd>                Only used / allowed when X is a 2d numpy array, in which case</span>
<span class=sd>                sum(lengths) must equal n_samples.</span>
<span class=sd>                Array of lengths (in number of bins) for each contiguous segment</span>
<span class=sd>                in X.</span>
<span class=sd>        flatten : int, optional (default=False)</span>
<span class=sd>            Whether or not to flatten the output data.</span>
<span class=sd>        sum : boolean, optional (default=False)</span>
<span class=sd>            Whether or not to sum all the spikes in the window per time bin. If</span>
<span class=sd>            sum==True, then the dimensions of Z will be (n_samples, n_features).</span>

<span class=sd>        Returns</span>
<span class=sd>        -------</span>
<span class=sd>        Z : Windowed data of shape (n_samples, window_size, n_features).</span>
<span class=sd>            Note that n_samples in the output may not be the same as n_samples</span>
<span class=sd>            in the input, since window specifications can affect which and how</span>
<span class=sd>            many samples to return.</span>
<span class=sd>            When flatten is True, then Z has shape (n_samples, window_size*n_features).</span>
<span class=sd>            When sum is True, then Z has shape (n_samples, n_features)</span>
<span class=sd>        T : array-like of shape (n_samples,)</span>
<span class=sd>            Timestamps associated with data contained in Z.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=n>flatten</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>flatten</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_flatten</span>

        <span class=k>if</span> <span class=nb>sum</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=nb>sum</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_sum</span>

        <span class=n>X</span><span class=p>,</span> <span class=n>T</span><span class=p>,</span> <span class=n>lengths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tidy</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>X</span><span class=p>,</span> <span class=n>T</span><span class=o>=</span><span class=n>T</span><span class=p>,</span> <span class=n>lengths</span><span class=o>=</span><span class=n>lengths</span><span class=p>)</span>
        <span class=n>z</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=n>t</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=k>for</span> <span class=n>ii</span><span class=p>,</span> <span class=n>jj</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_iter_from_X_lengths</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>X</span><span class=p>,</span> <span class=n>lengths</span><span class=o>=</span><span class=n>lengths</span><span class=p>):</span>
            <span class=n>x</span><span class=p>,</span> <span class=n>tx</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_apply_contiguous</span><span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=n>ii</span><span class=p>:</span><span class=n>jj</span><span class=p>],</span> <span class=n>T</span><span class=p>[</span><span class=n>ii</span><span class=p>:</span><span class=n>jj</span><span class=p>],</span> <span class=n>flatten</span><span class=o>=</span><span class=n>flatten</span><span class=p>,</span> <span class=nb>sum</span><span class=o>=</span><span class=nb>sum</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>x</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                <span class=n>z</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
                <span class=n>t</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>tx</span><span class=p>)</span>

        <span class=n>Z</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>vstack</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
        <span class=n>T</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>

        <span class=k>return</span> <span class=n>Z</span><span class=p>,</span> <span class=n>T</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_apply_contiguous</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>T</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>flatten</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=nb>sum</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Apply window specification to data in X.</span>

<span class=sd>        NOTE: this function works on a single epoch only (i.e. assumes data</span>
<span class=sd>              is contiguous).</span>

<span class=sd>        NOTE: instead of returning partial data (with NaNs filling the rest),</span>
<span class=sd>              we only return those bins (windows) whose specifications are wholly</span>
<span class=sd>              contained in the data, similar to how binning in nelpy only includes</span>
<span class=sd>              those bins that fit wholly in the data support.</span>

<span class=sd>        WARNING: this function works in-core, and may use a lot of memory</span>
<span class=sd>                 to represent the unwrapped (windowed) data. If you have</span>
<span class=sd>                 a large dataset, using the streaming version may be better.</span>

<span class=sd>        Parameters</span>
<span class=sd>        ----------</span>
<span class=sd>        X : numpy 2d array of shape (n_samples, n_features)</span>
<span class=sd>        T : array-like of shape (n_samples,), optional (default=None)</span>
<span class=sd>                Timestamps / sample numbers corresponding to data in X.</span>
<span class=sd>        flatten : int, optional (default=False)</span>
<span class=sd>            Whether or not to flatten the output data.</span>
<span class=sd>        sum : boolean, optional (default=False)</span>
<span class=sd>            Whether or not to sum all the spikes in the window per time bin. If</span>
<span class=sd>            sum==True, then the dimensions of Z will be (n_samples, n_features).</span>

<span class=sd>        Returns</span>
<span class=sd>        -------</span>
<span class=sd>        Z : Windowed data of shape (n_samples, window_size, n_features).</span>
<span class=sd>            Note that n_samples in the output may not be the same as n_samples</span>
<span class=sd>            in the input, since window specifications can affect which and how</span>
<span class=sd>            many samples to return.</span>
<span class=sd>            When flatten is True, then Z has shape (n_samples, window_size*n_features).</span>
<span class=sd>        T : array-like of shape (n_samples,)</span>
<span class=sd>            Timestamps associated with data contained in Z.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=n>flatten</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>flatten</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_flatten</span>

        <span class=n>bins_before</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>bins_before</span>
        <span class=n>bins_after</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>bins_after</span>
        <span class=n>bins_current</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>bins_current</span>
        <span class=n>stride</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>bins_stride</span>

        <span class=n>n_samples</span><span class=p>,</span> <span class=n>n_features</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span>
        <span class=n>n_zamples</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>ceil</span><span class=p>((</span><span class=n>n_samples</span> <span class=o>-</span> <span class=n>bins_before</span> <span class=o>-</span> <span class=n>bins_after</span><span class=p>)</span> <span class=o>/</span> <span class=n>stride</span><span class=p>))</span>

        <span class=k>if</span> <span class=n>n_zamples</span> <span class=o>&lt;</span> <span class=mi>1</span><span class=p>:</span>
            <span class=n>Z</span> <span class=o>=</span> <span class=kc>None</span>
            <span class=n>T</span> <span class=o>=</span> <span class=kc>None</span>
            <span class=k>return</span> <span class=n>Z</span><span class=p>,</span> <span class=n>T</span>

        <span class=n>Z</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>empty</span><span class=p>([</span><span class=n>n_zamples</span><span class=p>,</span> <span class=n>bins_before</span> <span class=o>+</span> <span class=n>bins_after</span> <span class=o>+</span> <span class=n>bins_current</span><span class=p>,</span> <span class=n>n_features</span><span class=p>])</span>
        <span class=n>Z</span><span class=p>[:]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span>

        <span class=n>frm_idx</span> <span class=o>=</span> <span class=mi>0</span>
        <span class=n>curr_idx</span> <span class=o>=</span> <span class=n>bins_before</span>

        <span class=k>for</span> <span class=n>zz</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n_zamples</span><span class=p>):</span>
            <span class=k>if</span> <span class=n>bins_current</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
                <span class=n>idx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span>
                    <span class=n>frm_idx</span><span class=p>,</span> <span class=n>frm_idx</span> <span class=o>+</span> <span class=n>bins_before</span> <span class=o>+</span> <span class=n>bins_after</span> <span class=o>+</span> <span class=n>bins_current</span>
                <span class=p>)</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>idx</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=n>frm_idx</span><span class=p>,</span> <span class=n>frm_idx</span> <span class=o>+</span> <span class=n>bins_before</span><span class=p>))</span>
                <span class=n>idx</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span>
                    <span class=nb>list</span><span class=p>(</span>
                        <span class=nb>range</span><span class=p>(</span>
                            <span class=n>frm_idx</span> <span class=o>+</span> <span class=n>bins_before</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span>
                            <span class=n>frm_idx</span> <span class=o>+</span> <span class=n>bins_before</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>+</span> <span class=n>bins_after</span><span class=p>,</span>
                        <span class=p>)</span>
                    <span class=p>)</span>
                <span class=p>)</span>

            <span class=c1>#     print(&#39;{}  @ {}&#39;.format(idx, curr_idx))</span>

            <span class=n>Z</span><span class=p>[</span><span class=n>zz</span><span class=p>,</span> <span class=p>:]</span> <span class=o>=</span> <span class=n>X</span><span class=p>[</span><span class=n>idx</span><span class=p>,</span> <span class=p>:]</span>
            <span class=n>curr_idx</span> <span class=o>+=</span> <span class=n>stride</span>
            <span class=n>frm_idx</span> <span class=o>+=</span> <span class=n>stride</span>

        <span class=k>if</span> <span class=nb>sum</span><span class=p>:</span>
            <span class=n>Z</span> <span class=o>=</span> <span class=n>Z</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
        <span class=k>elif</span> <span class=n>flatten</span><span class=p>:</span>
            <span class=n>Z</span> <span class=o>=</span> <span class=n>Z</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=n>Z</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=p>(</span><span class=n>Z</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>*</span> <span class=n>Z</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>2</span><span class=p>]))</span>

        <span class=k>if</span> <span class=n>T</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>t_idx</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=n>bins_before</span><span class=p>,</span> <span class=n>n_samples</span> <span class=o>-</span> <span class=n>bins_after</span><span class=p>,</span> <span class=n>stride</span><span class=p>))</span>
            <span class=n>T</span> <span class=o>=</span> <span class=n>T</span><span class=p>[</span><span class=n>t_idx</span><span class=p>]</span>

        <span class=k>return</span> <span class=n>Z</span><span class=p>,</span> <span class=n>T</span>

    <span class=k>def</span><span class=w> </span><span class=nf>stream</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>chunk_size</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>flatten</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Streaming window specification on data X.</span>

<span class=sd>        Q. Should this return a generator? Should it BE a generator? I think we</span>
<span class=sd>            should return an iterable?</span>

<span class=sd>        Examples</span>
<span class=sd>        --------</span>
<span class=sd>        &gt;&gt;&gt; w = DataWindow()</span>
<span class=sd>        &gt;&gt;&gt; ws = w.stream(X)</span>
<span class=sd>        &gt;&gt;&gt; for x in ws:</span>
<span class=sd>                print(x)</span>

<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>X</span><span class=p>,</span> <span class=n>T</span><span class=p>,</span> <span class=n>lengths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tidy</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>StreamingDataWindow</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=o>=</span><span class=n>X</span><span class=p>,</span> <span class=n>flatten</span><span class=o>=</span><span class=n>flatten</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_tidy</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>T</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>lengths</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Transform data into a tidy, standardized, minimalist form.</span>

<span class=sd>        NOTE: No windowing is present in tidy data; windowing is APPLIED</span>
<span class=sd>              to tidy data when using DataWindow.apply().</span>

<span class=sd>        Parameters</span>
<span class=sd>        ----------</span>
<span class=sd>        X : numpy 2d array of shape (n_samples, n_features)</span>
<span class=sd>                OR</span>
<span class=sd>            array-like of shape (n_epochs, ), each element of which is</span>
<span class=sd>            a numpy 2d array of shape (n_samples, n_features)</span>
<span class=sd>                OR</span>
<span class=sd>            nelpy.core.BinnedEventArray / BinnedSpikeTrainArray</span>
<span class=sd>                The number of spikes in each time bin for each neuron/unit.</span>
<span class=sd>        T : array-like of shape (n_samples,), optional (default=None)</span>
<span class=sd>                Timestamps / sample numbers corresponding to data in X.</span>
<span class=sd>        lengths : array-like, optional (default=None)</span>
<span class=sd>                Only used / allowed when X is a 2d numpy array, in which case</span>
<span class=sd>                sum(lengths) must equal n_samples.</span>
<span class=sd>                Array of lengths (in number of bins) for each contiguous segment</span>
<span class=sd>                in X.</span>

<span class=sd>        Returns</span>
<span class=sd>        -------</span>
<span class=sd>        tidyX : numpy 2d array of shape (n_samples, n_features)</span>
<span class=sd>            The number of spikes in each time bin for each neuron/unit.</span>
<span class=sd>        tidyT : array-like of shape (n_samples,)</span>
<span class=sd>            Timestamps / sample numbers corresponding to data in X.</span>
<span class=sd>        lengths : array-like</span>
<span class=sd>            Array of lengths (in number of bins) for each contiguous segment</span>
<span class=sd>            in tidyX.</span>

<span class=sd>        Examples</span>
<span class=sd>        --------</span>

<span class=sd>        X = np.zeros((20, 8))</span>
<span class=sd>        X = [np.zeros((20,50)), np.zeros((30, 50)), np.zeros((80, 50))]</span>
<span class=sd>        X = [np.zeros((20,50)), np.zeros((30, 50)), np.zeros((80, 30))]</span>
<span class=sd>        w = DataWindow(bin_width=0.02)</span>

<span class=sd>        X, T, lengths = w._tidy(X)</span>
<span class=sd>        X, T, lengths = w._tidy(X, T=np.arange(50))</span>
<span class=sd>        X, T, lengths = w._tidy(X, lengths=[20,5,10])</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=c1># here we should transform BSTs, numpy arrays, check for dimensions, etc</span>
        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>core</span><span class=o>.</span><span class=n>BinnedEventArray</span><span class=p>):</span>
            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_bin_width</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_bin_width</span> <span class=o>!=</span> <span class=n>X</span><span class=o>.</span><span class=n>ds</span><span class=p>:</span>
                    <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
                        <span class=s2>&quot;The DataWindow has ``bin_width``=</span><span class=si>{}</span><span class=s2>, whereas ``X.ds``=</span><span class=si>{}</span><span class=s2>.&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                            <span class=bp>self</span><span class=o>.</span><span class=n>_bin_width</span><span class=p>,</span> <span class=n>X</span><span class=o>.</span><span class=n>ds</span>
                        <span class=p>)</span>
                    <span class=p>)</span>

            <span class=k>if</span> <span class=p>(</span><span class=n>T</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>)</span> <span class=ow>or</span> <span class=p>(</span><span class=n>lengths</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>):</span>
                <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
                    <span class=s2>&quot;A </span><span class=si>{}</span><span class=s2> was passed in, so &#39;T&#39; and &#39;lengths&#39; will be ignored...&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                        <span class=n>X</span><span class=o>.</span><span class=n>type_name</span>
                    <span class=p>)</span>
                <span class=p>)</span>

            <span class=n>T</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>bin_centers</span>
            <span class=n>lengths</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>lengths</span>
            <span class=n>X</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>T</span>

            <span class=k>return</span> <span class=n>X</span><span class=p>,</span> <span class=n>T</span><span class=p>,</span> <span class=n>lengths</span>

        <span class=k>try</span><span class=p>:</span>
            <span class=n>x</span> <span class=o>=</span> <span class=n>X</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span>
            <span class=k>if</span> <span class=n>X</span><span class=o>.</span><span class=n>ndim</span> <span class=o>!=</span> <span class=mi>2</span><span class=p>:</span>
                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
                    <span class=s2>&quot;X is expected to be array-like with shape (n_samples, n_features).&quot;</span>
                <span class=p>)</span>
            <span class=n>n_samples</span><span class=p>,</span> <span class=n>n_features</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span>
            <span class=k>if</span> <span class=n>lengths</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                <span class=n>tot_length</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>lengths</span><span class=p>)</span>
                <span class=k>if</span> <span class=n>tot_length</span> <span class=o>!=</span> <span class=n>n_samples</span><span class=p>:</span>
                    <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
                        <span class=s2>&quot;The sum of ``lengths`` should equal ``n_samples``. [sum(lengths)=</span><span class=si>{}</span><span class=s2>; n_samples=</span><span class=si>{}</span><span class=s2>]&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                            <span class=n>tot_length</span><span class=p>,</span> <span class=n>n_samples</span>
                        <span class=p>)</span>
                    <span class=p>)</span>
        <span class=k>except</span> <span class=p>(</span><span class=ne>IndexError</span><span class=p>,</span> <span class=ne>TypeError</span><span class=p>):</span>
            <span class=k>try</span><span class=p>:</span>
                <span class=n>x</span> <span class=o>=</span> <span class=n>X</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
                <span class=k>if</span> <span class=n>x</span><span class=o>.</span><span class=n>ndim</span> <span class=o>!=</span> <span class=mi>2</span><span class=p>:</span>
                    <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
                        <span class=s2>&quot;Each element of X is expected to be array-like with shape (n_samples, n_features).&quot;</span>
                    <span class=p>)</span>
                <span class=k>if</span> <span class=n>lengths</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                    <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
                        <span class=s2>&quot;``lengths`` should not be specified when the shape of X is (n_epochs,)&quot;</span>
                    <span class=p>)</span>
                <span class=n>n_samples</span><span class=p>,</span> <span class=n>n_features</span> <span class=o>=</span> <span class=n>x</span><span class=o>.</span><span class=n>shape</span>
                <span class=n>lengths</span> <span class=o>=</span> <span class=p>[]</span>
                <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>X</span><span class=p>:</span>
                    <span class=n>lengths</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
                    <span class=k>if</span> <span class=n>x</span><span class=o>.</span><span class=n>ndim</span> <span class=o>!=</span> <span class=mi>2</span><span class=p>:</span>
                        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
                            <span class=s2>&quot;Each element of X is expected to be array-like with shape (n_samples, n_features).&quot;</span>
                        <span class=p>)</span>
                    <span class=k>if</span> <span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>!=</span> <span class=n>n_features</span><span class=p>:</span>
                        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
                            <span class=s2>&quot;Each element of X is expected to have the same number of features.&quot;</span>
                        <span class=p>)</span>
                <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>vstack</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
            <span class=k>except</span> <span class=p>(</span><span class=ne>IndexError</span><span class=p>,</span> <span class=ne>TypeError</span><span class=p>):</span>
                <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
                    <span class=s2>&quot;Windowing of type </span><span class=si>{}</span><span class=s2> not supported!&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=n>X</span><span class=p>)))</span>
                <span class=p>)</span>
        <span class=n>n_samples</span><span class=p>,</span> <span class=n>n_features</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span>
        <span class=k>if</span> <span class=n>T</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>T</span><span class=p>)</span> <span class=o>==</span> <span class=n>n_samples</span><span class=p>,</span> <span class=p>(</span>
                <span class=s2>&quot;T must have the same number of elements as n_samples.&quot;</span>
            <span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_bin_width</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                <span class=n>ds</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_bin_width</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>ds</span> <span class=o>=</span> <span class=mi>1</span>
            <span class=n>T</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>n_samples</span><span class=p>)</span> <span class=o>*</span> <span class=n>ds</span> <span class=o>+</span> <span class=n>ds</span> <span class=o>/</span> <span class=mi>2</span>

        <span class=k>return</span> <span class=n>X</span><span class=p>,</span> <span class=n>T</span><span class=p>,</span> <span class=n>lengths</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_iter_from_X_lengths</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>lengths</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Helper function to iterate over contiguous segments of data.</span>

<span class=sd>        Parameters</span>
<span class=sd>        ----------</span>
<span class=sd>        X : array-like, shape (n_samples, n_features)</span>
<span class=sd>                Feature matrix of individual samples.</span>
<span class=sd>                Typically the number of spikes in each time bin for each neuron.</span>
<span class=sd>        lengths : array-like of integers, shape (n_epochs, ), optional</span>
<span class=sd>                Lengths of the individual epochs in ``X``. The sum of</span>
<span class=sd>                these should be ``n_samples``.</span>
<span class=sd>                Array of lengths (in number of bins) for each contiguous segment</span>
<span class=sd>                in X.</span>

<span class=sd>        Returns</span>
<span class=sd>        -------</span>
<span class=sd>        start, end : indices of a contiguous segment in data, so that</span>
<span class=sd>                     segment = data[start:end]</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=n>X</span><span class=o>.</span><span class=n>ndim</span> <span class=o>!=</span> <span class=mi>2</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
                <span class=s2>&quot;X is expected to be array-like with shape (n_samples, n_features).&quot;</span>
            <span class=p>)</span>

        <span class=n>n_samples</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>

        <span class=k>if</span> <span class=n>lengths</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=k>try</span><span class=p>:</span>
                <span class=k>yield</span> <span class=mi>0</span><span class=p>,</span> <span class=n>n_samples</span>
            <span class=k>except</span> <span class=ne>StopIteration</span><span class=p>:</span>
                <span class=k>return</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>end</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>cumsum</span><span class=p>(</span><span class=n>lengths</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>int</span><span class=p>)</span>

            <span class=k>if</span> <span class=n>end</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>!=</span> <span class=n>n_samples</span><span class=p>:</span>
                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
                    <span class=s2>&quot;The sum of ``lengths`` should equal ``n_samples``. [sum(lengths)=</span><span class=si>{}</span><span class=s2>; n_samples=</span><span class=si>{}</span><span class=s2>]&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                        <span class=n>end</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span> <span class=n>n_samples</span>
                    <span class=p>)</span>
                <span class=p>)</span>

            <span class=n>start</span> <span class=o>=</span> <span class=n>end</span> <span class=o>-</span> <span class=n>lengths</span>

            <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>lengths</span><span class=p>)):</span>
                <span class=k>try</span><span class=p>:</span>
                    <span class=k>yield</span> <span class=n>start</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>end</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
                <span class=k>except</span> <span class=ne>StopIteration</span><span class=p>:</span>
                    <span class=k>return</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>bins_before</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_bins_before</span>

    <span class=nd>@bins_before</span><span class=o>.</span><span class=n>setter</span>
    <span class=k>def</span><span class=w> </span><span class=nf>bins_before</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>val</span><span class=p>):</span>
        <span class=k>assert</span> <span class=nb>float</span><span class=p>(</span><span class=n>val</span><span class=p>)</span><span class=o>.</span><span class=n>is_integer</span><span class=p>(),</span> <span class=p>(</span>
            <span class=s2>&quot;``bins_before`` must be a non-negative integer!&quot;</span>
        <span class=p>)</span>
        <span class=k>assert</span> <span class=n>val</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>,</span> <span class=s2>&quot;``bins_before`` must be a non-negative integer!&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_bins_before</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>val</span><span class=p>)</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>bins_after</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_bins_after</span>

    <span class=nd>@bins_after</span><span class=o>.</span><span class=n>setter</span>
    <span class=k>def</span><span class=w> </span><span class=nf>bins_after</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>val</span><span class=p>):</span>
        <span class=k>assert</span> <span class=nb>float</span><span class=p>(</span><span class=n>val</span><span class=p>)</span><span class=o>.</span><span class=n>is_integer</span><span class=p>(),</span> <span class=s2>&quot;``bins_after`` must be a non-negative integer!&quot;</span>
        <span class=k>assert</span> <span class=n>val</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>,</span> <span class=s2>&quot;``bins_after`` must be a non-negative integer!&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_bins_after</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>val</span><span class=p>)</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>bins_current</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_bins_current</span>

    <span class=nd>@bins_current</span><span class=o>.</span><span class=n>setter</span>
    <span class=k>def</span><span class=w> </span><span class=nf>bins_current</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>val</span><span class=p>):</span>
        <span class=k>assert</span> <span class=nb>float</span><span class=p>(</span><span class=n>val</span><span class=p>)</span><span class=o>.</span><span class=n>is_integer</span><span class=p>(),</span> <span class=s2>&quot;``bins_current`` must be a either 1 or 0!&quot;</span>
        <span class=k>assert</span> <span class=n>val</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=s2>&quot;``bins_current`` must be a either 1 or 0!&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_bins_current</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>val</span><span class=p>)</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>bins_stride</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_bins_stride</span>

    <span class=nd>@bins_stride</span><span class=o>.</span><span class=n>setter</span>
    <span class=k>def</span><span class=w> </span><span class=nf>bins_stride</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>val</span><span class=p>):</span>
        <span class=k>assert</span> <span class=nb>float</span><span class=p>(</span><span class=n>val</span><span class=p>)</span><span class=o>.</span><span class=n>is_integer</span><span class=p>(),</span> <span class=p>(</span>
            <span class=s2>&quot;``bins_stride`` must be a non-negative integer!&quot;</span>
        <span class=p>)</span>
        <span class=k>assert</span> <span class=n>val</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>,</span> <span class=s2>&quot;``bins_stride`` must be a non-negative integer!&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_bins_stride</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>val</span><span class=p>)</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>bin_width</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_bin_width</span>

    <span class=nd>@bin_width</span><span class=o>.</span><span class=n>setter</span>
    <span class=k>def</span><span class=w> </span><span class=nf>bin_width</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>val</span><span class=p>):</span>
        <span class=k>if</span> <span class=n>val</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=k>assert</span> <span class=nb>float</span><span class=p>(</span><span class=n>val</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>,</span> <span class=p>(</span>
                <span class=s2>&quot;``bin_width`` must be a non-negative number (float)!&quot;</span>
            <span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_bin_width</span> <span class=o>=</span> <span class=n>val</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>flatten</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_flatten</span>

    <span class=nd>@flatten</span><span class=o>.</span><span class=n>setter</span>
    <span class=k>def</span><span class=w> </span><span class=nf>flatten</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>val</span><span class=p>):</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>val</span><span class=p>:</span>
                <span class=n>val</span> <span class=o>=</span> <span class=kc>True</span>
        <span class=k>except</span> <span class=ne>Exception</span><span class=p>:</span>
            <span class=n>val</span> <span class=o>=</span> <span class=kc>False</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_flatten</span> <span class=o>=</span> <span class=n>val</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=nelpy.preprocessing.DataWindow.fit class="doc doc-heading"> <code class="highlight language-python"><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>T</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>lengths</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>flatten</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Dummy fit function to support sklearn pipelines.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>X</code> </td> <td> </td> <td> <div class=doc-md-description> <p>Ignored</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>y</code> </td> <td> </td> <td> <div class=doc-md-description> <p>Ignored</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>flatten</code> </td> <td> <code>(<span title=bool>bool</span>, <span title=optional>optional</span>(default=False))</code> </td> <td> <div class=doc-md-description> <p>Whether or not to flatten the output data during transformation.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>nelpy/preprocessing.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>259</span>
<span class=normal>260</span>
<span class=normal>261</span>
<span class=normal>262</span>
<span class=normal>263</span>
<span class=normal>264</span>
<span class=normal>265</span>
<span class=normal>266</span>
<span class=normal>267</span>
<span class=normal>268</span>
<span class=normal>269</span>
<span class=normal>270</span>
<span class=normal>271</span>
<span class=normal>272</span>
<span class=normal>273</span>
<span class=normal>274</span>
<span class=normal>275</span>
<span class=normal>276</span>
<span class=normal>277</span>
<span class=normal>278</span>
<span class=normal>279</span>
<span class=normal>280</span>
<span class=normal>281</span>
<span class=normal>282</span>
<span class=normal>283</span>
<span class=normal>284</span>
<span class=normal>285</span>
<span class=normal>286</span>
<span class=normal>287</span>
<span class=normal>288</span>
<span class=normal>289</span>
<span class=normal>290</span>
<span class=normal>291</span>
<span class=normal>292</span>
<span class=normal>293</span>
<span class=normal>294</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>T</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>lengths</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>flatten</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Dummy fit function to support sklearn pipelines.</span>
<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    X</span>
<span class=sd>        Ignored</span>
<span class=sd>    y</span>
<span class=sd>        Ignored</span>
<span class=sd>    flatten : bool, optional (default=False)</span>
<span class=sd>        Whether or not to flatten the output data during transformation.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>flatten</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_flatten</span> <span class=o>=</span> <span class=n>flatten</span>

    <span class=n>bins_before</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>bins_before</span>
    <span class=n>bins_after</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>bins_after</span>
    <span class=c1># bins_current = self.bins_current</span>
    <span class=n>stride</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>bins_stride</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>T</span><span class=p>,</span> <span class=n>lengths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tidy</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>X</span><span class=p>,</span> <span class=n>T</span><span class=o>=</span><span class=n>T</span><span class=p>,</span> <span class=n>lengths</span><span class=o>=</span><span class=n>lengths</span><span class=p>)</span>
    <span class=n>L</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>cumsum</span><span class=p>(</span><span class=n>lengths</span><span class=p>),</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
    <span class=n>idx</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=n>n_zamples_tot</span> <span class=o>=</span> <span class=mi>0</span>
    <span class=k>for</span> <span class=n>kk</span><span class=p>,</span> <span class=p>(</span><span class=n>ii</span><span class=p>,</span> <span class=n>jj</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_iter_from_X_lengths</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>X</span><span class=p>,</span> <span class=n>lengths</span><span class=o>=</span><span class=n>lengths</span><span class=p>)):</span>
        <span class=n>X_</span> <span class=o>=</span> <span class=n>X</span><span class=p>[</span><span class=n>ii</span><span class=p>:</span><span class=n>jj</span><span class=p>]</span>  <span class=c1># , T[ii:jj]</span>
        <span class=n>n_samples</span><span class=p>,</span> <span class=n>n_features</span> <span class=o>=</span> <span class=n>X_</span><span class=o>.</span><span class=n>shape</span>
        <span class=n>n_zamples</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>ceil</span><span class=p>((</span><span class=n>n_samples</span> <span class=o>-</span> <span class=n>bins_before</span> <span class=o>-</span> <span class=n>bins_after</span><span class=p>)</span> <span class=o>/</span> <span class=n>stride</span><span class=p>))</span>
        <span class=n>n_zamples_tot</span> <span class=o>+=</span> <span class=n>n_zamples</span>
        <span class=n>idx</span> <span class=o>+=</span> <span class=nb>list</span><span class=p>(</span>
            <span class=n>L</span><span class=p>[</span><span class=n>kk</span><span class=p>]</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=n>bins_before</span><span class=p>,</span> <span class=n>n_samples</span> <span class=o>-</span> <span class=n>bins_after</span><span class=p>,</span> <span class=n>stride</span><span class=p>))</span>
        <span class=p>)</span>

    <span class=bp>self</span><span class=o>.</span><span class=n>n_samples</span> <span class=o>=</span> <span class=n>n_zamples_tot</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>idx</span> <span class=o>=</span> <span class=n>idx</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>T</span> <span class=o>=</span> <span class=n>T</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span>
    <span class=k>return</span> <span class=bp>self</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.preprocessing.DataWindow.stream class="doc doc-heading"> <code class="highlight language-python"><span class=n>stream</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>chunk_size</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>flatten</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Streaming window specification on data X.</p> <p>Q. Should this return a generator? Should it BE a generator? I think we should return an iterable?</p> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>w</span> <span class=o>=</span> <span class=n>DataWindow</span><span class=p>()</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>ws</span> <span class=o>=</span> <span class=n>w</span><span class=o>.</span><span class=n>stream</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>ws</span><span class=p>:</span>
<span class=go>        print(x)</span>
</code></pre></div> <details class=quote> <summary>Source code in <code>nelpy/preprocessing.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>451</span>
<span class=normal>452</span>
<span class=normal>453</span>
<span class=normal>454</span>
<span class=normal>455</span>
<span class=normal>456</span>
<span class=normal>457</span>
<span class=normal>458</span>
<span class=normal>459</span>
<span class=normal>460</span>
<span class=normal>461</span>
<span class=normal>462</span>
<span class=normal>463</span>
<span class=normal>464</span>
<span class=normal>465</span>
<span class=normal>466</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>stream</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>chunk_size</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>flatten</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Streaming window specification on data X.</span>

<span class=sd>    Q. Should this return a generator? Should it BE a generator? I think we</span>
<span class=sd>        should return an iterable?</span>

<span class=sd>    Examples</span>
<span class=sd>    --------</span>
<span class=sd>    &gt;&gt;&gt; w = DataWindow()</span>
<span class=sd>    &gt;&gt;&gt; ws = w.stream(X)</span>
<span class=sd>    &gt;&gt;&gt; for x in ws:</span>
<span class=sd>            print(x)</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>T</span><span class=p>,</span> <span class=n>lengths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tidy</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>StreamingDataWindow</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=o>=</span><span class=n>X</span><span class=p>,</span> <span class=n>flatten</span><span class=o>=</span><span class=n>flatten</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.preprocessing.DataWindow.transform class="doc doc-heading"> <code class="highlight language-python"><span class=n>transform</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>T</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>lengths</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>flatten</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=nb>sum</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Apply window specification to data in X.</p> <p>NOTE: this function is epoch-aware.</p> <p>WARNING: this function works in-core, and may use a lot of memory to represent the unwrapped (windowed) data. If you have a large dataset, using the streaming version may be better.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>X</code> </td> <td> <code>numpy 2d array of shape (n_samples, n_features)</code> </td> <td> <div class=doc-md-description> <pre><code>OR
</code></pre> <p>array-like of shape (n_epochs, ), each element of which is a numpy 2d array of shape (n_samples, n_features) OR nelpy.core.BinnedEventArray / BinnedSpikeTrainArray The number of spikes in each time bin for each neuron/unit.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>T</code> </td> <td> <code>array-like of shape (n_samples,), optional (default=None)</code> </td> <td> <div class=doc-md-description> <pre><code>Timestamps / sample numbers corresponding to data in X.
</code></pre> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>lengths</code> </td> <td> <code>(<span title=array>array</span> - <span title=like>like</span>, <span title=optional>optional</span>(default=None))</code> </td> <td> <div class=doc-md-description> <pre><code>Only used / allowed when X is a 2d numpy array, in which case
sum(lengths) must equal n_samples.
Array of lengths (in number of bins) for each contiguous segment
in X.
</code></pre> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>flatten</code> </td> <td> <code>(<span title=int>int</span>, <span title=optional>optional</span>(default=False))</code> </td> <td> <div class=doc-md-description> <p>Whether or not to flatten the output data.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>sum</code> </td> <td> <code>(<span title=boolean>boolean</span>, <span title=optional>optional</span>(default=False))</code> </td> <td> <div class=doc-md-description> <p>Whether or not to sum all the spikes in the window per time bin. If sum==True, then the dimensions of Z will be (n_samples, n_features).</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>Z</code></td> <td> <code>Windowed data of shape (n_samples, window_size, n_features).</code> </td> <td> <div class=doc-md-description> <p>Note that n_samples in the output may not be the same as n_samples in the input, since window specifications can affect which and how many samples to return. When flatten is True, then Z has shape (n_samples, window_size*n_features). When sum is True, then Z has shape (n_samples, n_features)</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>T</code></td> <td> <code>array-like of shape (n_samples,)</code> </td> <td> <div class=doc-md-description> <p>Timestamps associated with data contained in Z.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>nelpy/preprocessing.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>296</span>
<span class=normal>297</span>
<span class=normal>298</span>
<span class=normal>299</span>
<span class=normal>300</span>
<span class=normal>301</span>
<span class=normal>302</span>
<span class=normal>303</span>
<span class=normal>304</span>
<span class=normal>305</span>
<span class=normal>306</span>
<span class=normal>307</span>
<span class=normal>308</span>
<span class=normal>309</span>
<span class=normal>310</span>
<span class=normal>311</span>
<span class=normal>312</span>
<span class=normal>313</span>
<span class=normal>314</span>
<span class=normal>315</span>
<span class=normal>316</span>
<span class=normal>317</span>
<span class=normal>318</span>
<span class=normal>319</span>
<span class=normal>320</span>
<span class=normal>321</span>
<span class=normal>322</span>
<span class=normal>323</span>
<span class=normal>324</span>
<span class=normal>325</span>
<span class=normal>326</span>
<span class=normal>327</span>
<span class=normal>328</span>
<span class=normal>329</span>
<span class=normal>330</span>
<span class=normal>331</span>
<span class=normal>332</span>
<span class=normal>333</span>
<span class=normal>334</span>
<span class=normal>335</span>
<span class=normal>336</span>
<span class=normal>337</span>
<span class=normal>338</span>
<span class=normal>339</span>
<span class=normal>340</span>
<span class=normal>341</span>
<span class=normal>342</span>
<span class=normal>343</span>
<span class=normal>344</span>
<span class=normal>345</span>
<span class=normal>346</span>
<span class=normal>347</span>
<span class=normal>348</span>
<span class=normal>349</span>
<span class=normal>350</span>
<span class=normal>351</span>
<span class=normal>352</span>
<span class=normal>353</span>
<span class=normal>354</span>
<span class=normal>355</span>
<span class=normal>356</span>
<span class=normal>357</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>T</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>lengths</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>flatten</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=nb>sum</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Apply window specification to data in X.</span>

<span class=sd>    NOTE: this function is epoch-aware.</span>

<span class=sd>    WARNING: this function works in-core, and may use a lot of memory</span>
<span class=sd>             to represent the unwrapped (windowed) data. If you have</span>
<span class=sd>             a large dataset, using the streaming version may be better.</span>

<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    X : numpy 2d array of shape (n_samples, n_features)</span>
<span class=sd>            OR</span>
<span class=sd>        array-like of shape (n_epochs, ), each element of which is</span>
<span class=sd>        a numpy 2d array of shape (n_samples, n_features)</span>
<span class=sd>            OR</span>
<span class=sd>        nelpy.core.BinnedEventArray / BinnedSpikeTrainArray</span>
<span class=sd>            The number of spikes in each time bin for each neuron/unit.</span>
<span class=sd>    T : array-like of shape (n_samples,), optional (default=None)</span>
<span class=sd>            Timestamps / sample numbers corresponding to data in X.</span>
<span class=sd>    lengths : array-like, optional (default=None)</span>
<span class=sd>            Only used / allowed when X is a 2d numpy array, in which case</span>
<span class=sd>            sum(lengths) must equal n_samples.</span>
<span class=sd>            Array of lengths (in number of bins) for each contiguous segment</span>
<span class=sd>            in X.</span>
<span class=sd>    flatten : int, optional (default=False)</span>
<span class=sd>        Whether or not to flatten the output data.</span>
<span class=sd>    sum : boolean, optional (default=False)</span>
<span class=sd>        Whether or not to sum all the spikes in the window per time bin. If</span>
<span class=sd>        sum==True, then the dimensions of Z will be (n_samples, n_features).</span>

<span class=sd>    Returns</span>
<span class=sd>    -------</span>
<span class=sd>    Z : Windowed data of shape (n_samples, window_size, n_features).</span>
<span class=sd>        Note that n_samples in the output may not be the same as n_samples</span>
<span class=sd>        in the input, since window specifications can affect which and how</span>
<span class=sd>        many samples to return.</span>
<span class=sd>        When flatten is True, then Z has shape (n_samples, window_size*n_features).</span>
<span class=sd>        When sum is True, then Z has shape (n_samples, n_features)</span>
<span class=sd>    T : array-like of shape (n_samples,)</span>
<span class=sd>        Timestamps associated with data contained in Z.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>flatten</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>flatten</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_flatten</span>

    <span class=k>if</span> <span class=nb>sum</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=nb>sum</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_sum</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>T</span><span class=p>,</span> <span class=n>lengths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tidy</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>X</span><span class=p>,</span> <span class=n>T</span><span class=o>=</span><span class=n>T</span><span class=p>,</span> <span class=n>lengths</span><span class=o>=</span><span class=n>lengths</span><span class=p>)</span>
    <span class=n>z</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=n>t</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>for</span> <span class=n>ii</span><span class=p>,</span> <span class=n>jj</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_iter_from_X_lengths</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>X</span><span class=p>,</span> <span class=n>lengths</span><span class=o>=</span><span class=n>lengths</span><span class=p>):</span>
        <span class=n>x</span><span class=p>,</span> <span class=n>tx</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_apply_contiguous</span><span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=n>ii</span><span class=p>:</span><span class=n>jj</span><span class=p>],</span> <span class=n>T</span><span class=p>[</span><span class=n>ii</span><span class=p>:</span><span class=n>jj</span><span class=p>],</span> <span class=n>flatten</span><span class=o>=</span><span class=n>flatten</span><span class=p>,</span> <span class=nb>sum</span><span class=o>=</span><span class=nb>sum</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>x</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>z</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
            <span class=n>t</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>tx</span><span class=p>)</span>

    <span class=n>Z</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>vstack</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
    <span class=n>T</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>Z</span><span class=p>,</span> <span class=n>T</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=nelpy.preprocessing.StandardScaler class="doc doc-heading"> <code>StandardScaler</code> </h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=sklearn.preprocessing.StandardScaler>StandardScaler</span></code></p> <details class=quote> <summary>Source code in <code>nelpy/preprocessing.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>762</span>
<span class=normal>763</span>
<span class=normal>764</span>
<span class=normal>765</span>
<span class=normal>766</span>
<span class=normal>767</span>
<span class=normal>768</span>
<span class=normal>769</span>
<span class=normal>770</span>
<span class=normal>771</span>
<span class=normal>772</span>
<span class=normal>773</span>
<span class=normal>774</span>
<span class=normal>775</span>
<span class=normal>776</span>
<span class=normal>777</span>
<span class=normal>778</span>
<span class=normal>779</span>
<span class=normal>780</span>
<span class=normal>781</span>
<span class=normal>782</span>
<span class=normal>783</span>
<span class=normal>784</span>
<span class=normal>785</span>
<span class=normal>786</span>
<span class=normal>787</span>
<span class=normal>788</span>
<span class=normal>789</span>
<span class=normal>790</span>
<span class=normal>791</span>
<span class=normal>792</span>
<span class=normal>793</span>
<span class=normal>794</span>
<span class=normal>795</span>
<span class=normal>796</span>
<span class=normal>797</span>
<span class=normal>798</span>
<span class=normal>799</span>
<span class=normal>800</span>
<span class=normal>801</span>
<span class=normal>802</span>
<span class=normal>803</span>
<span class=normal>804</span>
<span class=normal>805</span>
<span class=normal>806</span>
<span class=normal>807</span>
<span class=normal>808</span>
<span class=normal>809</span>
<span class=normal>810</span>
<span class=normal>811</span>
<span class=normal>812</span>
<span class=normal>813</span>
<span class=normal>814</span>
<span class=normal>815</span>
<span class=normal>816</span>
<span class=normal>817</span>
<span class=normal>818</span>
<span class=normal>819</span>
<span class=normal>820</span>
<span class=normal>821</span>
<span class=normal>822</span>
<span class=normal>823</span>
<span class=normal>824</span>
<span class=normal>825</span>
<span class=normal>826</span>
<span class=normal>827</span>
<span class=normal>828</span>
<span class=normal>829</span>
<span class=normal>830</span>
<span class=normal>831</span>
<span class=normal>832</span>
<span class=normal>833</span>
<span class=normal>834</span>
<span class=normal>835</span>
<span class=normal>836</span>
<span class=normal>837</span>
<span class=normal>838</span>
<span class=normal>839</span>
<span class=normal>840</span>
<span class=normal>841</span>
<span class=normal>842</span>
<span class=normal>843</span>
<span class=normal>844</span>
<span class=normal>845</span>
<span class=normal>846</span>
<span class=normal>847</span>
<span class=normal>848</span>
<span class=normal>849</span>
<span class=normal>850</span>
<span class=normal>851</span>
<span class=normal>852</span>
<span class=normal>853</span>
<span class=normal>854</span>
<span class=normal>855</span>
<span class=normal>856</span>
<span class=normal>857</span>
<span class=normal>858</span>
<span class=normal>859</span>
<span class=normal>860</span>
<span class=normal>861</span>
<span class=normal>862</span>
<span class=normal>863</span>
<span class=normal>864</span>
<span class=normal>865</span>
<span class=normal>866</span>
<span class=normal>867</span>
<span class=normal>868</span>
<span class=normal>869</span>
<span class=normal>870</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>StandardScaler</span><span class=p>(</span><span class=n>SklearnStandardScaler</span><span class=p>):</span>
    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>copy</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>with_mean</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>with_std</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>copy</span><span class=o>=</span><span class=n>copy</span><span class=p>,</span> <span class=n>with_mean</span><span class=o>=</span><span class=n>with_mean</span><span class=p>,</span> <span class=n>with_std</span><span class=o>=</span><span class=n>with_std</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Compute the mean and std to be used for later scaling.</span>
<span class=sd>        Parameters</span>
<span class=sd>        ----------</span>
<span class=sd>        X : {array-like, sparse matrix}, shape [n_samples, n_features]</span>
<span class=sd>            The data used to compute the mean and standard deviation</span>
<span class=sd>            used for later scaling along the features axis.</span>
<span class=sd>        y</span>
<span class=sd>            Ignored</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span>
            <span class=n>X</span><span class=p>,</span> <span class=p>(</span><span class=n>core</span><span class=o>.</span><span class=n>RegularlySampledAnalogSignalArray</span><span class=p>,</span> <span class=n>core</span><span class=o>.</span><span class=n>BinnedEventArray</span><span class=p>)</span>
        <span class=p>):</span>
            <span class=n>X</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>T</span>

        <span class=k>return</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>partial_fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>sample_weight</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Online computation of mean and std on X for later scaling.</span>
<span class=sd>        All of X is processed as a single batch. This is intended for cases</span>
<span class=sd>        when `fit` is not feasible due to very large number of `n_samples`</span>
<span class=sd>        or because X is read from a continuous stream.</span>
<span class=sd>        The algorithm for incremental mean and std is given in Equation 1.5a,b</span>
<span class=sd>        in Chan, Tony F., Gene H. Golub, and Randall J. LeVeque. &quot;Algorithms</span>
<span class=sd>        for computing the sample variance: Analysis and recommendations.&quot;</span>
<span class=sd>        The American Statistician 37.3 (1983): 242-247:</span>
<span class=sd>        Parameters</span>
<span class=sd>        ----------</span>
<span class=sd>        X : {array-like, sparse matrix}, shape [n_samples, n_features]</span>
<span class=sd>            The data used to compute the mean and standard deviation</span>
<span class=sd>            used for later scaling along the features axis.</span>
<span class=sd>        y</span>
<span class=sd>            Ignored</span>
<span class=sd>        sample_weight : array-like of shape (n_samples,), default=None</span>
<span class=sd>            Individual weights for each sample.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span>
            <span class=n>X</span><span class=p>,</span> <span class=p>(</span><span class=n>core</span><span class=o>.</span><span class=n>RegularlySampledAnalogSignalArray</span><span class=p>,</span> <span class=n>core</span><span class=o>.</span><span class=n>BinnedEventArray</span><span class=p>)</span>
        <span class=p>):</span>
            <span class=n>X</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>T</span>

        <span class=k>return</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>partial_fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>sample_weight</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>copy</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Perform standardization by centering and scaling</span>
<span class=sd>        Parameters</span>
<span class=sd>        ----------</span>
<span class=sd>        X : array-like, shape [n_samples, n_features]</span>
<span class=sd>            The data used to scale along the features axis.</span>
<span class=sd>        copy : bool, optional (default: None)</span>
<span class=sd>            Copy the input X or not.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=n>copy</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>copy</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>copy</span>

        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span>
            <span class=n>X</span><span class=p>,</span> <span class=p>(</span><span class=n>core</span><span class=o>.</span><span class=n>RegularlySampledAnalogSignalArray</span><span class=p>,</span> <span class=n>core</span><span class=o>.</span><span class=n>BinnedEventArray</span><span class=p>)</span>
        <span class=p>):</span>
            <span class=k>if</span> <span class=n>copy</span><span class=p>:</span>
                <span class=n>Xdata</span> <span class=o>=</span> <span class=n>copycopy</span><span class=p>(</span><span class=n>X</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>T</span><span class=p>)</span>
                <span class=n>X</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>Xdata</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>T</span>
            <span class=n>Xdata</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>Xdata</span><span class=p>,</span> <span class=n>copy</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>

            <span class=n>X</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>Xdata</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>X</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>copy</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>X</span>

    <span class=k>def</span><span class=w> </span><span class=nf>inverse_transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>copy</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Scale back the data to the original representation</span>
<span class=sd>        Parameters</span>
<span class=sd>        ----------</span>
<span class=sd>        X : array-like, shape [n_samples, n_features]</span>
<span class=sd>            The data used to scale along the features axis.</span>
<span class=sd>        copy : bool, optional (default: None)</span>
<span class=sd>            Copy the input X or not.</span>
<span class=sd>        Returns</span>
<span class=sd>        -------</span>
<span class=sd>        X_tr : array-like, shape [n_samples, n_features]</span>
<span class=sd>            Transformed array.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=n>copy</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>copy</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>copy</span>

        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span>
            <span class=n>X</span><span class=p>,</span> <span class=p>(</span><span class=n>core</span><span class=o>.</span><span class=n>RegularlySampledAnalogSignalArray</span><span class=p>,</span> <span class=n>core</span><span class=o>.</span><span class=n>BinnedEventArray</span><span class=p>)</span>
        <span class=p>):</span>
            <span class=k>if</span> <span class=n>copy</span><span class=p>:</span>
                <span class=n>Xdata</span> <span class=o>=</span> <span class=n>copycopy</span><span class=p>(</span><span class=n>X</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>T</span><span class=p>)</span>
                <span class=n>X</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>Xdata</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>T</span>
            <span class=n>Xdata</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>inverse_transform</span><span class=p>(</span><span class=n>Xdata</span><span class=p>,</span> <span class=n>copy</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>

            <span class=n>X</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>Xdata</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>X</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>inverse_transform</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>copy</span><span class=p>)</span>

        <span class=k>return</span> <span class=n>X</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=nelpy.preprocessing.StandardScaler.fit class="doc doc-heading"> <code class="highlight language-python"><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Compute the mean and std to be used for later scaling.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>X</code> </td> <td> <code>array-like, sparse matrix</code> </td> <td> <div class=doc-md-description> <p>The data used to compute the mean and standard deviation used for later scaling along the features axis.</p> </div> </td> <td> <code>array-like</code> </td> </tr> <tr class=doc-section-item> <td> <code>y</code> </td> <td> </td> <td> <div class=doc-md-description> <p>Ignored</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>nelpy/preprocessing.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>766</span>
<span class=normal>767</span>
<span class=normal>768</span>
<span class=normal>769</span>
<span class=normal>770</span>
<span class=normal>771</span>
<span class=normal>772</span>
<span class=normal>773</span>
<span class=normal>774</span>
<span class=normal>775</span>
<span class=normal>776</span>
<span class=normal>777</span>
<span class=normal>778</span>
<span class=normal>779</span>
<span class=normal>780</span>
<span class=normal>781</span>
<span class=normal>782</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Compute the mean and std to be used for later scaling.</span>
<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    X : {array-like, sparse matrix}, shape [n_samples, n_features]</span>
<span class=sd>        The data used to compute the mean and standard deviation</span>
<span class=sd>        used for later scaling along the features axis.</span>
<span class=sd>    y</span>
<span class=sd>        Ignored</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span>
        <span class=n>X</span><span class=p>,</span> <span class=p>(</span><span class=n>core</span><span class=o>.</span><span class=n>RegularlySampledAnalogSignalArray</span><span class=p>,</span> <span class=n>core</span><span class=o>.</span><span class=n>BinnedEventArray</span><span class=p>)</span>
    <span class=p>):</span>
        <span class=n>X</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>T</span>

    <span class=k>return</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.preprocessing.StandardScaler.inverse_transform class="doc doc-heading"> <code class="highlight language-python"><span class=n>inverse_transform</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>copy</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Scale back the data to the original representation</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>X</code> </td> <td> <code>(<span title=array>array</span> - <span title=like>like</span>, <span title=shape>shape</span>[<span title=n_samples>n_samples</span>, <span title=n_features>n_features</span>])</code> </td> <td> <div class=doc-md-description> <p>The data used to scale along the features axis.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>copy</code> </td> <td> <code>bool, optional (default: None)</code> </td> <td> <div class=doc-md-description> <p>Copy the input X or not.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>X_tr</code></td> <td> <code>(<span title=array>array</span> - <span title=like>like</span>, <span title=shape>shape</span>[<span title=n_samples>n_samples</span>, <span title=n_features>n_features</span>])</code> </td> <td> <div class=doc-md-description> <p>Transformed array.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>nelpy/preprocessing.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>839</span>
<span class=normal>840</span>
<span class=normal>841</span>
<span class=normal>842</span>
<span class=normal>843</span>
<span class=normal>844</span>
<span class=normal>845</span>
<span class=normal>846</span>
<span class=normal>847</span>
<span class=normal>848</span>
<span class=normal>849</span>
<span class=normal>850</span>
<span class=normal>851</span>
<span class=normal>852</span>
<span class=normal>853</span>
<span class=normal>854</span>
<span class=normal>855</span>
<span class=normal>856</span>
<span class=normal>857</span>
<span class=normal>858</span>
<span class=normal>859</span>
<span class=normal>860</span>
<span class=normal>861</span>
<span class=normal>862</span>
<span class=normal>863</span>
<span class=normal>864</span>
<span class=normal>865</span>
<span class=normal>866</span>
<span class=normal>867</span>
<span class=normal>868</span>
<span class=normal>869</span>
<span class=normal>870</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>inverse_transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>copy</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Scale back the data to the original representation</span>
<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    X : array-like, shape [n_samples, n_features]</span>
<span class=sd>        The data used to scale along the features axis.</span>
<span class=sd>    copy : bool, optional (default: None)</span>
<span class=sd>        Copy the input X or not.</span>
<span class=sd>    Returns</span>
<span class=sd>    -------</span>
<span class=sd>    X_tr : array-like, shape [n_samples, n_features]</span>
<span class=sd>        Transformed array.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>if</span> <span class=n>copy</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>copy</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>copy</span>

    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span>
        <span class=n>X</span><span class=p>,</span> <span class=p>(</span><span class=n>core</span><span class=o>.</span><span class=n>RegularlySampledAnalogSignalArray</span><span class=p>,</span> <span class=n>core</span><span class=o>.</span><span class=n>BinnedEventArray</span><span class=p>)</span>
    <span class=p>):</span>
        <span class=k>if</span> <span class=n>copy</span><span class=p>:</span>
            <span class=n>Xdata</span> <span class=o>=</span> <span class=n>copycopy</span><span class=p>(</span><span class=n>X</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>T</span><span class=p>)</span>
            <span class=n>X</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>Xdata</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>T</span>
        <span class=n>Xdata</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>inverse_transform</span><span class=p>(</span><span class=n>Xdata</span><span class=p>,</span> <span class=n>copy</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>

        <span class=n>X</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>Xdata</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=n>X</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>inverse_transform</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>copy</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>X</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.preprocessing.StandardScaler.partial_fit class="doc doc-heading"> <code class="highlight language-python"><span class=n>partial_fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>sample_weight</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Online computation of mean and std on X for later scaling. All of X is processed as a single batch. This is intended for cases when <code>fit</code> is not feasible due to very large number of <code>n_samples</code> or because X is read from a continuous stream. The algorithm for incremental mean and std is given in Equation 1.5a,b in Chan, Tony F., Gene H. Golub, and Randall J. LeVeque. "Algorithms for computing the sample variance: Analysis and recommendations." The American Statistician 37.3 (1983): 242-247:</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>X</code> </td> <td> <code>array-like, sparse matrix</code> </td> <td> <div class=doc-md-description> <p>The data used to compute the mean and standard deviation used for later scaling along the features axis.</p> </div> </td> <td> <code>array-like</code> </td> </tr> <tr class=doc-section-item> <td> <code>y</code> </td> <td> </td> <td> <div class=doc-md-description> <p>Ignored</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>sample_weight</code> </td> <td> <code>array-like of shape (n_samples,)</code> </td> <td> <div class=doc-md-description> <p>Individual weights for each sample.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>nelpy/preprocessing.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>784</span>
<span class=normal>785</span>
<span class=normal>786</span>
<span class=normal>787</span>
<span class=normal>788</span>
<span class=normal>789</span>
<span class=normal>790</span>
<span class=normal>791</span>
<span class=normal>792</span>
<span class=normal>793</span>
<span class=normal>794</span>
<span class=normal>795</span>
<span class=normal>796</span>
<span class=normal>797</span>
<span class=normal>798</span>
<span class=normal>799</span>
<span class=normal>800</span>
<span class=normal>801</span>
<span class=normal>802</span>
<span class=normal>803</span>
<span class=normal>804</span>
<span class=normal>805</span>
<span class=normal>806</span>
<span class=normal>807</span>
<span class=normal>808</span>
<span class=normal>809</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>partial_fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>sample_weight</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Online computation of mean and std on X for later scaling.</span>
<span class=sd>    All of X is processed as a single batch. This is intended for cases</span>
<span class=sd>    when `fit` is not feasible due to very large number of `n_samples`</span>
<span class=sd>    or because X is read from a continuous stream.</span>
<span class=sd>    The algorithm for incremental mean and std is given in Equation 1.5a,b</span>
<span class=sd>    in Chan, Tony F., Gene H. Golub, and Randall J. LeVeque. &quot;Algorithms</span>
<span class=sd>    for computing the sample variance: Analysis and recommendations.&quot;</span>
<span class=sd>    The American Statistician 37.3 (1983): 242-247:</span>
<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    X : {array-like, sparse matrix}, shape [n_samples, n_features]</span>
<span class=sd>        The data used to compute the mean and standard deviation</span>
<span class=sd>        used for later scaling along the features axis.</span>
<span class=sd>    y</span>
<span class=sd>        Ignored</span>
<span class=sd>    sample_weight : array-like of shape (n_samples,), default=None</span>
<span class=sd>        Individual weights for each sample.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span>
        <span class=n>X</span><span class=p>,</span> <span class=p>(</span><span class=n>core</span><span class=o>.</span><span class=n>RegularlySampledAnalogSignalArray</span><span class=p>,</span> <span class=n>core</span><span class=o>.</span><span class=n>BinnedEventArray</span><span class=p>)</span>
    <span class=p>):</span>
        <span class=n>X</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>T</span>

    <span class=k>return</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>partial_fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>sample_weight</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=nelpy.preprocessing.StandardScaler.transform class="doc doc-heading"> <code class="highlight language-python"><span class=n>transform</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>copy</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Perform standardization by centering and scaling</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>X</code> </td> <td> <code>(<span title=array>array</span> - <span title=like>like</span>, <span title=shape>shape</span>[<span title=n_samples>n_samples</span>, <span title=n_features>n_features</span>])</code> </td> <td> <div class=doc-md-description> <p>The data used to scale along the features axis.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>copy</code> </td> <td> <code>bool, optional (default: None)</code> </td> <td> <div class=doc-md-description> <p>Copy the input X or not.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>nelpy/preprocessing.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>811</span>
<span class=normal>812</span>
<span class=normal>813</span>
<span class=normal>814</span>
<span class=normal>815</span>
<span class=normal>816</span>
<span class=normal>817</span>
<span class=normal>818</span>
<span class=normal>819</span>
<span class=normal>820</span>
<span class=normal>821</span>
<span class=normal>822</span>
<span class=normal>823</span>
<span class=normal>824</span>
<span class=normal>825</span>
<span class=normal>826</span>
<span class=normal>827</span>
<span class=normal>828</span>
<span class=normal>829</span>
<span class=normal>830</span>
<span class=normal>831</span>
<span class=normal>832</span>
<span class=normal>833</span>
<span class=normal>834</span>
<span class=normal>835</span>
<span class=normal>836</span>
<span class=normal>837</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>copy</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Perform standardization by centering and scaling</span>
<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    X : array-like, shape [n_samples, n_features]</span>
<span class=sd>        The data used to scale along the features axis.</span>
<span class=sd>    copy : bool, optional (default: None)</span>
<span class=sd>        Copy the input X or not.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>if</span> <span class=n>copy</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>copy</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>copy</span>

    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span>
        <span class=n>X</span><span class=p>,</span> <span class=p>(</span><span class=n>core</span><span class=o>.</span><span class=n>RegularlySampledAnalogSignalArray</span><span class=p>,</span> <span class=n>core</span><span class=o>.</span><span class=n>BinnedEventArray</span><span class=p>)</span>
    <span class=p>):</span>
        <span class=k>if</span> <span class=n>copy</span><span class=p>:</span>
            <span class=n>Xdata</span> <span class=o>=</span> <span class=n>copycopy</span><span class=p>(</span><span class=n>X</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>T</span><span class=p>)</span>
            <span class=n>X</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>Xdata</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>T</span>
        <span class=n>Xdata</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>Xdata</span><span class=p>,</span> <span class=n>copy</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>

        <span class=n>X</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>Xdata</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=n>X</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>copy</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>X</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=nelpy.preprocessing.StreamingDataWindow class="doc doc-heading"> <code>StreamingDataWindow</code> </h2> <div class="doc doc-contents "> <p>StreamingDataWindow</p> <p>StreamingDataWindow is an iterable with an associated data object.</p> <p>See https://hackmag.com/coding/lets-tame-data-streams-with-python/</p> <details class=quote> <summary>Source code in <code>nelpy/preprocessing.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>715</span>
<span class=normal>716</span>
<span class=normal>717</span>
<span class=normal>718</span>
<span class=normal>719</span>
<span class=normal>720</span>
<span class=normal>721</span>
<span class=normal>722</span>
<span class=normal>723</span>
<span class=normal>724</span>
<span class=normal>725</span>
<span class=normal>726</span>
<span class=normal>727</span>
<span class=normal>728</span>
<span class=normal>729</span>
<span class=normal>730</span>
<span class=normal>731</span>
<span class=normal>732</span>
<span class=normal>733</span>
<span class=normal>734</span>
<span class=normal>735</span>
<span class=normal>736</span>
<span class=normal>737</span>
<span class=normal>738</span>
<span class=normal>739</span>
<span class=normal>740</span>
<span class=normal>741</span>
<span class=normal>742</span>
<span class=normal>743</span>
<span class=normal>744</span>
<span class=normal>745</span>
<span class=normal>746</span>
<span class=normal>747</span>
<span class=normal>748</span>
<span class=normal>749</span>
<span class=normal>750</span>
<span class=normal>751</span>
<span class=normal>752</span>
<span class=normal>753</span>
<span class=normal>754</span>
<span class=normal>755</span>
<span class=normal>756</span>
<span class=normal>757</span>
<span class=normal>758</span>
<span class=normal>759</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>StreamingDataWindow</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    StreamingDataWindow</span>

<span class=sd>    StreamingDataWindow is an iterable with an associated data object.</span>

<span class=sd>    See https://hackmag.com/coding/lets-tame-data-streams-with-python/</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>w</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>flatten</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_w</span> <span class=o>=</span> <span class=n>w</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>X</span> <span class=o>=</span> <span class=n>X</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_flatten</span> <span class=o>=</span> <span class=kc>False</span>

    <span class=k>def</span><span class=w> </span><span class=nf>flatten</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
        <span class=c1># what&#39;s the opposite of flatten?</span>
        <span class=k>pass</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__repr__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=s2>&quot;StreamingDataWindow(</span><span class=se>\n\t</span><span class=s2>w=</span><span class=si>{}</span><span class=s2>,</span><span class=se>\n\t</span><span class=s2>X=</span><span class=si>{}</span><span class=s2>,</span><span class=se>\n\t</span><span class=s2>flatten=</span><span class=si>{}</span><span class=s2>)&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
            <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>w</span><span class=p>),</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>X</span><span class=p>),</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_flatten</span><span class=p>)</span>
        <span class=p>)</span>  <span class=c1># + str(self.w)</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__iter__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=c1># initialize the internal index to zero when used as iterator</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_index</span> <span class=o>=</span> <span class=mi>0</span>
        <span class=k>return</span> <span class=bp>self</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__next__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=c1># index = self._index</span>
        <span class=c1># if index &gt; self.n_intervals - 1:</span>
        <span class=c1>#     raise StopIteration</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_index</span> <span class=o>+=</span> <span class=mi>1</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>w</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_w</span>

    <span class=nd>@w</span><span class=o>.</span><span class=n>setter</span>
    <span class=k>def</span><span class=w> </span><span class=nf>w</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>val</span><span class=p>):</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=n>DataWindow</span><span class=p>):</span>
            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s2>&quot;w must be a nelpy.preprocessing.DataWindow type!&quot;</span><span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_w</span> <span class=o>=</span> <span class=n>val</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-function"> <h2 id=nelpy.preprocessing.standardize_asa class="doc doc-heading"> <code class="highlight language-python"><span class=n>standardize_asa</span><span class=p>(</span><span class=n>func</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>asa</span><span class=p>,</span> <span class=n>lengths</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>timestamps</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>fs</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>n_signals</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Standardize nelpy RegularlySampledAnalogSignalArray to numpy representation.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>asa</code> </td> <td> <code><span title=string>string</span></code> </td> <td> <div class=doc-md-description> <p>Argument name corresponding to 'asa' in decorated function.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>lengths</code> </td> <td> <code><span title=string>string</span></code> </td> <td> <div class=doc-md-description> <p>Argument name corresponding to 'lengths' in decorated function.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>timestamps</code> </td> <td> <code><span title=string>string</span></code> </td> <td> <div class=doc-md-description> <p>Argument name corresponding to 'timestamps' in decorated function.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>fs</code> </td> <td> <code><span title=string>string</span></code> </td> <td> <div class=doc-md-description> <p>Argument name corresponding to 'fs' in decorated function.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>n_signals</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of signals required in asa.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <ul> <li>asa is replaced with a (n_samples, n_signals) numpy array</li> <li>lenghts is replaced with a (n_intervals, ) numpy array, each containing the number of samples in the associated interval.</li> <li>timestmaps is replaced with an (n_samples, ) numpy array, containing the timestamps or abscissa_vals of the RegularlySampledAnalogSignalArray.</li> <li>fs is replaced with the float corresponding to the sampling frequency.</li> </ul> </details> <p><span class=doc-section-title>Examples:</span></p> <p>@standardize_asa(asa='X', lengths='lengths', n_signals=2) def myfunc(*args, X=None, lengths=None): pass</p> <details class=quote> <summary>Source code in <code>nelpy/preprocessing.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 19</span>
<span class=normal> 20</span>
<span class=normal> 21</span>
<span class=normal> 22</span>
<span class=normal> 23</span>
<span class=normal> 24</span>
<span class=normal> 25</span>
<span class=normal> 26</span>
<span class=normal> 27</span>
<span class=normal> 28</span>
<span class=normal> 29</span>
<span class=normal> 30</span>
<span class=normal> 31</span>
<span class=normal> 32</span>
<span class=normal> 33</span>
<span class=normal> 34</span>
<span class=normal> 35</span>
<span class=normal> 36</span>
<span class=normal> 37</span>
<span class=normal> 38</span>
<span class=normal> 39</span>
<span class=normal> 40</span>
<span class=normal> 41</span>
<span class=normal> 42</span>
<span class=normal> 43</span>
<span class=normal> 44</span>
<span class=normal> 45</span>
<span class=normal> 46</span>
<span class=normal> 47</span>
<span class=normal> 48</span>
<span class=normal> 49</span>
<span class=normal> 50</span>
<span class=normal> 51</span>
<span class=normal> 52</span>
<span class=normal> 53</span>
<span class=normal> 54</span>
<span class=normal> 55</span>
<span class=normal> 56</span>
<span class=normal> 57</span>
<span class=normal> 58</span>
<span class=normal> 59</span>
<span class=normal> 60</span>
<span class=normal> 61</span>
<span class=normal> 62</span>
<span class=normal> 63</span>
<span class=normal> 64</span>
<span class=normal> 65</span>
<span class=normal> 66</span>
<span class=normal> 67</span>
<span class=normal> 68</span>
<span class=normal> 69</span>
<span class=normal> 70</span>
<span class=normal> 71</span>
<span class=normal> 72</span>
<span class=normal> 73</span>
<span class=normal> 74</span>
<span class=normal> 75</span>
<span class=normal> 76</span>
<span class=normal> 77</span>
<span class=normal> 78</span>
<span class=normal> 79</span>
<span class=normal> 80</span>
<span class=normal> 81</span>
<span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span>
<span class=normal>106</span>
<span class=normal>107</span>
<span class=normal>108</span>
<span class=normal>109</span>
<span class=normal>110</span>
<span class=normal>111</span>
<span class=normal>112</span>
<span class=normal>113</span>
<span class=normal>114</span>
<span class=normal>115</span>
<span class=normal>116</span>
<span class=normal>117</span>
<span class=normal>118</span>
<span class=normal>119</span>
<span class=normal>120</span>
<span class=normal>121</span>
<span class=normal>122</span>
<span class=normal>123</span>
<span class=normal>124</span>
<span class=normal>125</span>
<span class=normal>126</span>
<span class=normal>127</span>
<span class=normal>128</span>
<span class=normal>129</span>
<span class=normal>130</span>
<span class=normal>131</span>
<span class=normal>132</span>
<span class=normal>133</span>
<span class=normal>134</span>
<span class=normal>135</span>
<span class=normal>136</span>
<span class=normal>137</span>
<span class=normal>138</span>
<span class=normal>139</span>
<span class=normal>140</span>
<span class=normal>141</span>
<span class=normal>142</span>
<span class=normal>143</span>
<span class=normal>144</span>
<span class=normal>145</span>
<span class=normal>146</span>
<span class=normal>147</span>
<span class=normal>148</span>
<span class=normal>149</span>
<span class=normal>150</span>
<span class=normal>151</span>
<span class=normal>152</span>
<span class=normal>153</span>
<span class=normal>154</span>
<span class=normal>155</span>
<span class=normal>156</span>
<span class=normal>157</span>
<span class=normal>158</span>
<span class=normal>159</span>
<span class=normal>160</span>
<span class=normal>161</span>
<span class=normal>162</span>
<span class=normal>163</span>
<span class=normal>164</span>
<span class=normal>165</span>
<span class=normal>166</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>standardize_asa</span><span class=p>(</span>
    <span class=n>func</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>asa</span><span class=p>,</span> <span class=n>lengths</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>timestamps</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>fs</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>n_signals</span><span class=o>=</span><span class=kc>None</span>
<span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Standardize nelpy RegularlySampledAnalogSignalArray to numpy representation.</span>

<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    asa : string</span>
<span class=sd>        Argument name corresponding to &#39;asa&#39; in decorated function.</span>
<span class=sd>    lengths : string, optional</span>
<span class=sd>        Argument name corresponding to &#39;lengths&#39; in decorated function.</span>
<span class=sd>    timestamps : string, optional</span>
<span class=sd>        Argument name corresponding to &#39;timestamps&#39; in decorated function.</span>
<span class=sd>    fs : string, optional</span>
<span class=sd>        Argument name corresponding to &#39;fs&#39; in decorated function.</span>
<span class=sd>    n_signals : int, optional</span>
<span class=sd>        Number of signals required in asa.</span>

<span class=sd>    Notes</span>
<span class=sd>    -----</span>
<span class=sd>     - asa is replaced with a (n_samples, n_signals) numpy array</span>
<span class=sd>     - lenghts is replaced with a (n_intervals, ) numpy array, each containing</span>
<span class=sd>       the number of samples in the associated interval.</span>
<span class=sd>     - timestmaps is replaced with an (n_samples, ) numpy array, containing the</span>
<span class=sd>       timestamps or abscissa_vals of the RegularlySampledAnalogSignalArray.</span>
<span class=sd>     - fs is replaced with the float corresponding to the sampling frequency.</span>

<span class=sd>    Examples</span>
<span class=sd>    --------</span>
<span class=sd>    @standardize_asa(asa=&#39;X&#39;, lengths=&#39;lengths&#39;, n_signals=2)</span>
<span class=sd>    def myfunc(*args, X=None, lengths=None):</span>
<span class=sd>        pass</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>n_signals</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=k>assert</span> <span class=nb>float</span><span class=p>(</span><span class=n>n_signals</span><span class=p>)</span><span class=o>.</span><span class=n>is_integer</span><span class=p>(),</span> <span class=p>(</span>
                <span class=s2>&quot;&#39;n_signals&#39; must be a positive integer!&quot;</span>
            <span class=p>)</span>
            <span class=n>n_signals</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>n_signals</span><span class=p>)</span>
        <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;&#39;n_signals&#39; must be a positive integer!&quot;</span><span class=p>)</span>
        <span class=k>assert</span> <span class=n>n_signals</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>,</span> <span class=s2>&quot;&#39;n_signals&#39; must be a positive integer!&quot;</span>

    <span class=k>assert</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>asa</span><span class=p>,</span> <span class=nb>str</span><span class=p>),</span> <span class=s2>&quot;&#39;asa&#39; decorator argument must be a string!&quot;</span>
    <span class=k>if</span> <span class=n>lengths</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
        <span class=k>assert</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>lengths</span><span class=p>,</span> <span class=nb>str</span><span class=p>),</span> <span class=p>(</span>
            <span class=s2>&quot;&#39;lengths&#39; decorator argument must be a string!&quot;</span>
        <span class=p>)</span>
    <span class=k>if</span> <span class=n>timestamps</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
        <span class=k>assert</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>timestamps</span><span class=p>,</span> <span class=nb>str</span><span class=p>),</span> <span class=p>(</span>
            <span class=s2>&quot;&#39;timestamps&#39; decorator argument must be a string!&quot;</span>
        <span class=p>)</span>
    <span class=k>if</span> <span class=n>fs</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
        <span class=k>assert</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>fs</span><span class=p>,</span> <span class=nb>str</span><span class=p>),</span> <span class=s2>&quot;&#39;fs&#39; decorator argument must be a string!&quot;</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_decorate</span><span class=p>(</span><span class=n>function</span><span class=p>):</span>
        <span class=nd>@wraps</span><span class=p>(</span><span class=n>function</span><span class=p>)</span>
        <span class=k>def</span><span class=w> </span><span class=nf>wrapped_function</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
            <span class=n>kw</span> <span class=o>=</span> <span class=kc>True</span>
            <span class=c1># TODO: check that all decorator kwargs are strings</span>
            <span class=n>asa_</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=n>asa</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
            <span class=n>lengths_</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=n>lengths</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
            <span class=n>fs_</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=n>fs</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
            <span class=n>timestamps_</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=n>timestamps</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>

            <span class=k>if</span> <span class=n>asa_</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
                <span class=k>try</span><span class=p>:</span>
                    <span class=n>asa_</span> <span class=o>=</span> <span class=n>args</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
                    <span class=n>kw</span> <span class=o>=</span> <span class=kc>False</span>
                <span class=k>except</span> <span class=ne>IndexError</span><span class=p>:</span>
                    <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
                        <span class=s2>&quot;</span><span class=si>{}</span><span class=s2>() missing 1 required positional argument: &#39;</span><span class=si>{}</span><span class=s2>&#39;&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                            <span class=n>function</span><span class=o>.</span><span class=vm>__name__</span><span class=p>,</span> <span class=n>asa</span>
                        <span class=p>)</span>
                    <span class=p>)</span>

            <span class=c1># standardize asa_ here...</span>
            <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>asa_</span><span class=p>,</span> <span class=n>core</span><span class=o>.</span><span class=n>RegularlySampledAnalogSignalArray</span><span class=p>):</span>
                <span class=k>if</span> <span class=n>n_signals</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                    <span class=k>if</span> <span class=ow>not</span> <span class=n>asa_</span><span class=o>.</span><span class=n>n_signals</span> <span class=o>==</span> <span class=n>n_signals</span><span class=p>:</span>
                        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
                            <span class=s2>&quot;Input object &#39;</span><span class=si>{}</span><span class=s2>&#39;.n_signals==</span><span class=si>{}</span><span class=s2>, but </span><span class=si>{}</span><span class=s2> was expected!&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                                <span class=n>asa</span><span class=p>,</span> <span class=n>asa_</span><span class=o>.</span><span class=n>n_signals</span><span class=p>,</span> <span class=n>n_signals</span>
                            <span class=p>)</span>
                        <span class=p>)</span>
                <span class=k>if</span> <span class=n>lengths_</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                    <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
                        <span class=s2>&quot;&#39;</span><span class=si>{}</span><span class=s2>&#39; was passed in, but will be overwritten&quot;</span>
                        <span class=s2>&quot; by &#39;</span><span class=si>{}</span><span class=s2>&#39;s &#39;lengths&#39; attribute&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>lengths</span><span class=p>,</span> <span class=n>asa</span><span class=p>)</span>
                    <span class=p>)</span>
                <span class=k>if</span> <span class=n>timestamps_</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                    <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
                        <span class=s2>&quot;&#39;</span><span class=si>{}</span><span class=s2>&#39; was passed in, but will be overwritten&quot;</span>
                        <span class=s2>&quot; by &#39;</span><span class=si>{}</span><span class=s2>&#39;s &#39;abscissa_vals&#39; attribute&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>timestamps</span><span class=p>,</span> <span class=n>asa</span><span class=p>)</span>
                    <span class=p>)</span>
                <span class=k>if</span> <span class=n>fs_</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                    <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
                        <span class=s2>&quot;&#39;</span><span class=si>{}</span><span class=s2>&#39; was passed in, but will be overwritten&quot;</span>
                        <span class=s2>&quot; by &#39;</span><span class=si>{}</span><span class=s2>&#39;s &#39;fs&#39; attribute&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>fs</span><span class=p>,</span> <span class=n>asa</span><span class=p>)</span>
                    <span class=p>)</span>

                <span class=n>fs_</span> <span class=o>=</span> <span class=n>asa_</span><span class=o>.</span><span class=n>fs</span>
                <span class=n>lengths_</span> <span class=o>=</span> <span class=n>asa_</span><span class=o>.</span><span class=n>lengths</span>
                <span class=n>timestamps_</span> <span class=o>=</span> <span class=n>asa_</span><span class=o>.</span><span class=n>abscissa_vals</span>
                <span class=n>asa_</span> <span class=o>=</span> <span class=n>asa_</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>squeeze</span><span class=p>()</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>

            <span class=k>elif</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>asa_</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>):</span>
                <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
                    <span class=s2>&quot;&#39;</span><span class=si>{}</span><span class=s2>&#39; was not a nelpy.RegularlySampledAnalogSignalArray&quot;</span>
                    <span class=s2>&quot; so expected a numpy ndarray but got </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>asa</span><span class=p>,</span> <span class=nb>type</span><span class=p>(</span><span class=n>asa_</span><span class=p>))</span>
                <span class=p>)</span>

            <span class=k>if</span> <span class=n>kw</span><span class=p>:</span>
                <span class=n>kwargs</span><span class=p>[</span><span class=n>asa</span><span class=p>]</span> <span class=o>=</span> <span class=n>asa_</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>args</span> <span class=o>=</span> <span class=nb>tuple</span><span class=p>([</span><span class=n>arg</span> <span class=k>if</span> <span class=n>ii</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=n>asa_</span> <span class=k>for</span> <span class=p>(</span><span class=n>ii</span><span class=p>,</span> <span class=n>arg</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>args</span><span class=p>)])</span>

            <span class=k>if</span> <span class=n>lengths</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                <span class=k>if</span> <span class=n>lengths_</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
                    <span class=n>lengths_</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=nb>len</span><span class=p>(</span><span class=n>asa_</span><span class=p>)])</span>
                <span class=n>kwargs</span><span class=p>[</span><span class=n>lengths</span><span class=p>]</span> <span class=o>=</span> <span class=n>lengths_</span>
            <span class=k>if</span> <span class=n>timestamps</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                <span class=k>if</span> <span class=n>timestamps_</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
                    <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
                        <span class=s2>&quot;</span><span class=si>{}</span><span class=s2>() missing 1 required keyword argument: &#39;</span><span class=si>{}</span><span class=s2>&#39;&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                            <span class=n>function</span><span class=o>.</span><span class=vm>__name__</span><span class=p>,</span> <span class=n>timestamps</span>
                        <span class=p>)</span>
                    <span class=p>)</span>
                <span class=n>kwargs</span><span class=p>[</span><span class=n>timestamps</span><span class=p>]</span> <span class=o>=</span> <span class=n>timestamps_</span>
            <span class=k>if</span> <span class=n>fs</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                <span class=k>if</span> <span class=n>fs_</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
                    <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
                        <span class=s2>&quot;</span><span class=si>{}</span><span class=s2>() missing 1 required keyword argument: &#39;</span><span class=si>{}</span><span class=s2>&#39;&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                            <span class=n>function</span><span class=o>.</span><span class=vm>__name__</span><span class=p>,</span> <span class=n>fs</span>
                        <span class=p>)</span>
                    <span class=p>)</span>
                <span class=n>kwargs</span><span class=p>[</span><span class=n>fs</span><span class=p>]</span> <span class=o>=</span> <span class=n>fs_</span>

            <span class=k>return</span> <span class=n>function</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>

        <span class=k>return</span> <span class=n>wrapped_function</span>

    <span class=k>if</span> <span class=n>func</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>_decorate</span><span class=p>(</span><span class=n>func</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>_decorate</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "content.tabs.link", "navigation.footer", "navigation.indexes", "navigation.instant.prefetch", "navigation.instant.preview", "navigation.instant.progress", "navigation.path", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../../assets/javascripts/bundle.50899def.min.js></script> </body> </html>